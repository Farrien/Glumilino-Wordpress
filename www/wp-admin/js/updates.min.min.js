(function(h,f,e){var g=h(document);f=f||{};f.updates={};f.updates.ajaxNonce=e.ajax_nonce;f.updates.l10n=e.l10n;f.updates.searchTerm="";f.updates.shouldRequestFilesystemCredentials=false;f.updates.filesystemCredentials={ftp:{host:"",username:"",password:"",connectionType:""},ssh:{publicKey:"",privateKey:""},fsNonce:"",available:false};f.updates.ajaxLocked=false;f.updates.adminNotice=f.template("wp-updates-admin-notice");f.updates.queue=[];f.updates.$elToReturnFocusToFromCredentialsModal=undefined;f.updates.addAdminNotice=function(b){var a=h(b.selector),c;delete b.selector;c=f.updates.adminNotice(b);if(!a.length){a=h("#"+b.id)}if(a.length){a.replaceWith(c)}else{h(".wrap").find("> h1").after(c)}g.trigger("wp-updates-notice-added")};f.updates.ajax=function(a,b){var c={};if(f.updates.ajaxLocked){f.updates.queue.push({action:a,data:b});return h.Deferred()}f.updates.ajaxLocked=true;if(b.success){c.success=b.success;delete b.success}if(b.error){c.error=b.error;delete b.error}c.data=_.extend(b,{action:a,_ajax_nonce:f.updates.ajaxNonce,_fs_nonce:f.updates.filesystemCredentials.fsNonce,username:f.updates.filesystemCredentials.ftp.username,password:f.updates.filesystemCredentials.ftp.password,hostname:f.updates.filesystemCredentials.ftp.hostname,connection_type:f.updates.filesystemCredentials.ftp.connectionType,public_key:f.updates.filesystemCredentials.ssh.publicKey,private_key:f.updates.filesystemCredentials.ssh.privateKey});return f.ajax.send(c).always(f.updates.ajaxAlways)};f.updates.ajaxAlways=function(a){if(!a.errorCode||"unable_to_connect_to_filesystem"!==a.errorCode){f.updates.ajaxLocked=false;f.updates.queueChecker()}if("undefined"!==typeof a.debug&&window.console&&window.console.log){_.map(a.debug,function(b){window.console.log(h("<p />").html(b).text())})}};f.updates.refreshCount=function(){var a=h("#wp-admin-bar-updates"),j=h('a[href="update-core.php"] .update-plugins'),c=h('a[href="plugins.php"] .update-plugins'),b=h('a[href="themes.php"] .update-plugins'),d;a.find(".ab-item").removeAttr("title");a.find(".ab-label").text(e.totals.counts.total);if(0===e.totals.counts.total){a.find(".ab-label").parents("li").remove()}j.each(function(l,i){i.className=i.className.replace(/count-\d+/,"count-"+e.totals.counts.total)});if(e.totals.counts.total>0){j.find(".update-count").text(e.totals.counts.total)}else{j.remove()}c.each(function(l,i){i.className=i.className.replace(/count-\d+/,"count-"+e.totals.counts.plugins)});if(e.totals.counts.total>0){c.find(".plugin-count").text(e.totals.counts.plugins)}else{c.remove()}b.each(function(l,i){i.className=i.className.replace(/count-\d+/,"count-"+e.totals.counts.themes)});if(e.totals.counts.total>0){b.find(".theme-count").text(e.totals.counts.themes)}else{b.remove()}if("plugins"===pagenow||"plugins-network"===pagenow){d=e.totals.counts.plugins}else{if("themes"===pagenow||"themes-network"===pagenow){d=e.totals.counts.themes}}if(d>0){h(".subsubsub .upgrade .count").text("("+d+")")}else{h(".subsubsub .upgrade").remove()}};f.updates.decrementCount=function(a){e.totals.counts.total=Math.max(--e.totals.counts.total,0);if("plugin"===a){e.totals.counts.plugins=Math.max(--e.totals.counts.plugins,0)}else{if("theme"===a){e.totals.counts.themes=Math.max(--e.totals.counts.themes,0)}}f.updates.refreshCount(a)};f.updates.updatePlugin=function(d){var b,a,j,c;d=_.extend({success:f.updates.updatePluginSuccess,error:f.updates.updatePluginError},d);if("plugins"===pagenow||"plugins-network"===pagenow){b=h('tr[data-plugin="'+d.plugin+'"]');j=b.find(".update-message").removeClass("notice-error").addClass("updating-message notice-warning").find("p");c=f.updates.l10n.updatingLabel.replace("%s",b.find(".plugin-title strong").text())}else{if("plugin-install"===pagenow||"plugin-install-network"===pagenow){a=h(".plugin-card-"+d.slug);j=a.find(".update-now").addClass("updating-message");c=f.updates.l10n.updatingLabel.replace("%s",j.data("name"));a.removeClass("plugin-card-update-failed").find(".notice.notice-error").remove()}}if(j.html()!==f.updates.l10n.updating){j.data("originaltext",j.html())}j.attr("aria-label",c).text(f.updates.l10n.updating);g.trigger("wp-plugin-updating",d);return f.updates.ajax("update-plugin",d)};f.updates.updatePluginSuccess=function(c){var b,d,a;if("plugins"===pagenow||"plugins-network"===pagenow){b=h('tr[data-plugin="'+c.plugin+'"]').removeClass("update").addClass("updated");d=b.find(".update-message").removeClass("updating-message notice-warning").addClass("updated-message notice-success").find("p");a=b.find(".plugin-version-author-uri").html().replace(c.oldVersion,c.newVersion);b.find(".plugin-version-author-uri").html(a)}else{if("plugin-install"===pagenow||"plugin-install-network"===pagenow){d=h(".plugin-card-"+c.slug).find(".update-now").removeClass("updating-message").addClass("button-disabled updated-message")}}d.attr("aria-label",f.updates.l10n.updatedLabel.replace("%s",c.pluginName)).text(f.updates.l10n.updated);f.a11y.speak(f.updates.l10n.updatedMsg,"polite");f.updates.decrementCount("plugin");g.trigger("wp-plugin-update-success",c)};f.updates.updatePluginError=function(d){var a,b,c;if(!f.updates.isValidResponse(d,"update")){return}if(f.updates.maybeHandleCredentialError(d,"update-plugin")){return}c=f.updates.l10n.updateFailed.replace("%s",d.errorMessage);if("plugins"===pagenow||"plugins-network"===pagenow){if(d.plugin){b=h('tr[data-plugin="'+d.plugin+'"]').find(".update-message")}else{b=h('tr[data-slug="'+d.slug+'"]').find(".update-message")}b.removeClass("updating-message notice-warning").addClass("notice-error").find("p").html(c);if(d.pluginName){b.find("p").attr("aria-label",f.updates.l10n.updateFailedLabel.replace("%s",d.pluginName))}else{b.find("p").removeAttr("aria-label")}}else{if("plugin-install"===pagenow||"plugin-install-network"===pagenow){a=h(".plugin-card-"+d.slug).addClass("plugin-card-update-failed").append(f.updates.adminNotice({className:"update-message notice-error notice-alt is-dismissible",message:c}));a.find(".update-now").text(f.updates.l10n.updateFailedShort).removeClass("updating-message");if(d.pluginName){a.find(".update-now").attr("aria-label",f.updates.l10n.updateFailedLabel.replace("%s",d.pluginName))}else{a.find(".update-now").removeAttr("aria-label")}a.on("click",".notice.is-dismissible .notice-dismiss",function(){setTimeout(function(){a.removeClass("plugin-card-update-failed").find(".column-name a").focus();a.find(".update-now").attr("aria-label",false).text(f.updates.l10n.updateNow)},200)})}}f.a11y.speak(c,"assertive");g.trigger("wp-plugin-update-error",d)};f.updates.installPlugin=function(b){var a=h(".plugin-card-"+b.slug),c=a.find(".install-now");b=_.extend({success:f.updates.installPluginSuccess,error:f.updates.installPluginError},b);if("import"===pagenow){c=h('[data-slug="'+b.slug+'"]')}if(c.html()!==f.updates.l10n.installing){c.data("originaltext",c.html())}c.addClass("updating-message").attr("aria-label",f.updates.l10n.pluginInstallingLabel.replace("%s",c.data("name"))).text(f.updates.l10n.installing);f.a11y.speak(f.updates.l10n.installingMsg,"polite");a.removeClass("plugin-card-install-failed").find(".notice.notice-error").remove();g.trigger("wp-plugin-installing",b);return f.updates.ajax("install-plugin",b)};f.updates.installPluginSuccess=function(b){var a=h(".plugin-card-"+b.slug).find(".install-now");a.removeClass("updating-message").addClass("updated-message installed button-disabled").attr("aria-label",f.updates.l10n.pluginInstalledLabel.replace("%s",b.pluginName)).text(f.updates.l10n.installed);f.a11y.speak(f.updates.l10n.installedMsg,"polite");g.trigger("wp-plugin-install-success",b);if(b.activateUrl){setTimeout(function(){a.removeClass("install-now installed button-disabled updated-message").addClass("activate-now button-primary").attr("href",b.activateUrl).attr("aria-label",f.updates.l10n.activatePluginLabel.replace("%s",b.pluginName)).text(f.updates.l10n.activatePlugin)},1000)}};f.updates.installPluginError=function(d){var a=h(".plugin-card-"+d.slug),b=a.find(".install-now"),c;if(!f.updates.isValidResponse(d,"install")){return}if(f.updates.maybeHandleCredentialError(d,"install-plugin")){return}c=f.updates.l10n.installFailed.replace("%s",d.errorMessage);a.addClass("plugin-card-update-failed").append('<div class="notice notice-error notice-alt is-dismissible"><p>'+c+"</p></div>");a.on("click",".notice.is-dismissible .notice-dismiss",function(){setTimeout(function(){a.removeClass("plugin-card-update-failed").find(".column-name a").focus()},200)});b.removeClass("updating-message").addClass("button-disabled").attr("aria-label",f.updates.l10n.pluginInstallFailedLabel.replace("%s",b.data("name"))).text(f.updates.l10n.installFailedShort);f.a11y.speak(c,"assertive");g.trigger("wp-plugin-install-error",d)};f.updates.installImporterSuccess=function(a){f.updates.addAdminNotice({id:"install-success",className:"notice-success is-dismissible",message:f.updates.l10n.importerInstalledMsg.replace("%s",a.activateUrl+"&from=import")});h('[data-slug="'+a.slug+'"]').removeClass("install-now updating-message").addClass("activate-now").attr({href:a.activateUrl+"&from=import","aria-label":f.updates.l10n.activateImporterLabel.replace("%s",a.pluginName)}).text(f.updates.l10n.activateImporter);f.a11y.speak(f.updates.l10n.installedMsg,"polite");g.trigger("wp-importer-install-success",a)};f.updates.installImporterError=function(d){var c=f.updates.l10n.installFailed.replace("%s",d.errorMessage),a=h('[data-slug="'+d.slug+'"]'),b=a.data("name");if(!f.updates.isValidResponse(d,"install")){return}if(f.updates.maybeHandleCredentialError(d,"install-plugin")){return}f.updates.addAdminNotice({id:d.errorCode,className:"notice-error is-dismissible",message:c});a.removeClass("updating-message").text(f.updates.l10n.installNow).attr("aria-label",f.updates.l10n.installNowLabel.replace("%s",b));f.a11y.speak(c,"assertive");g.trigger("wp-importer-install-error",d)};f.updates.deletePlugin=function(a){var b=h('[data-plugin="'+a.plugin+'"]').find(".row-actions a.delete");a=_.extend({success:f.updates.deletePluginSuccess,error:f.updates.deletePluginError},a);if(b.html()!==f.updates.l10n.deleting){b.data("originaltext",b.html()).text(f.updates.l10n.deleting)}f.a11y.speak(f.updates.l10n.deleting,"polite");g.trigger("wp-plugin-deleting",a);return f.updates.ajax("delete-plugin",a)};f.updates.deletePluginSuccess=function(a){h('[data-plugin="'+a.plugin+'"]').css({backgroundColor:"#faafaa"}).fadeOut(350,function(){var l=h("#bulk-action-form"),b=h(".subsubsub"),d=h(this),c=l.find("thead th:not(.hidden), thead td").length,m=f.template("item-deleted-row"),n=e.plugins;if(!d.hasClass("plugin-update-tr")){d.after(m({slug:a.slug,plugin:a.plugin,colspan:c,name:a.pluginName}))}d.remove();if(-1!==_.indexOf(n.upgrade,a.plugin)){n.upgrade=_.without(n.upgrade,a.plugin);f.updates.decrementCount("plugin")}if(-1!==_.indexOf(n.inactive,a.plugin)){n.inactive=_.without(n.inactive,a.plugin);if(n.inactive.length){b.find(".inactive .count").text("("+n.inactive.length+")")}else{b.find(".inactive").remove()}}if(-1!==_.indexOf(n.active,a.plugin)){n.active=_.without(n.active,a.plugin);if(n.active.length){b.find(".active .count").text("("+n.active.length+")")}else{b.find(".active").remove()}}if(-1!==_.indexOf(n.recently_activated,a.plugin)){n.recently_activated=_.without(n.recently_activated,a.plugin);if(n.recently_activated.length){b.find(".recently_activated .count").text("("+n.recently_activated.length+")")}else{b.find(".recently_activated").remove()}}n.all=_.without(n.all,a.plugin);if(n.all.length){b.find(".all .count").text("("+n.all.length+")")}else{l.find(".tablenav").css({visibility:"hidden"});b.find(".all").remove();if(!l.find("tr.no-items").length){l.find("#the-list").append('<tr class="no-items"><td class="colspanchange" colspan="'+c+'">'+f.updates.l10n.noPlugins+"</td></tr>")}}});f.a11y.speak(f.updates.l10n.deleted,"polite");g.trigger("wp-plugin-delete-success",a)};f.updates.deletePluginError=function(d){var b,j,a=f.template("item-update-row"),c=f.updates.adminNotice({className:"update-message notice-error notice-alt",message:d.errorMessage});if(d.plugin){b=h('tr.inactive[data-plugin="'+d.plugin+'"]');j=b.siblings('[data-plugin="'+d.plugin+'"]')}else{b=h('tr.inactive[data-slug="'+d.slug+'"]');j=b.siblings('[data-slug="'+d.slug+'"]')}if(!f.updates.isValidResponse(d,"delete")){return}if(f.updates.maybeHandleCredentialError(d,"delete-plugin")){return}if(!j.length){b.addClass("update").after(a({slug:d.slug,plugin:d.plugin||d.slug,colspan:h("#bulk-action-form").find("thead th:not(.hidden), thead td").length,content:c}))}else{j.find(".notice-error").remove();j.find(".plugin-update").append(c)}g.trigger("wp-plugin-delete-error",d)};f.updates.updateTheme=function(b){var a;b=_.extend({success:f.updates.updateThemeSuccess,error:f.updates.updateThemeError},b);if("themes-network"===pagenow){a=h('[data-slug="'+b.slug+'"]').find(".update-message").removeClass("notice-error").addClass("updating-message notice-warning").find("p")}else{a=h("#update-theme").closest(".notice").removeClass("notice-large");a.find("h3").remove();a=a.add(h('[data-slug="'+b.slug+'"]').find(".update-message"));a=a.addClass("updating-message").find("p")}if(a.html()!==f.updates.l10n.updating){a.data("originaltext",a.html())}f.a11y.speak(f.updates.l10n.updatingMsg,"polite");a.text(f.updates.l10n.updating);g.trigger("wp-theme-updating",b);return f.updates.ajax("update-theme",b)};f.updates.updateThemeSuccess=function(l){var b=h("body.modal-open").length,d=h('[data-slug="'+l.slug+'"]'),k={className:"updated-message notice-success notice-alt",message:f.updates.l10n.updated},a,c;if("themes-network"===pagenow){a=d.find(".update-message");c=d.find(".theme-version-author-uri").html().replace(l.oldVersion,l.newVersion);d.find(".theme-version-author-uri").html(c)}else{a=h(".theme-info .notice").add(d.find(".update-message"));if(b){h(".load-customize:visible").focus()}else{d.find(".load-customize").focus()}}f.updates.addAdminNotice(_.extend({selector:a},k));f.a11y.speak(f.updates.l10n.updatedMsg,"polite");f.updates.decrementCount("theme");g.trigger("wp-theme-update-success",l);if(b){h(".theme-info .theme-author").after(f.updates.adminNotice(k))}};f.updates.updateThemeError=function(d){var b=h('[data-slug="'+d.slug+'"]'),c=f.updates.l10n.updateFailed.replace("%s",d.errorMessage),a;if(!f.updates.isValidResponse(d,"update")){return}if(f.updates.maybeHandleCredentialError(d,"update-theme")){return}if("themes-network"===pagenow){a=b.find(".update-message ")}else{a=h(".theme-info .notice").add(b.find(".notice"));h("body.modal-open").length?h(".load-customize:visible").focus():b.find(".load-customize").focus()}f.updates.addAdminNotice({selector:a,className:"update-message notice-error notice-alt is-dismissible",message:c});f.a11y.speak(c,"polite");g.trigger("wp-theme-update-error",d)};f.updates.installTheme=function(a){var b=h('.theme-install[data-slug="'+a.slug+'"]');a=_.extend({success:f.updates.installThemeSuccess,error:f.updates.installThemeError},a);b.addClass("updating-message");b.parents(".theme").addClass("focus");if(b.html()!==f.updates.l10n.installing){b.data("originaltext",b.html())}b.text(f.updates.l10n.installing).attr("aria-label",f.updates.l10n.themeInstallingLabel.replace("%s",b.data("name")));f.a11y.speak(f.updates.l10n.installingMsg,"polite");h('.install-theme-info, [data-slug="'+a.slug+'"]').removeClass("theme-install-failed").find(".notice.notice-error").remove();g.trigger("wp-theme-installing",a);return f.updates.ajax("install-theme",a)};f.updates.installThemeSuccess=function(c){var a=h(".wp-full-overlay-header, [data-slug="+c.slug+"]"),b;g.trigger("wp-theme-install-success",c);b=a.find(".button-primary").removeClass("updating-message").addClass("updated-message disabled").attr("aria-label",f.updates.l10n.themeInstalledLabel.replace("%s",c.themeName)).text(f.updates.l10n.installed);f.a11y.speak(f.updates.l10n.installedMsg,"polite");setTimeout(function(){if(c.activateUrl){b.attr("href",c.activateUrl).removeClass("theme-install updated-message disabled").addClass("activate").attr("aria-label",f.updates.l10n.activateThemeLabel.replace("%s",c.themeName)).text(f.updates.l10n.activateTheme)}if(c.customizeUrl){b.siblings(".preview").replaceWith(function(){return h("<a>").attr("href",c.customizeUrl).addClass("button load-customize").text(f.updates.l10n.livePreview)})}},1000)};f.updates.installThemeError=function(j){var a,b,c=f.updates.l10n.installFailed.replace("%s",j.errorMessage),d=f.updates.adminNotice({className:"update-message notice-error notice-alt",message:c});if(!f.updates.isValidResponse(j,"install")){return}if(f.updates.maybeHandleCredentialError(j,"install-theme")){return}if(g.find("body").hasClass("full-overlay-active")){b=h('.theme-install[data-slug="'+j.slug+'"]');a=h(".install-theme-info").prepend(d)}else{a=h('[data-slug="'+j.slug+'"]').removeClass("focus").addClass("theme-install-failed").append(d);b=a.find(".theme-install")}b.removeClass("updating-message").attr("aria-label",f.updates.l10n.themeInstallFailedLabel.replace("%s",b.data("name"))).text(f.updates.l10n.installFailedShort);f.a11y.speak(c,"assertive");g.trigger("wp-theme-install-error",j)};f.updates.deleteTheme=function(b){var a;if("themes"===pagenow){a=h(".theme-actions .delete-theme")}else{if("themes-network"===pagenow){a=h('[data-slug="'+b.slug+'"]').find(".row-actions a.delete")}}b=_.extend({success:f.updates.deleteThemeSuccess,error:f.updates.deleteThemeError},b);if(a&&a.html()!==f.updates.l10n.deleting){a.data("originaltext",a.html()).text(f.updates.l10n.deleting)}f.a11y.speak(f.updates.l10n.deleting,"polite");h(".theme-info .update-message").remove();g.trigger("wp-theme-deleting",b);return f.updates.ajax("delete-theme",b)};f.updates.deleteThemeSuccess=function(b){var a=h('[data-slug="'+b.slug+'"]');if("themes-network"===pagenow){a.css({backgroundColor:"#faafaa"}).fadeOut(350,function(){var d=h(".subsubsub"),c=h(this),k=e.themes,l=f.template("item-deleted-row");if(!c.hasClass("plugin-update-tr")){c.after(l({slug:b.slug,colspan:h("#bulk-action-form").find("thead th:not(.hidden), thead td").length,name:c.find(".theme-title strong").text()}))}c.remove();if(c.hasClass("update")){k.upgrade--;f.updates.decrementCount("theme")}if(c.hasClass("inactive")){k.disabled--;if(k.disabled){d.find(".disabled .count").text("("+k.disabled+")")}else{d.find(".disabled").remove()}}d.find(".all .count").text("("+ --k.all+")")})}f.a11y.speak(f.updates.l10n.deleted,"polite");g.trigger("wp-theme-delete-success",b)};f.updates.deleteThemeError=function(m){var a=h('tr.inactive[data-slug="'+m.slug+'"]'),c=h(".theme-actions .delete-theme"),n=f.template("item-update-row"),b=a.siblings("#"+m.slug+"-update"),d=f.updates.l10n.deleteFailed.replace("%s",m.errorMessage),l=f.updates.adminNotice({className:"update-message notice-error notice-alt",message:d});if(f.updates.maybeHandleCredentialError(m,"delete-theme")){return}if("themes-network"===pagenow){if(!b.length){a.addClass("update").after(n({slug:m.slug,colspan:h("#bulk-action-form").find("thead th:not(.hidden), thead td").length,content:l}))}else{b.find(".notice-error").remove();b.find(".plugin-update").append(l)}}else{h(".theme-info .theme-description").before(l)}c.html(c.data("originaltext"));f.a11y.speak(d,"assertive");g.trigger("wp-theme-delete-error",m)};f.updates._addCallbacks=function(a,b){if("import"===pagenow&&"install-plugin"===b){a.success=f.updates.installImporterSuccess;a.error=f.updates.installImporterError}return a};f.updates.queueChecker=function(){var a;if(f.updates.ajaxLocked||!f.updates.queue.length){return}a=f.updates.queue.shift();switch(a.action){case"install-plugin":f.updates.installPlugin(a.data);break;case"update-plugin":f.updates.updatePlugin(a.data);break;case"delete-plugin":f.updates.deletePlugin(a.data);break;case"install-theme":f.updates.installTheme(a.data);break;case"update-theme":f.updates.updateTheme(a.data);break;case"delete-theme":f.updates.deleteTheme(a.data);break;default:break}};f.updates.requestFilesystemCredentials=function(a){if(false===f.updates.filesystemCredentials.available){if(a&&!f.updates.$elToReturnFocusToFromCredentialsModal){f.updates.$elToReturnFocusToFromCredentialsModal=h(a.target)}f.updates.ajaxLocked=true;f.updates.requestForCredentialsModalOpen()}};f.updates.maybeRequestFilesystemCredentials=function(a){if(f.updates.shouldRequestFilesystemCredentials&&!f.updates.ajaxLocked){f.updates.requestFilesystemCredentials(a)}};f.updates.keydown=function(a){if(27===a.keyCode){f.updates.requestForCredentialsModalCancel()}else{if(9===a.keyCode){if("upgrade"===a.target.id&&!a.shiftKey){h("#hostname").focus();a.preventDefault()}else{if("hostname"===a.target.id&&a.shiftKey){h("#upgrade").focus();a.preventDefault()}}}}};f.updates.requestForCredentialsModalOpen=function(){var a=h("#request-filesystem-credentials-dialog");h("body").addClass("modal-open");a.show();a.find("input:enabled:first").focus();a.on("keydown",f.updates.keydown)};f.updates.requestForCredentialsModalClose=function(){h("#request-filesystem-credentials-dialog").hide();h("body").removeClass("modal-open");if(f.updates.$elToReturnFocusToFromCredentialsModal){f.updates.$elToReturnFocusToFromCredentialsModal.focus()}};f.updates.requestForCredentialsModalCancel=function(){if(!f.updates.ajaxLocked&&!f.updates.queue.length){return}_.each(f.updates.queue,function(a){g.trigger("credential-modal-cancel",a)});f.updates.ajaxLocked=false;f.updates.queue=[];f.updates.requestForCredentialsModalClose()};f.updates.showErrorInCredentialsForm=function(b){var a=h("#request-filesystem-credentials-form");a.find(".notice").remove();a.find("#request-filesystem-credentials-title").after('<div class="notice notice-alt notice-error"><p>'+b+"</p></div>")};f.updates.credentialError=function(b,a){b=f.updates._addCallbacks(b,a);f.updates.queue.unshift({action:a,data:b});f.updates.filesystemCredentials.available=false;f.updates.showErrorInCredentialsForm(b.errorMessage);f.updates.requestFilesystemCredentials()};f.updates.maybeHandleCredentialError=function(b,a){if(f.updates.shouldRequestFilesystemCredentials&&b.errorCode&&"unable_to_connect_to_filesystem"===b.errorCode){f.updates.credentialError(b,a);return true}return false};f.updates.isValidResponse=function(d,a){var b=f.updates.l10n.unknownError,c;if(_.isObject(d)&&!_.isFunction(d.always)){return true}if(_.isString(d)&&"-1"===d){b=f.updates.l10n.nonceError}else{if(_.isString(d)){b=d}else{if("undefined"!==typeof d.readyState&&0===d.readyState){b=f.updates.l10n.connectionError}else{if(_.isString(d.responseText)&&""!==d.responseText){b=d.responseText}else{if(_.isString(d.statusText)){b=d.statusText}}}}}switch(a){case"update":c=f.updates.l10n.updateFailed;break;case"install":c=f.updates.l10n.installFailed;break;case"delete":c=f.updates.l10n.deleteFailed;break}b=b.replace(/<[\/a-z][^<>]*>/gi,"");c=c.replace("%s",b);f.updates.addAdminNotice({id:"unknown_error",className:"notice-error is-dismissible",message:_.escape(c)});f.updates.ajaxLocked=false;f.updates.queue=[];h(".button.updating-message").removeClass("updating-message").removeAttr("aria-label").prop("disabled",true).text(f.updates.l10n.updateFailedShort);h(".updating-message:not(.button):not(.thickbox)").removeClass("updating-message notice-warning").addClass("notice-error").find("p").removeAttr("aria-label").text(c);f.a11y.speak(c,"assertive");return false};f.updates.beforeunload=function(){if(f.updates.ajaxLocked){return f.updates.l10n.beforeunload}};h(function(){var a=h("#plugin-filter"),k=h("#bulk-action-form"),b=h("#request-filesystem-credentials-form"),l=h("#request-filesystem-credentials-dialog"),c=h(".plugins-php .wp-filter-search"),d=h(".plugin-install-php .wp-filter-search");e=_.extend(e,window._wpUpdatesItemCounts||{});if(e.totals){f.updates.refreshCount()}f.updates.shouldRequestFilesystemCredentials=l.length>0;l.on("submit","form",function(i){i.preventDefault();f.updates.filesystemCredentials.ftp.hostname=h("#hostname").val();f.updates.filesystemCredentials.ftp.username=h("#username").val();f.updates.filesystemCredentials.ftp.password=h("#password").val();f.updates.filesystemCredentials.ftp.connectionType=h('input[name="connection_type"]:checked').val();f.updates.filesystemCredentials.ssh.publicKey=h("#public_key").val();f.updates.filesystemCredentials.ssh.privateKey=h("#private_key").val();f.updates.filesystemCredentials.fsNonce=h("#_fs_nonce").val();f.updates.filesystemCredentials.available=true;f.updates.ajaxLocked=false;f.updates.queueChecker();f.updates.requestForCredentialsModalClose()});l.on("click",'[data-js-action="close"], .notification-dialog-background',f.updates.requestForCredentialsModalCancel);b.on("change",'input[name="connection_type"]',function(){h("#ssh-keys").toggleClass("hidden",("ssh"!==h(this).val()))}).change();g.on("credential-modal-cancel",function(i,r){var j=h(".updating-message"),p,q;if("import"===pagenow){j.removeClass("updating-message")}else{if("plugins"===pagenow||"plugins-network"===pagenow){if("update-plugin"===r.action){p=h('tr[data-plugin="'+r.data.plugin+'"]').find(".update-message")}else{if("delete-plugin"===r.action){p=h('[data-plugin="'+r.data.plugin+'"]').find(".row-actions a.delete")}}}else{if("themes"===pagenow||"themes-network"===pagenow){if("update-theme"===r.action){p=h('[data-slug="'+r.data.slug+'"]').find(".update-message")}else{if("delete-theme"===r.action&&"themes-network"===pagenow){p=h('[data-slug="'+r.data.slug+'"]').find(".row-actions a.delete")}else{if("delete-theme"===r.action&&"themes"===pagenow){p=h(".theme-actions .delete-theme")}}}}else{p=j}}}if(p&&p.hasClass("updating-message")){q=p.data("originaltext");if("undefined"===typeof q){q=h("<p>").html(p.find("p").data("originaltext"))}p.removeClass("updating-message").html(q);if("plugin-install"===pagenow||"plugin-install-network"===pagenow){if("update-plugin"===r.action){p.attr("aria-label",f.updates.l10n.updateNowLabel.replace("%s",p.data("name")))}else{if("install-plugin"===r.action){p.attr("aria-label",f.updates.l10n.installNowLabel.replace("%s",p.data("name")))}}}}f.a11y.speak(f.updates.l10n.updateCancel,"polite")});k.on("click","[data-plugin] .update-link",function(i){var n=h(i.target),j=n.parents("tr");i.preventDefault();if(n.hasClass("updating-message")||n.hasClass("button-disabled")){return}f.updates.maybeRequestFilesystemCredentials(i);f.updates.$elToReturnFocusToFromCredentialsModal=j.find(".check-column input");f.updates.updatePlugin({plugin:j.data("plugin"),slug:j.data("slug")})});a.on("click",".update-now",function(j){var i=h(j.target);j.preventDefault();if(i.hasClass("updating-message")||i.hasClass("button-disabled")){return}f.updates.maybeRequestFilesystemCredentials(j);f.updates.updatePlugin({plugin:i.data("plugin"),slug:i.data("slug")})});a.on("click",".install-now",function(j){var i=h(j.target);j.preventDefault();if(i.hasClass("updating-message")||i.hasClass("button-disabled")){return}if(f.updates.shouldRequestFilesystemCredentials&&!f.updates.ajaxLocked){f.updates.requestFilesystemCredentials(j);g.on("credential-modal-cancel",function(){var n=h(".install-now.updating-message");n.removeClass("updating-message").text(f.updates.l10n.installNow);f.a11y.speak(f.updates.l10n.updateCancel,"polite")})}f.updates.installPlugin({slug:i.data("slug")})});g.on("click",".importer-item .install-now",function(n){var i=h(n.target),j=h(this).data("name");n.preventDefault();if(i.hasClass("updating-message")){return}if(f.updates.shouldRequestFilesystemCredentials&&!f.updates.ajaxLocked){f.updates.requestFilesystemCredentials(n);g.on("credential-modal-cancel",function(){i.removeClass("updating-message").text(f.updates.l10n.installNow).attr("aria-label",f.updates.l10n.installNowLabel.replace("%s",j));f.a11y.speak(f.updates.l10n.updateCancel,"polite")})}f.updates.installPlugin({slug:i.data("slug"),pagenow:pagenow,success:f.updates.installImporterSuccess,error:f.updates.installImporterError})});k.on("click","[data-plugin] a.delete",function(i){var j=h(i.target).parents("tr");i.preventDefault();if(!window.confirm(f.updates.l10n.aysDeleteUninstall.replace("%s",j.find(".plugin-title strong").text()))){return}f.updates.maybeRequestFilesystemCredentials(i);f.updates.deletePlugin({plugin:j.data("plugin"),slug:j.data("slug")})});g.on("click",".themes-php.network-admin .update-link",function(j){var n=h(j.target),i=n.parents("tr");j.preventDefault();if(n.hasClass("updating-message")||n.hasClass("button-disabled")){return}f.updates.maybeRequestFilesystemCredentials(j);f.updates.$elToReturnFocusToFromCredentialsModal=i.find(".check-column input");f.updates.updateTheme({slug:i.data("slug")})});g.on("click",".themes-php.network-admin a.delete",function(j){var i=h(j.target).parents("tr");j.preventDefault();if(!window.confirm(f.updates.l10n.aysDelete.replace("%s",i.find(".theme-title strong").text()))){return}f.updates.maybeRequestFilesystemCredentials(j);f.updates.deleteTheme({slug:i.data("slug")})});k.on("click",'[type="submit"]',function(x){var j=h(x.target).siblings("select").val(),v=k.find('input[name="checked[]"]:checked'),t=0,s=0,u=[],i,w;switch(pagenow){case"plugins":case"plugins-network":i="plugin";break;case"themes-network":i="theme";break;default:return}if(!v.length){x.preventDefault();h("html, body").animate({scrollTop:0});return f.updates.addAdminNotice({id:"no-items-selected",className:"notice-error is-dismissible",message:f.updates.l10n.noItemsSelected})}switch(j){case"update-selected":w=j.replace("selected",i);break;case"delete-selected":if(!window.confirm("plugin"===i?f.updates.l10n.aysBulkDelete:f.updates.l10n.aysBulkDeleteThemes)){x.preventDefault();return}w=j.replace("selected",i);break;default:return}f.updates.maybeRequestFilesystemCredentials(x);x.preventDefault();k.find('.manage-column [type="checkbox"]').prop("checked",false);g.trigger("wp-"+i+"-bulk-"+j,v);v.each(function(o,n){var m=h(n),p=m.parents("tr");if("update-selected"===j&&(!p.hasClass("update")||p.find("notice-error").length)){m.prop("checked",false);return}f.updates.queue.push({action:w,data:{plugin:p.data("plugin"),slug:p.data("slug")}})});g.on("wp-plugin-update-success wp-plugin-update-error wp-theme-update-success wp-theme-update-error",function(n,p){var o=h('[data-slug="'+p.slug+'"]'),q,m;if("wp-"+p.update+"-update-success"===n.type){t++}else{m=p.pluginName?p.pluginName:o.find(".column-primary strong").text();s++;u.push(m+": "+p.errorMessage)}o.find('input[name="checked[]"]:checked').prop("checked",false);f.updates.adminNotice=f.template("wp-bulk-updates-admin-notice");f.updates.addAdminNotice({id:"bulk-action-notice",className:"bulk-action-notice",successes:t,errors:s,errorMessages:u,type:p.update});q=h("#bulk-action-notice").on("click","button",function(){h(this).toggleClass("bulk-action-errors-collapsed").attr("aria-expanded",!h(this).hasClass("bulk-action-errors-collapsed"));q.find(".bulk-action-errors").toggleClass("hidden")});if(s>0&&!f.updates.queue.length){h("html, body").animate({scrollTop:0})}});g.on("wp-updates-notice-added",function(){f.updates.adminNotice=f.template("wp-updates-admin-notice")});f.updates.queueChecker()});if(d.length){d.attr("aria-describedby","live-search-desc")}d.on("keyup input",_.debounce(function(j,r){var p=h(".plugin-install-search"),i,q;i={_ajax_nonce:f.updates.ajaxNonce,s:j.target.value,tab:"search",type:h("#typeselector").val(),pagenow:pagenow};q=location.href.split("?")[0]+"?"+h.param(_.omit(i,["_ajax_nonce","pagenow"]));if("keyup"===j.type&&27===j.which){j.target.value=""}if(f.updates.searchTerm===i.s&&"typechange"!==r){return}else{a.empty();f.updates.searchTerm=i.s}if(window.history&&window.history.replaceState){window.history.replaceState(null,"",q)}if(!p.length){p=h('<li class="plugin-install-search" />').append(h("<a />",{"class":"current",href:q,text:f.updates.l10n.searchResultsLabel}));h(".wp-filter .filter-links .current").removeClass("current").parents(".filter-links").prepend(p);a.prev("p").remove();h(".plugins-popular-tags-wrapper").remove()}if("undefined"!==typeof f.updates.searchRequest){f.updates.searchRequest.abort()}h("body").addClass("loading-content");f.updates.searchRequest=f.ajax.post("search-install-plugins",i).done(function(m){h("body").removeClass("loading-content");a.append(m.items);delete f.updates.searchRequest;if(0===m.count){f.a11y.speak(f.updates.l10n.noPluginsFound)}else{f.a11y.speak(f.updates.l10n.pluginsFound.replace("%d",m.count))}})},500));if(c.length){c.attr("aria-describedby","live-search-desc")}c.on("keyup input",_.debounce(function(n){var j={_ajax_nonce:f.updates.ajaxNonce,s:n.target.value,pagenow:pagenow,plugin_status:"all"},i;if("keyup"===n.type&&27===n.which){n.target.value=""}if(f.updates.searchTerm===j.s){return}else{f.updates.searchTerm=j.s}i=_.object(_.compact(_.map(location.search.slice(1).split("&"),function(m){if(m){return m.split("=")}})));j.plugin_status=i.plugin_status||"all";if(window.history&&window.history.replaceState){window.history.replaceState(null,"",location.href.split("?")[0]+"?s="+j.s+"&plugin_status="+j.plugin_status)}if("undefined"!==typeof f.updates.searchRequest){f.updates.searchRequest.abort()}k.empty();h("body").addClass("loading-content");h(".subsubsub .current").removeClass("current");f.updates.searchRequest=f.ajax.post("search-plugins",j).done(function(r){var q=h("<span />").addClass("subtitle").html(f.updates.l10n.searchResults.replace("%s",_.escape(j.s))),m=h(".wrap .subtitle");if(!j.s.length){m.remove();h(".subsubsub ."+j.plugin_status+" a").addClass("current")}else{if(m.length){m.replaceWith(q)}else{h(".wrap h1").append(q)}}h("body").removeClass("loading-content");k.append(r.items);delete f.updates.searchRequest;if(0===r.count){f.a11y.speak(f.updates.l10n.noPluginsFound)}else{f.a11y.speak(f.updates.l10n.pluginsFound.replace("%d",r.count))}})},500));g.on("submit",".search-plugins",function(i){i.preventDefault();h("input.wp-filter-search").trigger("input")});h("#typeselector").on("change",function(){var i=h('input[name="s"]');if(i.val().length){i.trigger("input","typechange")}});h("#plugin_update_from_iframe").on("click",function(n){var j=window.parent===window?null:window.parent,i;h.support.postMessage=!!window.postMessage;if(false===h.support.postMessage||null===j||-1!==window.parent.location.pathname.indexOf("update-core.php")){return}n.preventDefault();i={action:"update-plugin",data:{plugin:h(this).data("plugin"),slug:h(this).data("slug")}};j.postMessage(JSON.stringify(i),window.location.origin)});h("#plugin_install_from_iframe").on("click",function(n){var i=window.parent===window?null:window.parent,j;h.support.postMessage=!!window.postMessage;if(false===h.support.postMessage||null===i||-1!==window.parent.location.pathname.indexOf("index.php")){return}n.preventDefault();j={action:"install-plugin",data:{slug:h(this).data("slug")}};i.postMessage(JSON.stringify(j),window.location.origin)});h(window).on("message",function(i){var p=i.originalEvent,q=document.location.protocol+"//"+document.location.hostname,j;if(p.origin!==q){return}try{j=h.parseJSON(p.data)}catch(r){return}if("undefined"===typeof j.action){return}switch(j.action){case"decrementUpdateCount":f.updates.decrementCount(j.upgradeType);break;case"install-plugin":case"update-plugin":window.tb_remove();j.data=f.updates._addCallbacks(j.data,j.action);f.updates.queue.push(j);f.updates.queueChecker();break}});h(window).on("beforeunload",f.updates.beforeunload)})})(jQuery,window.wp,window._wpUpdatesSettings);