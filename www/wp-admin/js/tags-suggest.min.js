(function(c){if(typeof window.tagsSuggestL10n==="undefined"||typeof window.uiAutocompleteL10n==="undefined"){return}var a=0;var d=window.tagsSuggestL10n.tagDelimiter||",";function b(f){return f.split(new RegExp(d+"\\s*"))}function e(f){return b(f).pop()}c.fn.wpTagsSuggest=function(i){var h;var j;var g=c(this);i=i||{};var f=i.taxonomy||g.attr("data-wp-taxonomy")||"post_tag";delete (i.taxonomy);i=c.extend({source:function(m,k){var l;if(j===m.term){k(h);return}l=e(m.term);c.get(window.ajaxurl,{action:"ajax-tag-search",tax:f,q:l}).always(function(){g.removeClass("ui-autocomplete-loading")}).done(function(p){var o;var n=[];if(p){p=p.split("\n");for(o in p){var q=++a;n.push({id:q,name:p[o]})}h=n;k(n)}else{k(n)}});j=m.term},focus:function(k,l){g.attr("aria-activedescendant","wp-tags-autocomplete-"+l.item.id);k.preventDefault()},select:function(l,m){var k=b(g.val());k.pop();k.push(m.item.name,"");g.val(k.join(d+" "));if(c.ui.keyCode.TAB===l.keyCode){window.wp.a11y.speak(window.tagsSuggestL10n.termSelected,"assertive");l.preventDefault()}else{if(c.ui.keyCode.ENTER===l.keyCode){l.preventDefault();l.stopPropagation()}}return false},open:function(){g.attr("aria-expanded","true")},close:function(){g.attr("aria-expanded","false")},minLength:2,position:{my:"left top+2",at:"left bottom",collision:"none"},messages:{noResults:window.uiAutocompleteL10n.noResults,results:function(k){if(k>1){return window.uiAutocompleteL10n.manyResults.replace("%d",k)}return window.uiAutocompleteL10n.oneResult}}},i);g.on("keydown",function(){g.removeAttr("aria-activedescendant")}).autocomplete(i).autocomplete("instance")._renderItem=function(k,l){return c('<li role="option" id="wp-tags-autocomplete-'+l.id+'">').text(l.name).appendTo(k)};g.attr({role:"combobox","aria-autocomplete":"list","aria-expanded":"false","aria-owns":g.autocomplete("widget").attr("id")}).on("focus",function(){var k=b(g.val()).pop();if(k){g.autocomplete("search")}}).autocomplete("widget").addClass("wp-tags-autocomplete").attr("role","listbox").removeAttr("tabindex").on("menufocus",function(k,l){l.item.attr("aria-selected","true")}).on("menublur",function(){c(this).find('[aria-selected="true"]').removeAttr("aria-selected")});return this}}(jQuery));