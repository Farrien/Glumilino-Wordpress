!function(h,g){var l,k,j,i=wp.customize;i.Setting=i.Value.extend({initialize:function(f,e,n){var m=this;i.Value.prototype.initialize.call(m,e,n),m.id=f,m.transport=m.transport||"refresh",m._dirty=n.dirty||!1,m.notifications=new i.Values({defaultConstructor:i.Notification}),m.bind(m.preview)},preview:function(){var d,c=this;d=c.transport,"postMessage"!==d||i.state("previewerAlive").get()||(d="refresh"),"postMessage"===d?c.previewer.send("setting",[c.id,c()]):"refresh"===d&&c.previewer.refresh()},findControls:function(){var d=this,c=[];return i.control.each(function(a){_.each(a.settings,function(b){b.id===d.id&&c.push(a)})}),c}}),i._latestRevision=0,i._lastSavedRevision=0,i._latestSettingRevisions={},i.bind("change",function(b){i._latestRevision+=1,i._latestSettingRevisions[b.id]=i._latestRevision}),i.bind("ready",function(){i.bind("add",function(b){b._dirty&&(i._latestRevision+=1,i._latestSettingRevisions[b.id]=i._latestRevision)})}),i.dirtyValues=function(d){var c={};return i.each(function(b){var a;b._dirty&&(a=i._latestSettingRevisions[b.id],i.state("changesetStatus").get()&&d&&d.unsaved&&(_.isUndefined(a)||a<=i._lastSavedRevision)||(c[b.id]=b.get()))}),c},i.requestChangesetUpdate=function(b){var o,n,m,f={};return o=new g.Deferred,b&&_.extend(f,b),_.each(i.dirtyValues({unsaved:!0}),function(a,d){b&&null===b[d]||(f[d]=_.extend({},f[d]||{},{value:a}))}),_.isEmpty(f)?(o.resolve({}),o.promise()):(i.state("processing").set(i.state("processing").get()+1),o.always(function(){i.state("processing").set(i.state("processing").get()-1)}),i.trigger("changeset-save",f),m=i.previewer.query({excludeCustomizedSaved:!0}),delete m.customized,_.extend(m,{nonce:i.settings.nonce.save,customize_theme:i.settings.theme.stylesheet,customize_changeset_data:JSON.stringify(f)}),n=wp.ajax.post("customize_save",m),n.done(function(d){var c={};i._lastSavedRevision=Math.max(i._latestRevision,i._lastSavedRevision),i.state("changesetStatus").set(d.changeset_status),o.resolve(d),i.trigger("changeset-saved",d),d.setting_validities&&_.each(d.setting_validities,function(e,p){!0===e&&_.isObject(f[p])&&!_.isUndefined(f[p].value)&&(c[p]=f[p].value)}),i.previewer.send("changeset-saved",_.extend({},d,{saved_changeset_values:c}))}),n.fail(function(c){o.reject(c),i.trigger("changeset-error",c)}),n.always(function(c){c.setting_validities&&i._handleSettingValidities({settingValidities:c.setting_validities})}),o.promise())},i.utils.bubbleChildValueChanges=function(b,d){g.each(d,function(a,e){b[e].bind(function(f,m){b.parent&&f!==m&&b.parent.trigger("change",b)})})},k=function(m){var f,p,o,n;f=this,m=m||{},o=function(){var b;b=(f.extended(i.Panel)||f.extended(i.Section))&&f.expanded&&f.expanded()?f.contentContainer:f.container,n=b.find(".control-focus:first"),0===n.length&&(n=b.find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible").first()),n.focus()},m.completeCallback?(p=m.completeCallback,m.completeCallback=function(){o(),p()}):m.completeCallback=o,i.state("paneVisible").set(!0),f.expand?f.expand(m):m.completeCallback()},i.utils.prioritySort=function(d,c){return d.priority()===c.priority()&&"number"==typeof d.params.instanceNumber&&"number"==typeof c.params.instanceNumber?d.params.instanceNumber-c.params.instanceNumber:d.priority()-c.priority()},i.utils.isKeydownButNotEnterEvent=function(b){return"keydown"===b.type&&13!==b.which},i.utils.areElementListsEqual=function(b,f){var e=b.length===f.length&&-1===_.indexOf(_.map(_.zip(b,f),function(c){return g(c[0]).is(c[1])}),!1);return e},j=function(){var e,d,f;return e=document.createElement("div"),d={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},f=_.find(_.keys(d),function(a){return !_.isUndefined(e.style[a])}),f?d[f]:null}(),l=i.Class.extend({defaultActiveArguments:{duration:"fast",completeCallback:g.noop},defaultExpandedArguments:{duration:"fast",completeCallback:g.noop},containerType:"container",defaults:{title:"",description:"",priority:100,type:"default",content:null,active:!0,instanceNumber:null},initialize:function(b,f){var e=this;e.id=b,f=f||{},f.params=_.defaults(f.params||{},e.defaults),g.extend(e,f),e.templateSelector="customize-"+e.containerType+"-"+e.params.type,e.container=g(e.params.content),0===e.container.length&&(e.container=g(e.getContainer())),e.headContainer=e.container,e.contentContainer=e.getContent(),e.container=e.container.add(e.contentContainer),e.deferred={embedded:new g.Deferred},e.priority=new i.Value,e.active=new i.Value,e.activeArgumentsQueue=[],e.expanded=new i.Value,e.expandedArgumentsQueue=[],e.active.bind(function(d){var m=e.activeArgumentsQueue.shift();m=g.extend({},e.defaultActiveArguments,m),d=d&&e.isContextuallyActive(),e.onChangeActive(d,m)}),e.expanded.bind(function(d){var m=e.expandedArgumentsQueue.shift();m=g.extend({},e.defaultExpandedArguments,m),e.onChangeExpanded(d,m)}),e.deferred.embedded.done(function(){e.attachEvents()}),i.utils.bubbleChildValueChanges(e,["priority","active"]),e.priority.set(e.params.priority),e.active.set(e.params.active),e.expanded.set(!1)},ready:function(){},_children:function(f,e){var n=this,m=[];return i[e].each(function(a){a[f].get()===n.id&&m.push(a)}),m.sort(i.utils.prioritySort),m},isContextuallyActive:function(){throw new Error("Container.isContextuallyActive() must be overridden in a subclass.")},onChangeActive:function(b,p){var o,n,m=this,f=m.headContainer;return p.unchanged?void (p.completeCallback&&p.completeCallback()):(o="resolved"===i.previewer.deferred.active.state()?p.duration:0,m.extended(i.Panel)&&(i.panel.each(function(c){c!==m&&c.expanded()&&(n=c,o=0)}),b||_.each(m.sections(),function(c){c.collapse({duration:0})})),void (g.contains(document,f.get(0))?b?f.slideDown(o,p.completeCallback):m.expanded()?m.collapse({duration:o,completeCallback:function(){f.slideUp(o,p.completeCallback)}}):f.slideUp(o,p.completeCallback):(f.toggle(b),p.completeCallback&&p.completeCallback())))},_toggleActive:function(e,d){var f=this;return d=d||{},e&&this.active.get()||!e&&!this.active.get()?(d.unchanged=!0,f.onChangeActive(f.active.get(),d),!1):(d.unchanged=!1,this.activeArgumentsQueue.push(d),this.active.set(e),!0)},activate:function(b){return this._toggleActive(!0,b)},deactivate:function(b){return this._toggleActive(!1,b)},onChangeExpanded:function(){throw new Error("Must override with subclass.")},_toggleExpanded:function(f,e){var n,m=this;return e=e||{},n=e.completeCallback,!(f&&!m.active())&&(i.state("paneVisible").set(!0),e.completeCallback=function(){n&&n.apply(m,arguments),f?m.container.trigger("expanded"):m.container.trigger("collapsed")},f&&m.expanded.get()||!f&&!m.expanded.get()?(e.unchanged=!0,m.onChangeExpanded(m.expanded.get(),e),!1):(e.unchanged=!1,m.expandedArgumentsQueue.push(e),m.expanded.set(f),!0))},expand:function(b){return this._toggleExpanded(!0,b)},collapse:function(b){return this._toggleExpanded(!1,b)},_animateChangeExpanded:function(b){if(!j){return void (b&&b())}var p,o,n,m=this,f=m.contentContainer,e=f.closest(".wp-full-overlay");p=e.add(f),n=!m.panel||""===m.panel()||!!i.panel(m.panel()).contentContainer.hasClass("skip-transition"),n&&(p=p.add("#customize-info, .customize-pane-parent")),o=function(a){2===a.eventPhase&&g(a.target).is(f)&&(f.off(j,o),p.removeClass("busy"),b&&b())},f.on(j,o),p.addClass("busy"),_.defer(function(){var r=f.closest(".wp-full-overlay-sidebar-content"),q=r.scrollTop(),t=f.data("previous-scrollTop")||0,s=m.expanded();s&&0<q?(f.css("top",q+"px"),f.data("previous-scrollTop",q)):!s&&0<q+t&&(f.css("top",t-q+"px"),r.scrollTop(t))})},focus:k,getContainer:function(){var b,d=this;return b=0!==g("#tmpl-"+d.templateSelector).length?wp.template(d.templateSelector):wp.template("customize-"+d.containerType+"-default"),b&&d.container?g.trim(b(d.params)):"<li></li>"},getContent:function(){var n=this,m=n.container,r=m.find(".accordion-section-content, .control-panel-content").first(),q="sub-"+m.attr("id"),p=q,o=m.attr("aria-owns");return o&&(p=p+" "+o),m.attr("aria-owns",p),r.detach().attr({id:q,"class":"customize-pane-child "+r.attr("class")+" "+m.attr("class")})}}),i.Section=l.extend({containerType:"section",defaults:{title:"",description:"",priority:100,type:"default",content:null,active:!0,instanceNumber:null,panel:null,customizeAction:""},initialize:function(b,f){var c=this;l.prototype.initialize.call(c,b,f),c.id=b,c.panel=new i.Value,c.panel.bind(function(d){g(c.headContainer).toggleClass("control-subsection",!!d)}),c.panel.set(c.params.panel||""),i.utils.bubbleChildValueChanges(c,["panel"]),c.embed(),c.deferred.embedded.done(function(){c.ready()})},embed:function(){var b,f=this,e=g("#customize-theme-controls");b=function(c){var d;c?i.panel(c,function(m){m.deferred.embedded.done(function(){d=m.contentContainer,f.headContainer.parent().is(d)||d.append(f.headContainer),f.contentContainer.parent().is(f.headContainer)||e.append(f.contentContainer),f.deferred.embedded.resolve()})}):(d=g(".customize-pane-parent"),f.headContainer.parent().is(d)||d.append(f.headContainer),f.contentContainer.parent().is(f.headContainer)||e.append(f.contentContainer),f.deferred.embedded.resolve())},f.panel.bind(b),b(f.panel.get())},attachEvents:function(){var e,d,f=this;f.container.hasClass("cannot-expand")||(f.container.find(".accordion-section-title, .customize-section-back").on("click keydown",function(b){i.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),f.expanded()?f.collapse():f.expand())}),f.container.find(".customize-section-title .customize-help-toggle").on("click",function(){e=f.container.find(".section-meta"),e.hasClass("cannot-expand")||(d=e.find(".customize-section-description:first"),d.toggleClass("open"),d.slideToggle(),d.attr("aria-expanded",function(m,c){return"true"===c?"false":"true"}))}))},isContextuallyActive:function(){var e=this,d=e.controls(),f=0;return _(d).each(function(b){b.active()&&(f+=1)}),0!==f},controls:function(){return this._children("section","control")},onChangeExpanded:function(t,s){var r,q,p=this,o=p.headContainer.closest(".wp-full-overlay-sidebar-content"),n=p.contentContainer,m=p.headContainer.closest(".wp-full-overlay"),f=n.find(".customize-section-back"),b=p.headContainer.find(".accordion-section-title").first();t&&!n.hasClass("open")?(r=s.unchanged?s.completeCallback:g.proxy(function(){p._animateChangeExpanded(function(){b.attr("tabindex","-1"),f.attr("tabindex","0"),f.focus(),n.css("top",""),o.scrollTop(0),s.completeCallback&&s.completeCallback()}),n.addClass("open"),m.addClass("section-open"),i.state("expandedSection").set(p)},this),s.allowMultiple||i.section.each(function(c){c!==p&&c.collapse({duration:s.duration})}),p.panel()?i.panel(p.panel()).expand({duration:s.duration,completeCallback:r}):(i.panel.each(function(c){c.collapse()}),r())):!t&&n.hasClass("open")?(p.panel()&&(q=i.panel(p.panel()),q.contentContainer.hasClass("skip-transition")&&q.collapse()),p._animateChangeExpanded(function(){f.attr("tabindex","-1"),b.attr("tabindex","0"),b.focus(),n.css("top",""),s.completeCallback&&s.completeCallback()}),n.removeClass("open"),m.removeClass("section-open"),p===i.state("expandedSection").get()&&i.state("expandedSection").set(!1)):s.completeCallback&&s.completeCallback()}}),i.ThemesSection=i.Section.extend({currentTheme:"",overlay:"",template:"",screenshotQueue:null,$window:g(window),initialize:function(){return this.$customizeSidebar=g(".wp-full-overlay-sidebar-content:first"),i.Section.prototype.initialize.apply(this,arguments)},ready:function(){var b=this;b.overlay=b.container.find(".theme-overlay"),b.template=wp.template("customize-themes-details-view"),b.container.on("keydown",function(a){b.overlay.find(".theme-wrap").is(":visible")&&(39===a.keyCode&&b.nextTheme(),37===a.keyCode&&b.previousTheme(),27===a.keyCode&&(b.closeDetails(),a.stopPropagation()))}),_.bindAll(this,"renderScreenshots")},isContextuallyActive:function(){return this.active()},attachEvents:function(){var d=this;d.container.find(".change-theme, .customize-theme").on("click keydown",function(a){i.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),d.expanded()?d.collapse():d.expand())}),d.container.on("click keydown",".left",function(a){i.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),d.previousTheme())}),d.container.on("click keydown",".right",function(a){i.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),d.nextTheme())}),d.container.on("click keydown",".theme-backdrop, .close",function(a){i.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),d.closeDetails())});var c=_.throttle(_.bind(d.renderScreenshots,this),100);d.container.on("input","#themes-filter",function(n){var m,b=n.currentTarget.value.toLowerCase().trim().replace("-"," "),a=d.controls();_.each(a,function(e){e.filter(b)}),c(),m=d.container.find("li.customize-control:visible").length,d.container.find(".theme-count").text(m)}),i.bind("ready",function(){_.each(d.controls().slice(0,3),function(f){var e,m=f.params.theme.screenshot[0];m&&(e=new Image,e.src=m)})})},onChangeExpanded:function(m,f){if(f.unchanged){return void (f.completeCallback&&f.completeCallback())}var s=this,r=s.contentContainer,q=r.closest(".wp-full-overlay"),p=r.closest(".wp-full-overlay-sidebar-content"),o=r.find(".customize-theme"),n=s.headContainer.find(".change-theme");m&&!r.hasClass("current-panel")?(i.section.each(function(b){b!==s&&b.collapse({duration:f.duration})}),i.panel.each(function(b){b.collapse({duration:0})}),s._animateChangeExpanded(function(){n.attr("tabindex","-1"),o.attr("tabindex","0"),o.focus(),r.css("top",""),p.scrollTop(0),f.completeCallback&&f.completeCallback()}),q.addClass("in-themes-panel"),r.addClass("current-panel"),_.delay(s.renderScreenshots,10),s.$customizeSidebar.on("scroll.customize-themes-section",_.throttle(s.renderScreenshots,300))):!m&&r.hasClass("current-panel")&&(s._animateChangeExpanded(function(){n.attr("tabindex","0"),o.attr("tabindex","-1"),n.focus(),r.css("top",""),f.completeCallback&&f.completeCallback()}),q.removeClass("in-themes-panel"),r.removeClass("current-panel"),s.$customizeSidebar.off("scroll.customize-themes-section"))},renderScreenshots:function(){var b=this;null===b.screenshotQueue&&(b.screenshotQueue=b.controls()),b.screenshotQueue.length&&(b.screenshotQueue=_.filter(b.screenshotQueue,function(u){var t=u.container.find(".theme-screenshot"),s=t.find("img");if(!s.length){return !1}if(s.is(":hidden")){return !0}var r=b.$window.scrollTop(),q=r+b.$window.height(),p=s.offset().top,o=t.height(),n=p+o,m=3*o,a=n>=r-m&&p<=q+m;return a&&u.container.trigger("render-screenshot"),!a}))},nextTheme:function(){var b=this;b.getNextTheme()&&b.showDetails(b.getNextTheme(),function(){b.overlay.find(".right").focus()})},getNextTheme:function(){var d,c;return d=i.control("theme_"+this.currentTheme),c=d.container.next("li.customize-control-theme"),!!c.length&&(c=c[0].id.replace("customize-control-",""),d=i.control(c),d.params.theme)},previousTheme:function(){var b=this;b.getPreviousTheme()&&b.showDetails(b.getPreviousTheme(),function(){b.overlay.find(".left").focus()})},getPreviousTheme:function(){var d,c;return d=i.control("theme_"+this.currentTheme),c=d.container.prev("li.customize-control-theme"),!!c.length&&(c=c[0].id.replace("customize-control-",""),d=i.control(c),d.params.theme)},updateLimits:function(){this.getNextTheme()||this.overlay.find(".right").addClass("disabled"),this.getPreviousTheme()||this.overlay.find(".left").addClass("disabled")},loadThemePreview:function(b){var o,n,m,f=g.Deferred();return m=document.createElement("a"),m.href=location.href,m.search=g.param(_.extend(i.utils.parseQueryString(m.search.substr(1)),{theme:b,changeset_uuid:i.settings.changeset.uuid})),n=g(".wp-full-overlay"),n.addClass("customize-loading"),o=function(){var c;i.state("processing").get()>0||(i.state("processing").unbind(o),c=i.requestChangesetUpdate(),c.done(function(){g(window).off("beforeunload.customize-confirm"),top.location.href=m.href,f.resolve()}),c.fail(function(){n.removeClass("customize-loading"),f.reject()}))},0===i.state("processing").get()?o():i.state("processing").bind(o),f.promise()},showDetails:function(b,n){var m,f=this;n=n||function(){},f.currentTheme=b.id,f.overlay.html(f.template(b)).fadeIn("fast").focus(),g("body").addClass("modal-open"),f.containFocus(f.overlay),f.updateLimits(),m=f.overlay.find(".inactive-theme > a"),m.on("click",function(a){a.preventDefault(),m.hasClass("disabled")||(m.addClass("disabled"),f.loadThemePreview(b.id).fail(function(){m.removeClass("disabled")}))}),n()},closeDetails:function(){g("body").removeClass("modal-open"),this.overlay.fadeOut("fast"),i.control("theme_"+this.currentTheme).focus()},containFocus:function(b){var d;b.on("keydown",function(a){if(9===a.keyCode){return d=g(":tabbable",b),d.last()[0]!==a.target||a.shiftKey?d.first()[0]===a.target&&a.shiftKey?(d.last().focus(),!1):void 0:(d.first().focus(),!1)}})}}),i.Panel=l.extend({containerType:"panel",initialize:function(e,c){var f=this;l.prototype.initialize.call(f,e,c),f.embed(),f.deferred.embedded.done(function(){f.ready()})},embed:function(){var b=this,f=g("#customize-theme-controls"),e=g(".customize-pane-parent");b.headContainer.parent().is(e)||e.append(b.headContainer),b.contentContainer.parent().is(b.headContainer)||(f.append(b.contentContainer),b.renderContent()),b.deferred.embedded.resolve()},attachEvents:function(){var b,d=this;d.headContainer.find(".accordion-section-title").on("click keydown",function(c){i.utils.isKeydownButNotEnterEvent(c)||(c.preventDefault(),d.expanded()||d.expand())}),d.container.find(".customize-panel-back").on("click keydown",function(c){i.utils.isKeydownButNotEnterEvent(c)||(c.preventDefault(),d.expanded()&&d.collapse())}),b=d.container.find(".panel-meta:first"),b.find("> .accordion-section-title .customize-help-toggle").on("click keydown",function(c){if(!i.utils.isKeydownButNotEnterEvent(c)&&(c.preventDefault(),!b.hasClass("cannot-expand"))){var a=b.find(".customize-panel-description:first");b.hasClass("open")?(b.toggleClass("open"),a.slideUp(d.defaultExpandedArguments.duration),g(this).attr("aria-expanded",!1)):(a.slideDown(d.defaultExpandedArguments.duration),b.toggleClass("open"),g(this).attr("aria-expanded",!0))}})},sections:function(){return this._children("panel","section")},isContextuallyActive:function(){var e=this,d=e.sections(),f=0;return _(d).each(function(b){b.active()&&b.isContextuallyActive()&&(f+=1)}),0!==f},onChangeExpanded:function(u,t){if(t.unchanged){return void (t.completeCallback&&t.completeCallback())}var s,r=this,q=r.contentContainer,p=q.closest(".wp-full-overlay"),o=q.closest(".wp-full-overlay-sidebar-content"),n=r.headContainer.find(".accordion-section-title"),m=q.find(".customize-panel-back"),f=r.sections();u&&!q.hasClass("current-panel")?(i.section.each(function(b){r.id!==b.panel()&&b.collapse({duration:0})}),i.panel.each(function(b){r!==b&&b.collapse({duration:0})}),r.params.autoExpandSoleSection&&1===f.length&&f[0].active.get()?(q.addClass("current-panel skip-transition"),p.addClass("in-sub-panel"),f[0].expand({completeCallback:t.completeCallback})):(r._animateChangeExpanded(function(){n.attr("tabindex","-1"),m.attr("tabindex","0"),m.focus(),q.css("top",""),o.scrollTop(0),t.completeCallback&&t.completeCallback()}),q.addClass("current-panel"),p.addClass("in-sub-panel")),i.state("expandedPanel").set(r)):!u&&q.hasClass("current-panel")&&(s=q.hasClass("skip-transition"),s?q.removeClass("skip-transition"):r._animateChangeExpanded(function(){n.attr("tabindex","0"),m.attr("tabindex","-1"),n.focus(),q.css("top",""),t.completeCallback&&t.completeCallback()}),p.removeClass("in-sub-panel"),q.removeClass("current-panel"),r===i.state("expandedPanel").get()&&i.state("expandedPanel").set(!1))},renderContent:function(){var b,d=this;b=0!==g("#tmpl-"+d.templateSelector+"-content").length?wp.template(d.templateSelector+"-content"):wp.template("customize-panel-default-content"),b&&d.headContainer&&d.contentContainer.html(b(d.params))}}),i.Control=i.Class.extend({defaultActiveArguments:{duration:"fast",completeCallback:g.noop},initialize:function(b,p){var o,n,m,f=this;f.params={},g.extend(f,p||{}),f.id=b,f.selector="#customize-control-"+b.replace(/\]/g,"").replace(/\[/g,"-"),f.templateSelector="customize-control-"+f.params.type+"-content",f.container=g(f.params.content?f.params.content:f.selector),f.deferred={embedded:new g.Deferred},f.section=new i.Value,f.priority=new i.Value,f.active=new i.Value,f.activeArgumentsQueue=[],f.notifications=new i.Values({defaultConstructor:i.Notification}),f.elements=[],o=f.container.find("[data-customize-setting-link]"),n={},o.each(function(){var d,e=g(this);if(e.is(":radio")){if(d=e.prop("name"),n[d]){return}n[d]=!0,e=o.filter('[name="'+d+'"]')}i(e.data("customizeSettingLink"),function(q){var c=new i.Element(e);f.elements.push(c),c.sync(q),c.set(q())})}),f.active.bind(function(d){var e=f.activeArgumentsQueue.shift();e=g.extend({},f.defaultActiveArguments,e),f.onChangeActive(d,e)}),f.section.set(f.params.section),f.priority.set(isNaN(f.params.priority)?10:f.params.priority),f.active.set(f.params.active),i.utils.bubbleChildValueChanges(f,["section","priority","active"]),m=g.map(f.params.settings,function(c){return c}),0===m.length?(f.setting=null,f.settings={},f.embed()):i.apply(i,m.concat(function(){var c;f.settings={};for(c in f.params.settings){f.settings[c]=i(f.params.settings[c])}f.setting=f.settings["default"]||null,_.each(f.settings,function(d){d.notifications.bind("add",function(a){var s,r,q;r=d.id+":"+a.code,q=_.extend({},a,{setting:d.id}),s=new i.Notification(r,q),f.notifications.add(s.code,s)}),d.notifications.bind("remove",function(a){f.notifications.remove(d.id+":"+a.code)})}),f.embed()})),f.deferred.embedded.done(function(){var c=_.debounce(function(){f.renderNotifications()});f.notifications.bind("add",function(a){wp.a11y.speak(a.message,"assertive"),c()}),f.notifications.bind("remove",c),f.renderNotifications(),f.ready()})},embed:function(){var d,c=this;d=function(b){var e;b&&i.section(b,function(f){f.deferred.embedded.done(function(){e=f.contentContainer.is("ul")?f.contentContainer:f.contentContainer.find("ul:first"),c.container.parent().is(e)||(e.append(c.container),c.renderContent()),c.deferred.embedded.resolve()})})},c.section.bind(d),d(c.section.get())},ready:function(){var b,d=this;"dropdown-pages"===d.params.type&&d.params.allow_addition&&(b=d.container.find(".new-content-item"),b.hide(),d.container.on("click",".add-new-toggle",function(a){g(a.currentTarget).slideUp(180),b.slideDown(180),b.find(".create-item-input").focus()}),d.container.on("click",".add-content",function(){d.addNewPage()}),d.container.on("keyup",".create-item-input",function(c){13===c.which&&d.addNewPage()}))},getNotificationsContainerElement:function(){var b,f,e=this;return f=e.container.find(".customize-control-notifications-container:first"),f.length?f:(f=g('<div class="customize-control-notifications-container"></div>'),e.container.hasClass("customize-control-nav_menu_item")?e.container.find(".menu-item-settings:first").prepend(f):e.container.hasClass("customize-control-widget_form")?e.container.find(".widget-inside:first").prepend(f):(b=e.container.find(".customize-control-title"),b.length?b.after(f):e.container.prepend(f)),f)},renderNotifications:function(){var b,n,m=this,f=!1;b=m.getNotificationsContainerElement(),b&&b.length&&(n=[],m.notifications.each(function(c){n.push(c),"error"===c.type&&(f=!0)}),0===n.length?b.stop().slideUp("fast"):b.stop().slideDown("fast",null,function(){g(this).css("height","auto")}),m.notificationsTemplate||(m.notificationsTemplate=wp.template("customize-control-notifications")),m.container.toggleClass("has-notifications",0!==n.length),m.container.toggleClass("has-error",f),b.empty().append(g.trim(m.notificationsTemplate({notifications:n,altNotice:Boolean(m.altNotice)}))))},expand:function(b){i.section(this.section()).expand(b)},focus:k,onChangeActive:function(b,d){return d.unchanged?void (d.completeCallback&&d.completeCallback()):void (g.contains(document,this.container[0])?b?this.container.slideDown(d.duration,d.completeCallback):this.container.slideUp(d.duration,d.completeCallback):(this.container.toggle(b),d.completeCallback&&d.completeCallback()))},toggle:function(b){return this.onChangeActive(b,this.defaultActiveArguments)},activate:l.prototype.activate,deactivate:l.prototype.deactivate,_toggleActive:l.prototype._toggleActive,dropdownInit:function(){var m=this,f=this.container.find(".dropdown-status"),p=this.params,o=!1,n=function(b){"string"==typeof b&&p.statuses&&p.statuses[b]?f.html(p.statuses[b]).show():f.hide()};this.container.on("click keydown",".dropdown",function(a){i.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),o||m.container.toggleClass("open"),m.container.hasClass("open")&&m.container.parent().parent().find("li.library-selected").focus(),o=!0,setTimeout(function(){o=!1},400))}),this.setting.bind(n),n(this.setting())},renderContent:function(){var b,d=this;0!==g("#tmpl-"+d.templateSelector).length&&(b=wp.template(d.templateSelector),b&&d.container&&d.container.html(b(d.params)))},addNewPage:function(){var b,q,p,o,n,m,f=this;if("dropdown-pages"===f.params.type&&f.params.allow_addition&&i.Menus){if(q=f.container.find(".add-new-toggle"),p=f.container.find(".new-content-item"),o=f.container.find(".create-item-input"),n=o.val(),m=f.container.find("select"),!n){return void o.addClass("invalid")}o.removeClass("invalid"),o.attr("disabled","disabled"),b=i.Menus.insertAutoDraftPost({post_title:n,post_type:"page"}),b.done(function(c){var s,r,d;s=new i.Menus.AvailableItemModel({id:"post-"+c.post_id,title:n,type:"post_type",type_label:i.Menus.data.l10n.page_label,object:"page",object_id:c.post_id,url:c.url}),i.Menus.availableMenuItemsPanel.collection.add(s),r=g("#available-menu-items-post_type-page").find(".available-menu-items-list"),d=wp.template("available-menu-item"),r.prepend(d(s.attributes)),m.focus(),f.setting.set(String(c.post_id)),p.slideUp(180),q.slideDown(180)}),b.always(function(){o.val("").removeAttr("disabled")})}}}),i.ColorControl=i.Control.extend({ready:function(){var f,e=this,n="hue"===this.params.mode,m=!1;n?(f=this.container.find(".color-picker-hue"),f.val(e.setting()).wpColorPicker({change:function(b,d){m=!0,e.setting(d.color.h()),m=!1}})):(f=this.container.find(".color-picker-hex"),f.val(e.setting()).wpColorPicker({change:function(){m=!0,e.setting.set(f.wpColorPicker("color")),m=!1},clear:function(){m=!0,e.setting.set(""),m=!1}})),e.setting.bind(function(a){m||(f.val(a),f.wpColorPicker("color",a))}),e.container.on("keydown",function(b){var a;27===b.which&&(a=e.container.find(".wp-picker-container"),a.hasClass("wp-picker-active")&&(f.wpColorPicker("close"),e.container.find(".wp-color-result").focus(),b.stopPropagation()))})}}),i.MediaControl=i.Control.extend({ready:function(){function b(c){var e=g.Deferred();d.extended(i.UploadControl)?e.resolve():(c=parseInt(c,10),_.isNaN(c)||c<=0?(delete d.params.attachment,e.resolve()):d.params.attachment&&d.params.attachment.id===c&&e.resolve()),"pending"===e.state()&&wp.media.attachment(c).fetch().done(function(){d.params.attachment=this.attributes,e.resolve(),wp.customize.previewer.send(d.setting.id+"-attachment-data",this.attributes)}),e.done(function(){d.renderContent()})}var d=this;_.bindAll(d,"restoreDefault","removeFile","openFrame","select","pausePlayer"),d.container.on("click keydown",".upload-button",d.openFrame),d.container.on("click keydown",".upload-button",d.pausePlayer),d.container.on("click keydown",".thumbnail-image img",d.openFrame),d.container.on("click keydown",".default-button",d.restoreDefault),d.container.on("click keydown",".remove-button",d.pausePlayer),d.container.on("click keydown",".remove-button",d.removeFile),d.container.on("click keydown",".remove-button",d.cleanupPlayer),i.section(d.section()).container.on("expanded",function(){d.player&&d.player.setControlsSize()}).on("collapsed",function(){d.pausePlayer()}),b(d.setting()),d.setting.bind(b)},pausePlayer:function(){this.player&&this.player.pause()},cleanupPlayer:function(){this.player&&wp.media.mixin.removePlayer(this.player)},openFrame:function(b){i.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),this.frame||this.initFrame(),this.frame.open())},initFrame:function(){this.frame=wp.media({button:{text:this.params.button_labels.frame_button},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:this.params.mime_type}),multiple:!1,date:!1})]}),this.frame.on("select",this.select)},select:function(){var e,d=this.frame.state().get("selection").first().toJSON(),f=window._wpmejsSettings||{};this.params.attachment=d,this.setting(d.id),e=this.container.find("audio, video").get(0),e?this.player=new MediaElementPlayer(e,f):this.cleanupPlayer()},restoreDefault:function(b){i.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),this.params.attachment=this.params.defaultAttachment,this.setting(this.params.defaultAttachment.url))},removeFile:function(b){i.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),this.params.attachment={},this.setting(""),this.renderContent())}}),i.UploadControl=i.MediaControl.extend({select:function(){var e,d=this.frame.state().get("selection").first().toJSON(),f=window._wpmejsSettings||{};this.params.attachment=d,this.setting(d.url),e=this.container.find("audio, video").get(0),e?this.player=new MediaElementPlayer(e,f):this.cleanupPlayer()},success:function(){},removerVisibility:function(){}}),i.ImageControl=i.UploadControl.extend({thumbnailSrc:function(){}}),i.BackgroundControl=i.UploadControl.extend({ready:function(){i.UploadControl.prototype.ready.apply(this,arguments)},select:function(){i.UploadControl.prototype.select.apply(this,arguments),wp.ajax.post("custom-background-add",{nonce:_wpCustomizeBackground.nonces.add,wp_customize:"on",customize_theme:i.settings.theme.stylesheet,attachment_id:this.params.attachment.id})}}),i.BackgroundPositionControl=i.Control.extend({ready:function(){var b,d=this;d.container.on("change",'input[name="background-position"]',function(){var c=g(this).val().split(" ");d.settings.x(c[0]),d.settings.y(c[1])}),b=_.debounce(function(){var f,c,n,m;f=d.settings.x.get(),c=d.settings.y.get(),m=String(f)+" "+String(c),n=d.container.find('input[name="background-position"][value="'+m+'"]'),n.click()}),d.settings.x.bind(b),d.settings.y.bind(b),b()}}),i.CroppedImageControl=i.MediaControl.extend({openFrame:function(b){i.utils.isKeydownButNotEnterEvent(b)||(this.initFrame(),this.frame.setState("library").open())},initFrame:function(){var b=_wpMediaViewsL10n;this.frame=wp.media({button:{text:b.select,close:!1},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new wp.media.controller.CustomizeImageCropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect:function(){var b=this.frame.state().get("selection").first().toJSON();this.params.width!==b.width||this.params.height!==b.height||this.params.flex_width||this.params.flex_height?this.frame.setState("cropper"):(this.setImageFromAttachment(b),this.frame.close())},onCropped:function(b){this.setImageFromAttachment(b)},calculateImageSelectOptions:function(D,C){var B,A,z,y=C.get("control"),x=!!parseInt(y.params.flex_width,10),w=!!parseInt(y.params.flex_height,10),v=D.get("width"),u=D.get("height"),t=parseInt(y.params.width,10),s=parseInt(y.params.height,10),r=t/s,q=t,p=s;return C.set("canSkipCrop",!y.mustBeCropped(x,w,t,s,v,u)),v/u>r?(s=u,t=s*r):(t=v,s=t/r),B=(v-t)/2,A=(u-s)/2,z={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:v,imageHeight:u,minWidth:q>t?t:q,minHeight:p>s?s:p,x1:B,y1:A,x2:t+B,y2:s+A},w===!1&&x===!1&&(z.aspectRatio=t+":"+s),!0===w&&(delete z.minHeight,z.maxWidth=v),!0===x&&(delete z.minWidth,z.maxHeight=u),z},mustBeCropped:function(n,m,r,q,p,o){return(!0!==n||!0!==m)&&((!0!==n||q!==o)&&((!0!==m||r!==p)&&((r!==p||q!==o)&&!(p<=r))))},onSkippedCrop:function(){var b=this.frame.state().get("selection").first().toJSON();this.setImageFromAttachment(b)},setImageFromAttachment:function(b){this.params.attachment=b,this.setting(b.id)}}),i.SiteIconControl=i.CroppedImageControl.extend({initFrame:function(){var b=_wpMediaViewsL10n;this.frame=wp.media({button:{text:b.select,close:!1},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new wp.media.controller.SiteIconCropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect:function(){var d=this.frame.state().get("selection").first().toJSON(),c=this;this.params.width!==d.width||this.params.height!==d.height||this.params.flex_width||this.params.flex_height?this.frame.setState("cropper"):wp.ajax.post("crop-image",{nonce:d.nonces.edit,id:d.id,context:"site-icon",cropDetails:{x1:0,y1:0,width:this.params.width,height:this.params.height,dst_width:this.params.width,dst_height:this.params.height}}).done(function(b){c.setImageFromAttachment(b),c.frame.close()}).fail(function(){c.frame.trigger("content:error:crop")})},setImageFromAttachment:function(b){var n,m,f=["site_icon-32","thumbnail","full"];_.each(f,function(a){m||_.isUndefined(b.sizes[a])||(m=b.sizes[a])}),this.params.attachment=b,this.setting(b.id),m&&(n=g('link[rel="icon"][sizes="32x32"]'),n.attr("href",m.url))},removeFile:function(b){i.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),this.params.attachment={},this.setting(""),this.renderContent(),g('link[rel="icon"][sizes="32x32"]').attr("href","/favicon.ico"))}}),i.HeaderControl=i.Control.extend({ready:function(){this.btnRemove=g("#customize-control-header_image .actions .remove"),this.btnNew=g("#customize-control-header_image .actions .new"),_.bindAll(this,"openMedia","removeImage"),this.btnNew.on("click",this.openMedia),this.btnRemove.on("click",this.removeImage),i.HeaderTool.currentHeader=this.getInitialHeaderImage(),new i.HeaderTool.CurrentView({model:i.HeaderTool.currentHeader,el:"#customize-control-header_image .current .container"}),new i.HeaderTool.ChoiceListView({collection:i.HeaderTool.UploadsList=new i.HeaderTool.ChoiceList,el:"#customize-control-header_image .choices .uploaded .list"}),new i.HeaderTool.ChoiceListView({collection:i.HeaderTool.DefaultsList=new i.HeaderTool.DefaultsList,el:"#customize-control-header_image .choices .default .list"}),i.HeaderTool.combinedList=i.HeaderTool.CombinedList=new i.HeaderTool.CombinedList([i.HeaderTool.UploadsList,i.HeaderTool.DefaultsList]),wp.media.controller.Cropper.prototype.defaults.doCropArgs.wp_customize="on",wp.media.controller.Cropper.prototype.defaults.doCropArgs.customize_theme=i.settings.theme.stylesheet},getInitialHeaderImage:function(){if(!i.get().header_image||!i.get().header_image_data||_.contains(["remove-header","random-default-image","random-uploaded-image"],i.get().header_image)){return new i.HeaderTool.ImageModel}var b=_.find(_wpCustomizeHeader.uploads,function(c){return c.attachment_id===i.get().header_image_data.attachment_id});return b||(b={url:i.get().header_image,thumbnail_url:i.get().header_image,attachment_id:i.get().header_image_data.attachment_id}),new i.HeaderTool.ImageModel({header:b,choice:b.url.split("/").pop()})},calculateImageSelectOptions:function(x,w){var v,u,t,s,r,q,p=parseInt(_wpCustomizeHeader.data.width,10),o=parseInt(_wpCustomizeHeader.data.height,10),n=!!parseInt(_wpCustomizeHeader.data["flex-width"],10),f=!!parseInt(_wpCustomizeHeader.data["flex-height"],10);return r=x.get("width"),s=x.get("height"),this.headerImage=new i.HeaderTool.ImageModel,this.headerImage.set({themeWidth:p,themeHeight:o,themeFlexWidth:n,themeFlexHeight:f,imageWidth:r,imageHeight:s}),w.set("canSkipCrop",!this.headerImage.shouldBeCropped()),v=p/o,u=r,t=s,u/t>v?(o=t,p=o*v):(p=u,o=p/v),q={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:r,imageHeight:s,x1:0,y1:0,x2:p,y2:o},f===!1&&n===!1&&(q.aspectRatio=p+":"+o),f===!1&&(q.maxHeight=o),n===!1&&(q.maxWidth=p),q},openMedia:function(d){var c=_wpMediaViewsL10n;d.preventDefault(),this.frame=wp.media({button:{text:c.selectAndCrop,close:!1},states:[new wp.media.controller.Library({title:c.chooseImage,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:_wpCustomizeHeader.data.width,suggestedHeight:_wpCustomizeHeader.data.height}),new wp.media.controller.Cropper({imgSelectOptions:this.calculateImageSelectOptions})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this),this.frame.open()},onSelect:function(){this.frame.setState("cropper")},onCropped:function(m){var f=m.url,p=m.attachment_id,o=m.width,n=m.height;this.setImageFromURL(f,p,o,n)},onSkippedCrop:function(f){var e=f.get("url"),n=f.get("width"),m=f.get("height");this.setImageFromURL(e,f.id,n,m)},setImageFromURL:function(m,f,q,p){var o,n={};n.url=m,n.thumbnail_url=m,n.timestamp=_.now(),f&&(n.attachment_id=f),q&&(n.width=q),p&&(n.height=p),o=new i.HeaderTool.ImageModel({header:n,choice:m.split("/").pop()}),i.HeaderTool.UploadsList.add(o),i.HeaderTool.currentHeader.set(o.toJSON()),o.save(),o.importImage()},removeImage:function(){i.HeaderTool.currentHeader.trigger("hide"),i.HeaderTool.CombinedList.trigger("control:removeImage")}}),i.ThemeControl=i.Control.extend({touchDrag:!1,isRendered:!1,renderContent:function(){var d=this,c=arguments;i.section(d.section(),function(a){a.expanded()?(i.Control.prototype.renderContent.apply(d,c),d.isRendered=!0):a.expanded.bind(function(b){b&&!d.isRendered&&(i.Control.prototype.renderContent.apply(d,c),d.isRendered=!0)})})},ready:function(){var b=this;b.container.on("touchmove",".theme",function(){b.touchDrag=!0}),b.container.on("click keydown touchend",".theme",function(a){if(!i.utils.isKeydownButNotEnterEvent(a)){return b.touchDrag===!0?b.touchDrag=!1:void (g(a.target).is(".theme-actions .button")||i.section(b.section()).loadThemePreview(b.params.theme.id))}}),b.container.on("click keydown",".theme-actions .theme-details",function(a){i.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),i.section(b.section()).showDetails(b.params.theme))}),b.container.on("render-screenshot",function(){var d=g(this).find("img"),e=d.data("src");e&&d.attr("src",e)})},filter:function(e){var d=this,f=d.params.theme.name+" "+d.params.theme.description+" "+d.params.theme.tags+" "+d.params.theme.author;f=f.toLowerCase().replace("-"," "),-1!==f.search(e)?d.activate():d.deactivate()}}),i.defaultConstructor=i.Setting,i.control=new i.Values({defaultConstructor:i.Control}),i.section=new i.Values({defaultConstructor:i.Section}),i.panel=new i.Values({defaultConstructor:i.Panel}),i.PreviewFrame=i.Messenger.extend({sensitivity:null,initialize:function(b,f){var e=g.Deferred();e.promise(this),this.container=b.container,g.extend(b,{channel:i.PreviewFrame.uuid()}),i.Messenger.prototype.initialize.call(this,b,f),this.add("previewUrl",b.previewUrl),this.query=g.extend(b.query||{},{customize_messenger_channel:this.channel()}),this.run(e)},run:function(s){var r,q,p,o=this,n=!1,m=!1,f=null,b="{}"!==o.query.customized;o._ready&&o.unbind("ready",o._ready),o._ready=function(a){m=!0,f=a,o.container.addClass("iframe-ready"),a&&n&&s.resolveWith(o,[a])},o.bind("ready",o._ready),r=document.createElement("a"),r.href=o.previewUrl(),q=_.extend(i.utils.parseQueryString(r.search.substr(1)),{customize_changeset_uuid:o.query.customize_changeset_uuid,customize_theme:o.query.customize_theme,customize_messenger_channel:o.query.customize_messenger_channel}),r.search=g.param(q),o.iframe=g("<iframe />",{title:i.l10n.previewIframeTitle,name:"customize-"+o.channel()}),o.iframe.attr("onmousewheel",""),b?o.iframe.attr("data-src",r.href):o.iframe.attr("src",r.href),o.iframe.appendTo(o.container),o.targetWindow(o.iframe[0].contentWindow),b&&(p=g("<form>",{action:r.href,target:o.iframe.attr("name"),method:"post",hidden:"hidden"}),p.append(g("<input>",{type:"hidden",name:"_method",value:"GET"})),_.each(o.query,function(d,e){p.append(g("<input>",{type:"hidden",name:e,value:d}))}),o.container.append(p),p.submit(),p.remove()),o.bind("iframe-loading-error",function(a){return o.iframe.remove(),0===a?void o.login(s):-1===a?void s.rejectWith(o,["cheatin"]):void s.rejectWith(o,["request failure"])}),o.iframe.one("load",function(){n=!0,m?s.resolveWith(o,[f]):setTimeout(function(){s.rejectWith(o,["ready timeout"])},o.sensitivity)})},login:function(b){var f,e=this;return f=function(){b.rejectWith(e,["logged out"])},this.triedLogin?f():void g.get(i.settings.url.ajax,{action:"logged-in"}).fail(f).done(function(c){var a;"1"!==c&&f(),a=g("<iframe />",{src:e.previewUrl(),title:i.l10n.previewIframeTitle}).hide(),a.appendTo(e.container),a.on("load",function(){e.triedLogin=!0,a.remove(),e.run(b)})})},destroy:function(){i.Messenger.prototype.destroy.call(this),this.iframe&&this.iframe.remove(),delete this.iframe,delete this.targetWindow}}),function(){var b=0;i.PreviewFrame.uuid=function(){return"preview-"+String(b++)}}(),i.setDocumentTitle=function(e){var d,f;d=i.settings.documentTitleTmpl,f=d.replace("%s",e),document.title=f,i.trigger("title",f)},i.Previewer=i.Messenger.extend({refreshBuffer:null,initialize:function(b,n){var m=this,f=document.createElement("a");g.extend(m,n||{}),m.deferred={active:g.Deferred()},m.refresh=_.debounce(function(c){return function(){var a,d;a=function(){return 0===i.state("processing").get()},a()?c.call(m):(d=function(){a()&&(c.call(m),i.state("processing").unbind(d))},i.state("processing").bind(d))}}(m.refresh),m.refreshBuffer),m.container=i.ensure(b.container),m.allowedUrls=b.allowedUrls,b.url=window.location.href,i.Messenger.prototype.initialize.call(m,b),f.href=m.origin(),m.add("scheme",f.protocol.replace(/:$/,"")),m.add("previewUrl",b.previewUrl).setter(function(d){var s,r,q,p=null,o=[];return s=document.createElement("a"),s.href=d,/\/wp-(admin|includes|content)(\/|$)/.test(s.pathname)?null:(s.search.length>1&&(r=i.utils.parseQueryString(s.search.substr(1)),delete r.customize_changeset_uuid,delete r.customize_theme,delete r.customize_messenger_channel,_.isEmpty(r)?s.search="":s.search=g.param(r)),o.push(s),m.scheme.get()+":"!==s.protocol&&(s=document.createElement("a"),s.href=o[0].href,s.protocol=m.scheme.get()+":",o.unshift(s)),q=document.createElement("a"),_.find(o,function(c){return !_.isUndefined(_.find(m.allowedUrls,function(a){if(q.href=a,s.protocol===q.protocol&&s.host===q.host&&0===s.pathname.indexOf(q.pathname.replace(/\/$/,""))){return p=c.href,!0}}))}),p)}),m.bind("ready",m.ready),m.deferred.active.done(_.bind(m.keepPreviewAlive,m)),m.bind("synced",function(){m.send("active")}),m.previewUrl.bind(m.refresh),m.scroll=0,m.bind("scroll",function(c){m.scroll=c}),m.bind("url",function(e){var d,o=!1;m.scroll=0,d=function(){o=!0},m.previewUrl.bind(d),m.previewUrl.set(e),m.previewUrl.unbind(d),o||m.refresh()}),m.bind("documentTitle",function(c){i.setDocumentTitle(c)})},ready:function(f){var e,n=this,m={};m.settings=i.get(),m["settings-modified-while-loading"]=n.settingsModifiedWhileLoading,("resolved"!==n.deferred.active.state()||n.loading)&&(m.scroll=n.scroll),m["edit-shortcut-visibility"]=i.state("editShortcutVisibility").get(),n.send("sync",m),f.currentUrl&&(n.previewUrl.unbind(n.refresh),n.previewUrl.set(f.currentUrl),n.previewUrl.bind(n.refresh)),e={panel:f.activePanels,section:f.activeSections,control:f.activeControls},_(e).each(function(d,c){i[c].each(function(o,b){var a=_.isUndefined(i.settings[c+"s"][b]);a&&_.isUndefined(d[b])||(d[b]?o.activate():o.deactivate())})}),f.settingValidities&&i._handleSettingValidities({settingValidities:f.settingValidities,focusInvalidControl:!1})},keepPreviewAlive:function(){var m,f,p,o,n=this;o=function(){f=setTimeout(p,i.settings.timeouts.keepAliveCheck)},m=function(){i.state("previewerAlive").set(!0),clearTimeout(f),o()},p=function(){i.state("previewerAlive").set(!1)},o(),n.bind("ready",m),n.bind("keep-alive",m)},query:function(){},abort:function(){this.loading&&(this.loading.destroy(),delete this.loading)},refresh:function(){var d,c=this;c.send("loading-initiated"),c.abort(),c.loading=new i.PreviewFrame({url:c.url(),previewUrl:c.previewUrl(),query:c.query({excludeCustomizedSaved:!0})||{},container:c.container}),c.settingsModifiedWhileLoading={},d=function(b){c.settingsModifiedWhileLoading[b.id]=!0},i.bind("change",d),c.loading.always(function(){i.unbind("change",d)}),c.loading.done(function(b){var f,e=this;c.preview=e,c.targetWindow(e.targetWindow()),c.channel(e.channel()),f=function(){e.unbind("synced",f),c._previousPreview&&c._previousPreview.destroy(),c._previousPreview=c.preview,c.deferred.active.resolve(),delete c.loading},e.bind("synced",f),c.trigger("ready",b)}),c.loading.fail(function(b){c.send("loading-failed"),"logged out"===b&&(c.preview&&(c.preview.destroy(),delete c.preview),c.login().done(c.refresh)),"cheatin"===b&&c.cheatin()})},login:function(){var b,n,m,f=this;return this._login?this._login:(b=g.Deferred(),this._login=b.promise(),n=new i.Messenger({channel:"login",url:i.settings.url.login}),m=g("<iframe />",{src:i.settings.url.login,title:i.l10n.loginIframeTitle}).appendTo(this.container),n.targetWindow(m[0].contentWindow),n.bind("login",function(){var a=f.refreshNonces();a.always(function(){m.remove(),n.destroy(),delete f._login}),a.done(function(){b.resolve()}),a.fail(function(){f.cheatin(),b.reject()})}),this._login)},cheatin:function(){g(document.body).empty().addClass("cheatin").append("<h1>"+i.l10n.cheatin+"</h1><p>"+i.l10n.notAllowed+"</p>")},refreshNonces:function(){var b,d=g.Deferred();return d.promise(),b=wp.ajax.post("customize_refresh_nonces",{wp_customize:"on",customize_theme:i.settings.theme.stylesheet}),b.done(function(c){i.trigger("nonce-refresh",c),d.resolve()}),b.fail(function(){d.reject()}),d}}),i.settingConstructor={},i.controlConstructor={color:i.ColorControl,media:i.MediaControl,upload:i.UploadControl,image:i.ImageControl,cropped_image:i.CroppedImageControl,site_icon:i.SiteIconControl,header:i.HeaderControl,background:i.BackgroundControl,background_position:i.BackgroundPositionControl,theme:i.ThemeControl},i.panelConstructor={},i.sectionConstructor={themes:i.ThemesSection},i._handleSettingValidities=function(f){var e,n=[],m=!1;_.each(f.settingValidities,function(o,c){var p=i(c);p&&(_.isObject(o)&&_.each(o,function(q,d){var t,s,r=!1;t=new i.Notification(d,_.extend({fromServer:!0},q)),s=p.notifications(t.code),s&&(r=t.type!==s.type||t.message!==s.message||!_.isEqual(t.data,s.data)),r&&p.notifications.remove(d),p.notifications.has(t.code)||p.notifications.add(d,t),n.push(p.id)}),p.notifications.each(function(a){!a.fromServer||"error"!==a.type||!0!==o&&o[a.code]||p.notifications.remove(a.code)}))}),f.focusInvalidControl&&(e=i.findControlsForSettings(n),_(_.values(e)).find(function(b){return _(b).find(function(d){var c=d.section()&&i.section.has(d.section())&&i.section(d.section()).expanded();return c&&d.expanded&&(c=d.expanded()),c&&(d.focus(),m=!0),m})}),m||_.isEmpty(e)||_.values(e)[0][0].focus())},i.findControlsForSettings=function(e){var d,f={};return _.each(_.unique(e),function(b){var c=i(b);c&&(d=c.findControls(),d&&d.length>0&&(f[b]=d))}),f},i.reflowPaneContents=_.bind(function(){var b,o,n,m=[],f=!1;document.activeElement&&(o=g(document.activeElement)),i.panel.each(function(a){var p=a.sections(),e=_.pluck(p,"headContainer");m.push(a),b=a.contentContainer.is("ul")?a.contentContainer:a.contentContainer.find("ul:first"),i.utils.areElementListsEqual(e,b.children("[id]"))||(_(p).each(function(c){b.append(c.headContainer)}),f=!0)}),i.section.each(function(a){var p=a.controls(),e=_.pluck(p,"container");a.panel()||m.push(a),b=a.contentContainer.is("ul")?a.contentContainer:a.contentContainer.find("ul:first"),i.utils.areElementListsEqual(e,b.children("[id]"))||(_(p).each(function(c){b.append(c.container)}),f=!0)}),m.sort(i.utils.prioritySort),n=_.pluck(m,"headContainer"),b=g("#customize-theme-controls .customize-pane-parent"),i.utils.areElementListsEqual(n,b.children())||(_(m).each(function(a){b.append(a.headContainer)}),f=!0),i.panel.each(function(d){var c=d.active();d.active.callbacks.fireWith(d.active,[c,c])}),i.section.each(function(d){var c=d.active();d.active.callbacks.fireWith(d.active,[c,c])}),f&&o&&o.focus(),i.trigger("pane-contents-reflowed")},i),g(function(){if(i.settings=window._wpCustomizeSettings,i.l10n=window._wpCustomizeControlsL10n,i.settings&&g.support.postMessage&&(g.support.cors||!i.settings.isCrossDomain)){null===i.PreviewFrame.prototype.sensitivity&&(i.PreviewFrame.prototype.sensitivity=i.settings.timeouts.previewFrameSensitivity),null===i.Previewer.prototype.refreshBuffer&&(i.Previewer.prototype.refreshBuffer=i.settings.timeouts.windowRefresh);var b,q=g(document.body),p=q.children(".wp-full-overlay"),o=g("#customize-info .panel-title.site-title"),n=g(".customize-controls-close"),m=g("#save"),f=g("#customize-footer-actions");g("#customize-controls").on("keydown",function(e){var s=13===e.which,r=g(e.target);s&&(r.is("input:not([type=button])")||r.is("select"))&&e.preventDefault()}),g(".customize-info").find("> .accordion-section-title .customize-help-toggle").on("click",function(){var d=g(this).closest(".accordion-section"),e=d.find(".customize-panel-description:first");d.hasClass("cannot-expand")||(d.hasClass("open")?(d.toggleClass("open"),e.slideUp(i.Panel.prototype.defaultExpandedArguments.duration),g(this).attr("aria-expanded",!1)):(e.slideDown(i.Panel.prototype.defaultExpandedArguments.duration),d.toggleClass("open"),g(this).attr("aria-expanded",!0)))}),i.previewer=new i.Previewer({container:"#customize-preview",form:"#customize-controls",previewUrl:i.settings.url.preview,allowedUrls:i.settings.url.allowed},{nonce:i.settings.nonce,query:function(d){var c={wp_customize:"on",customize_theme:i.settings.theme.stylesheet,nonce:this.nonce.preview,customize_changeset_uuid:i.settings.changeset.uuid};return c.customized=JSON.stringify(i.dirtyValues({unsaved:d&&d.excludeCustomizedSaved})),c},save:function(A){function z(c){r[c.id]=!0}var y,x,w,v=this,u=g.Deferred(),t="publish",s=i.state("processing"),r={},a=[];return A&&A.status&&(t=A.status),i.state("saving").get()&&(u.reject("already_saving"),u.promise()),i.state("saving").set(!0),i.bind("change",z),x=function(){var C,d,c={},B=i._latestRevision;return i.each(function(e){e.notifications.each(function(D){"error"!==D.type||D.fromServer||(a.push(e.id),c[e.id]||(c[e.id]={}),c[e.id][D.code]=D)})}),w=i.findControlsForSettings(a),_.isEmpty(w)?(d=g.extend(v.query({excludeCustomizedSaved:!1}),{nonce:v.nonce.save,customize_changeset_status:t}),A&&A.date&&(d.customize_changeset_date=A.date),A&&A.title&&(d.customize_changeset_title=A.title),C=wp.ajax.post("customize_save",d),m.prop("disabled",!0),i.trigger("save",C),C.always(function(){i.state("saving").set(!1),m.prop("disabled",!1),i.unbind("change",z)}),C.fail(function(e){"0"===e?e="not_logged_in":"-1"===e&&(e="invalid_nonce"),"invalid_nonce"===e?v.cheatin():"not_logged_in"===e&&(v.preview.iframe.hide(),v.login().done(function(){v.save(),v.preview.iframe.show()})),e.setting_validities&&i._handleSettingValidities({settingValidities:e.setting_validities,focusInvalidControl:!0}),u.rejectWith(v,[e]),i.trigger("error",e)}),void C.done(function(e){v.send("saved",e),i.state("changesetStatus").set(e.changeset_status),"publish"===e.changeset_status&&(i.each(function(D){D._dirty&&(_.isUndefined(i._latestSettingRevisions[D.id])||i._latestSettingRevisions[D.id]<=B)&&(D._dirty=!1)}),i.state("changesetStatus").set(""),i.settings.changeset.uuid=e.next_changeset_uuid,b.send("changeset-uuid",i.settings.changeset.uuid)),e.setting_validities&&i._handleSettingValidities({settingValidities:e.setting_validities,focusInvalidControl:!0}),u.resolveWith(v,[e]),i.trigger("saved",e),_.isEmpty(r)||i.state("saved").set(!1)})):(_.values(w)[0][0].focus(),i.unbind("change",z),u.rejectWith(v,[{setting_invalidities:c}]),i.state("saving").set(!1),u.promise())},0===s()?x():(y=function(){0===s()&&(i.state.unbind("change",y),x())},i.state.bind("change",y)),u.promise()}}),g.ajaxPrefilter(function(c){/wp_customize=on/.test(c.data)&&(c.data+="&"+g.param({customize_preview_nonce:i.settings.nonce.preview}))}),i.previewer.bind("nonce",function(c){g.extend(this.nonce,c)}),i.bind("nonce-refresh",function(c){g.extend(i.settings.nonce,c),g.extend(i.previewer.nonce,c),i.previewer.send("nonce-refresh",c)}),g.each(i.settings.settings,function(r,e){var t,s=i.settingConstructor[e.type]||i.Setting;t=new s(r,e.value,{transport:e.transport,previewer:i.previewer,dirty:!!e.dirty}),i.add(r,t)}),g.each(i.settings.panels,function(r,e){var t,s=i.panelConstructor[e.type]||i.Panel;t=new s(r,{params:e}),i.panel.add(r,t)}),g.each(i.settings.sections,function(r,e){var t,s=i.sectionConstructor[e.type]||i.Section;t=new s(r,{params:e}),i.section.add(r,t)}),g.each(i.settings.controls,function(r,e){var t,s=i.controlConstructor[e.type]||i.Control;t=new s(r,{params:e,previewer:i.previewer}),i.control.add(r,t)}),_.each(["panel","section","control"],function(d){var c=i.settings.autofocus[d];c&&i[d](c,function(e){e.deferred.embedded.done(function(){i.previewer.deferred.active.done(function(){e.focus()})})})}),i.bind("ready",i.reflowPaneContents),g([i.panel,i.section,i.control]).each(function(e,d){var r=_.debounce(i.reflowPaneContents,i.settings.timeouts.reflowPaneContents);d.bind("add",r),d.bind("change",r),d.bind("remove",r)}),function(){var B,A=new i.Values,z=A.create("saved"),y=A.create("saving"),x=A.create("activated"),w=A.create("processing"),v=A.create("paneVisible"),u=A.create("expandedPanel"),t=A.create("expandedSection"),s=A.create("changesetStatus"),r=A.create("previewerAlive"),c=A.create("editShortcutVisibility");A.bind("change",function(){var d;x()?""===s.get()&&z()?(m.val(i.l10n.saved),n.find(".screen-reader-text").text(i.l10n.close)):(m.val(i.l10n.save),n.find(".screen-reader-text").text(i.l10n.cancel)):(m.val(i.l10n.activate),n.find(".screen-reader-text").text(i.l10n.cancel)),d=!y()&&(!x()||!z()||""!==s()&&"publish"!==s()),m.prop("disabled",!d)}),s(i.settings.changeset.status),z(!0),""===s()&&i.each(function(d){d._dirty&&z(!1)}),y(!1),x(i.settings.theme.active),w(0),v(!0),u(!1),t(!1),r(!0),c("visible"),i.bind("change",function(){A("saved").get()&&(A("saved").set(!1),B(!0))}),y.bind(function(d){q.toggleClass("saving",d)}),i.bind("saved",function(d){A("saved").set(!0),"publish"===d.changeset_status&&A("activated").set(!0)}),x.bind(function(d){d&&i.trigger("activated")}),B=function(e){var D,C;if(history.replaceState){if(D=document.createElement("a"),D.href=location.href,C=i.utils.parseQueryString(D.search.substr(1)),e){if(C.changeset_uuid===i.settings.changeset.uuid){return}C.changeset_uuid=i.settings.changeset.uuid}else{if(!C.changeset_uuid){return}delete C.changeset_uuid}D.search=g.param(C),history.replaceState({},document.title,D.href)}},s.bind(function(a){B(""!==a&&"publish"!==a)}),i.state=A}(),i.previewer.previewUrl()?i.previewer.refresh():i.previewer.previewUrl(i.settings.url.home),m.click(function(c){i.previewer.save(),c.preventDefault()}).keydown(function(c){9!==c.which&&(13===c.which&&i.previewer.save(),c.preventDefault())}),n.keydown(function(c){9!==c.which&&(13===c.which&&this.click(),c.preventDefault())}),g(".collapse-sidebar").on("click",function(){i.state("paneVisible").set(!i.state("paneVisible").get())}),i.state("paneVisible").bind(function(c){p.toggleClass("preview-only",!c),p.toggleClass("expanded",c),p.toggleClass("collapsed",!c),c?g(".collapse-sidebar").attr({"aria-expanded":"true","aria-label":i.l10n.collapseSidebar}):g(".collapse-sidebar").attr({"aria-expanded":"false","aria-label":i.l10n.expandSidebar})}),g("body").on("keydown",function(r){var v,u=[],t=[],s=[];27===r.which&&(g(r.target).is("body")||g.contains(g("#customize-controls")[0],r.target))&&(i.control.each(function(c){c.expanded&&c.expanded()&&_.isFunction(c.collapse)&&u.push(c)}),i.section.each(function(c){c.expanded()&&t.push(c)}),i.panel.each(function(c){c.expanded()&&s.push(c)}),u.length>0&&0===t.length&&(u.length=0),v=u[0]||t[0]||s[0],v&&(v.collapse(),r.preventDefault()))}),g(".customize-controls-preview-toggle").on("click",function(){i.state("paneVisible").set(!i.state("paneVisible").get())}),function(){var r,y,x,w,v,u,t,s=g(".wp-full-overlay-sidebar-content");r=function(d){var c,A=d,z=i.state("expandedSection").get(),e=i.state("expandedPanel").get();if(u&&u.element&&x(u.element),!A){if(!z&&e&&e.contentContainer){A=e}else{if(e||!z||!z.contentContainer){return void (u=!1)}A=z}}c=A.contentContainer.find(".customize-section-title, .panel-meta").first(),c.length?(u={instance:A,element:c,parent:c.closest(".customize-pane-child"),height:y(c)},z&&w(u.element,u.parent)):u=!1},i.state("expandedSection").bind(r),i.state("expandedPanel").bind(r),s.on("scroll",_.throttle(function(){if(u){var d=s.scrollTop(),c=!t||d<=t;t=d,v(u,d,c)}},8)),x=function(c){c.hasClass("is-sticky")&&c.removeClass("is-sticky").addClass("maybe-sticky is-in-view").css("top",s.scrollTop()+"px")},w=function(d,c){d.removeClass("maybe-sticky is-in-view").css({width:"",top:""}),c.css("padding-top","")},y=function(d){var c=d.data("height");return c||(c=d.outerHeight(),d.data("height",c)),c},v=function(I,H,G){var F=I.element,E=I.parent,D=I.height,C=parseInt(F.css("top"),10),B=F.hasClass("maybe-sticky"),A=F.hasClass("is-sticky"),z=F.hasClass("is-in-view");if(!G){return A&&(C=H,F.removeClass("is-sticky").css({top:C+"px",width:""})),void (z&&H>C+D&&(F.removeClass("is-in-view"),E.css("padding-top","")))}if(!B&&H>=D){B=!0,F.addClass("maybe-sticky")}else{if(0===H){return F.removeClass("maybe-sticky is-in-view is-sticky").css({top:"",width:""}),void E.css("padding-top","")}}z&&!A?C>=H&&F.addClass("is-sticky").css({top:"",width:E.outerWidth()+"px"}):B&&!z&&(F.addClass("is-in-view").css("top",H-D+"px"),E.css("padding-top",D+"px"))}}(),i.previewedDevice=new i.Value,i.bind("ready",function(){_.find(i.settings.previewableDevices,function(d,c){if(!0===d["default"]){return i.previewedDevice.set(c),!0}})}),f.find(".devices button").on("click",function(c){i.previewedDevice.set(g(c.currentTarget).data("device"))}),i.previewedDevice.bind(function(e){var s=g(".wp-full-overlay"),r="";f.find(".devices button").removeClass("active").attr("aria-pressed",!1),f.find(".devices .preview-"+e).addClass("active").attr("aria-pressed",!0),g.each(i.settings.previewableDevices,function(c){r+=" preview-"+c}),s.removeClass(r).addClass("preview-"+e)}),o.length&&i("blogname",function(d){var e=function(){o.text(g.trim(d())||i.l10n.untitledBlogName)};d.bind(e),e()}),b=new i.Messenger({url:i.settings.url.parent,channel:"loader"}),b.bind("back",function(){n.on("click.customize-controls-close",function(a){a.preventDefault(),b.send("close")})}),g(window).on("beforeunload.customize-confirm",function(){if(!i.state("saved")()){return setTimeout(function(){p.removeClass("customize-loading")},1),i.l10n.saveAlert}}),g.each(["saved","change"],function(a,d){i.bind(d,function(){b.send(d)})}),i.bind("title",function(a){b.send("title",a)}),b.send("changeset-uuid",i.settings.changeset.uuid),b.send("ready"),g.each({background_image:{controls:["background_preset","background_position","background_size","background_repeat","background_attachment"],callback:function(c){return !!c}},show_on_front:{controls:["page_on_front","page_for_posts"],callback:function(c){return"page"===c}},header_textcolor:{controls:["header_textcolor"],callback:function(c){return"blank"!==c}}},function(d,e){i(d,function(c){g.each(e.controls,function(a,r){i.control(r,function(s){var t=function(u){s.container.toggle(e.callback(u))};t(c.get()),c.bind(t)})})})}),i.control("background_preset",function(s){var r,x,w,v,u,t;r={"default":[!1,!1,!1,!1],fill:[!0,!1,!1,!1],fit:[!0,!1,!0,!1],repeat:[!0,!1,!1,!0],custom:[!0,!0,!0,!0]},x=[_wpCustomizeBackground.defaults["default-position-x"],_wpCustomizeBackground.defaults["default-position-y"],_wpCustomizeBackground.defaults["default-size"],_wpCustomizeBackground.defaults["default-repeat"],_wpCustomizeBackground.defaults["default-attachment"]],w={"default":x,fill:["left","top","cover","no-repeat","fixed"],fit:["left","top","contain","no-repeat","fixed"],repeat:["left","top","auto","repeat","scroll"]},v=function(c){_.each(["background_position","background_size","background_repeat","background_attachment"],function(z,y){var a=i.control(z);a&&a.container.toggle(r[c][y])})},u=function(c){_.each(["background_position_x","background_position_y","background_size","background_repeat","background_attachment"],function(a,y){var d=i(a);d&&d.set(w[c][y])})},t=s.setting.get(),v(t),s.setting.bind("change",function(c){v(c),"custom"!==c&&u(c)})}),i.control("background_repeat",function(c){c.elements[0].unsync(i("background_repeat")),c.element=new i.Element(c.container.find("input")),c.element.set("no-repeat"!==c.setting()),c.element.bind(function(a){c.setting.set(a?"repeat":"no-repeat")}),c.setting.bind(function(a){c.element.set("no-repeat"!==a)})}),i.control("background_attachment",function(c){c.elements[0].unsync(i("background_attachment")),c.element=new i.Element(c.container.find("input")),c.element.set("fixed"!==c.setting()),c.element.bind(function(a){c.setting.set(a?"scroll":"fixed")}),c.setting.bind(function(a){c.element.set("fixed"!==a)})}),i.control("display_header_text",function(d){var c="";d.elements[0].unsync(i("header_textcolor")),d.element=new i.Element(d.container.find("input")),d.element.set("blank"!==d.setting()),d.element.bind(function(a){a||(c=i("header_textcolor").get()),d.setting.set(a?c:"blank")}),d.setting.bind(function(a){d.element.set("blank"!==a)})}),i("show_on_front","page_on_front",function(e,d){var r=function(){"page"===e()&&parseInt(d(),10)>0&&i.previewer.previewUrl.set(i.settings.url.home)};e.bind(r),d.bind(r)}),i("page_for_posts",function(c){c.bind(function(d){d=parseInt(d,10),d>0&&i.previewer.previewUrl.set(i.settings.url.home+"?page_id="+d)})}),i.control("custom_css",function(c){c.deferred.embedded.done(function(){var a=c.container.find("textarea"),d=a[0];a.on("blur",function(){a.data("next-tab-blurs",!1)}),a.on("keydown",function(r){var w,v,u,t=9,s=27;return s===r.keyCode?void (a.data("next-tab-blurs")||(a.data("next-tab-blurs",!0),r.stopPropagation())):void (t!==r.keyCode||r.ctrlKey||r.altKey||r.shiftKey||a.data("next-tab-blurs")||(w=d.selectionStart,v=d.selectionEnd,u=d.value,w>=0&&(d.value=u.substring(0,w).concat("\t",u.substring(v)),a.selectionStart=d.selectionEnd=w+1),r.stopPropagation(),r.preventDefault()))})})}),i.control("header_video",function(c){c.deferred.embedded.done(function(){var a=function(){var d,e=i.section(c.section());e&&(d=e.container.find(".header-video-not-currently-previewable:first"),c.active.get()?d.stop().slideUp("fast"):d.stop().slideDown("fast"))};a(),c.active.bind(a)})}),i.previewer.bind("selective-refresh-setting-validities",function(c){i._handleSettingValidities({settingValidities:c,focusInvalidControl:!1})}),i.previewer.bind("focus-control-for-setting",function(d){var c=[];i.control.each(function(e){var a=_.pluck(e.settings,"id");-1!==_.indexOf(a,d)&&c.push(e)}),c.length&&(c.sort(function(r,e){return r.priority()-e.priority()}),c[0].focus())}),i.previewer.bind("refresh",function(){i.previewer.refresh()}),i.state("paneVisible").bind(function(d){var e;e=window.matchMedia?window.matchMedia("screen and ( max-width: 640px )").matches:g(window).width()<=640,i.state("editShortcutVisibility").set(d||e?"visible":"hidden")}),window.matchMedia&&window.matchMedia("screen and ( max-width: 640px )").addListener(function(){var c=i.state("paneVisible");c.callbacks.fireWith(c,[c.get(),c.get()])}),i.previewer.bind("edit-shortcut-visibility",function(c){i.state("editShortcutVisibility").set(c)}),i.state("editShortcutVisibility").bind(function(c){i.previewer.send("edit-shortcut-visibility",c)}),function(){var r,u,t,s=!1;u=function(){s||(s=!0,i.requestChangesetUpdate().always(function(){s=!1})),t()},t=function(){clearTimeout(r),r=setTimeout(function(){u()},i.settings.timeouts.changesetAutoSave)},t(),g(window).on("blur.wp-customize-changeset-update",function(){u()}),g(window).on("beforeunload.wp-customize-changeset-update",function(){u()})}(),i.trigger("ready")}})}(wp,jQuery);