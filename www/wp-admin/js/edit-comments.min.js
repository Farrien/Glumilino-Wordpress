var setCommentsList,theList,theExtraList,commentReply;(function(f){var b,g,e,d,a,l,i,k=document.title,j=f("#dashboard_right_now").length,c,h;b=function(m){var o=parseInt(m.html().replace(/[^0-9]+/g,""),10);if(isNaN(o)){return 0}return o};g=function(o,p){var m="";if(isNaN(p)){return}p=p<1?"0":p.toString();if(p.length>3){while(p.length>3){m=thousandsSeparator+p.substr(p.length-3)+m;p=p.substr(0,p.length-3)}p=p+m}o.html(p)};a=function(q,s){var m=".post-com-count-"+s,o="comment-count-no-comments",r="comment-count-approved",p,n;e("span.approved-count",q);if(!s){return}p=f("span."+r,m);n=f("span."+o,m);p.each(function(){var t=f(this),u=b(t)+q;if(u<1){u=0}if(0===u){t.removeClass(r).addClass(o)}else{t.addClass(r).removeClass(o)}g(t,u)});n.each(function(){var t=f(this);if(q>0){t.removeClass(o).addClass(r)}else{t.addClass(o).removeClass(r)}g(t,q)})};e=function(m,n){f(m).each(function(){var o=f(this),p=b(o)+n;if(p<1){p=0}g(o,p)})};i=function(m){if(!j||!m||!m.i18n_comments_text){return}var n=f("#dashboard_right_now");f(".comment-count a",n).text(m.i18n_comments_text);f(".comment-mod-count a",n).text(m.i18n_moderation_text).parent()[m.in_moderation>0?"removeClass":"addClass"]("hidden")};l=function(p){var q,n,m,o;h=h||new RegExp(adminCommentsL10n.docTitleCommentsCount.replace("%s","\\([0-9"+thousandsSeparator+"]+\\)")+"?");c=c||f("<div />");q=k;o=h.exec(document.title);if(o){o=o[0];c.html(o);m=b(c)+p}else{c.html(0);m=p}if(m>=1){g(c,m);n=h.exec(document.title);if(n){q=document.title.replace(n[0],adminCommentsL10n.docTitleCommentsCount.replace("%s",c.text())+" ")}}else{n=h.exec(q);if(n){q=q.replace(n[0],adminCommentsL10n.docTitleComments)}}document.title=q};d=function(q,t){var m=".post-com-count-"+t,o="comment-count-no-pending",p="post-com-count-no-pending",n="comment-count-pending",r,s;if(!j){l(q)}f("span.pending-count").each(function(){var u=f(this),v=b(u)+q;if(v<1){v=0}u.closest(".awaiting-mod")[0===v?"addClass":"removeClass"]("count-0");g(u,v)});if(!t){return}r=f("span."+n,m);s=f("span."+o,m);r.each(function(){var u=f(this),v=b(u)+q;if(v<1){v=0}if(0===v){u.parent().addClass(p);u.removeClass(n).addClass(o)}else{u.parent().removeClass(p);u.addClass(n).removeClass(o)}g(u,v)});s.each(function(){var u=f(this);if(q>0){u.parent().removeClass(p);u.removeClass(o).addClass(n)}else{u.parent().addClass(p);u.addClass(o).removeClass(n)}g(u,q)})};setCommentsList=function(){var n,p,r,q,s,o,u,m,t,v=0;n=f('input[name="_total"]',"#comments-form");p=f('input[name="_per_page"]',"#comments-form");r=f('input[name="_page"]',"#comments-form");o=function(w,x,y){if(x<v){return}if(y){v=x}n.val(w.toString())};q=function(A,y){var x,C,z,w,B=f("#"+y.element);if(true!==y.parsed){w=y.parsed.responses[0]}x=f("#replyrow");C=f("#comment_ID",x).val();z=f("#replybtn",x);if(B.is(".unapproved")){if(y.data.id==C){z.text(adminCommentsL10n.replyApprove)}B.find(".row-actions span.view").addClass("hidden").end().find("div.comment_status").html("0")}else{if(y.data.id==C){z.text(adminCommentsL10n.reply)}B.find(".row-actions span.view").removeClass("hidden").end().find("div.comment_status").html("1")}t=f("#"+y.element).is("."+y.dimClass)?1:-1;if(w){i(w.supplemental);d(t,w.supplemental.postId);a(-1*t,w.supplemental.postId)}else{d(t);a(-1*t)}};s=function(z,D){var F,w,x,y,C,G,B,A=false,E=f(z.target).attr("data-wp-lists");z.data._total=n.val()||0;z.data._per_page=p.val()||0;z.data._page=r.val()||0;z.data._url=document.location.href;z.data.comment_status=f('input[name="comment_status"]',"#comments-form").val();if(E.indexOf(":trash=1")!=-1){A="trash"}else{if(E.indexOf(":spam=1")!=-1){A="spam"}}if(A){w=E.replace(/.*?comment-([0-9]+).*/,"$1");x=f("#comment-"+w);F=f("#"+A+"-undo-holder").html();x.find(".check-column :checkbox").prop("checked",false);if(x.siblings("#replyrow").length&&commentReply.cid==w){commentReply.close()}if(x.is("tr")){y=x.children(":visible").length;B=f(".author strong",x).text();C=f('<tr id="undo-'+w+'" class="undo un'+A+'" style="display:none;"><td colspan="'+y+'">'+F+"</td></tr>")}else{B=f(".comment-author",x).text();C=f('<div id="undo-'+w+'" style="display:none;" class="undo un'+A+'">'+F+"</div>")}x.before(C);f("strong","#undo-"+w).text(B);G=f(".undo a","#undo-"+w);G.attr("href","comment.php?action=un"+A+"comment&c="+w+"&_wpnonce="+z.data._ajax_nonce);G.attr("data-wp-lists","delete:the-comment-list:comment-"+w+"::un"+A+"=1");G.attr("class","vim-z vim-destructive");f(".avatar",x).first().clone().prependTo("#undo-"+w+" ."+A+"-undo-inside");G.click(function(H){H.preventDefault();H.stopPropagation();D.wpList.del(this);f("#undo-"+w).css({backgroundColor:"#ceb"}).fadeOut(350,function(){f(this).remove();f("#comment-"+w).css("backgroundColor","").fadeIn(300,function(){f(this).show()})})})}return z};u=function(F,M){var I,Q,L,H,x=true===M.parsed?{}:M.parsed.responses[0],C=true===M.parsed?"":x.supplemental.status,K=true===M.parsed?"":x.supplemental.postId,J=true===M.parsed?"":x.supplemental,z=f(M.target).parent(),N=f("#"+M.element),y,w,A,P,D=N.hasClass("approved"),G=N.hasClass("unapproved"),O=N.hasClass("spam"),B=N.hasClass("trash"),E=false;i(J);if(z.is("span.undo")){if(z.hasClass("unspam")){y=-1;if("trash"===C){w=1}else{if("1"===C){P=1}else{if("0"===C){A=1}}}}else{if(z.hasClass("untrash")){w=-1;if("spam"===C){y=1}else{if("1"===C){P=1}else{if("0"===C){A=1}}}}}E=true}else{if(z.is("span.spam")){if(D){P=-1}else{if(G){A=-1}else{if(B){w=-1}}}y=1}else{if(z.is("span.unspam")){if(D){A=1}else{if(G){P=1}else{if(B){if(z.hasClass("approve")){P=1}else{if(z.hasClass("unapprove")){A=1}}}else{if(O){if(z.hasClass("approve")){P=1}else{if(z.hasClass("unapprove")){A=1}}}}}}y=-1}else{if(z.is("span.trash")){if(D){P=-1}else{if(G){A=-1}else{if(O){y=-1}}}w=1}else{if(z.is("span.untrash")){if(D){A=1}else{if(G){P=1}else{if(B){if(z.hasClass("approve")){P=1}else{if(z.hasClass("unapprove")){A=1}}}}}w=-1}else{if(z.is("span.approve:not(.unspam):not(.untrash)")){P=1;A=-1}else{if(z.is("span.unapprove:not(.unspam):not(.untrash)")){P=-1;A=1}else{if(z.is("span.delete")){if(O){y=-1}else{if(B){w=-1}}}}}}}}}}if(A){d(A,K);e("span.all-count",A)}if(P){a(P,K);e("span.all-count",P)}if(y){e("span.spam-count",y)}if(w){e("span.trash-count",w)}if(!j){Q=n.val()?parseInt(n.val(),10):0;if(f(M.target).parent().is("span.undo")){Q++}else{Q--}if(Q<0){Q=0}if("object"===typeof F){if(x.supplemental.total_items_i18n&&v<x.supplemental.time){I=x.supplemental.total_items_i18n||"";if(I){f(".displaying-num").text(I);f(".total-pages").text(x.supplemental.total_pages_i18n);f(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",x.supplemental.total_pages==f(".current-page").val())}o(Q,x.supplemental.time,true)}else{if(x.supplemental.time){o(Q,x.supplemental.time,false)}}}else{o(Q,F,false)}}if(!theExtraList||theExtraList.length===0||theExtraList.children().length===0||E){return}theList.get(0).wpList.add(theExtraList.children(":eq(0):not(.no-items)").remove().clone());m();L=f(":animated","#the-comment-list");H=function(){if(!f("#the-comment-list tr:visible").length){theList.get(0).wpList.add(theExtraList.find(".no-items").clone())}};if(L.length){L.promise().done(H)}else{H()}};m=function(z){var x=f.query.get(),w=f(".total-pages").text(),y=f('input[name="_per_page"]',"#comments-form").val();if(!x.paged){x.paged=1}if(x.paged>w){return}if(z){theExtraList.empty();x.number=Math.min(8,y)}else{x.number=1;x.offset=Math.min(8,y)-1}x.no_placeholder=true;x.paged++;if(true===x.comment_type){x.comment_type=""}x=f.extend(x,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:f("#_ajax_fetch_list_nonce").val()});f.ajax({url:ajaxurl,global:false,dataType:"json",data:x,success:function(A){theExtraList.get(0).wpList.add(A.rows)}})};theExtraList=f("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"});theList=f("#the-comment-list").wpList({alt:"",delBefore:s,dimAfter:q,delAfter:u,addColor:"none"}).bind("wpListDelEnd",function(y,x){var w=f(x.target).attr("data-wp-lists"),z=x.element.replace(/[^0-9]+/g,"");if(w.indexOf(":trash=1")!=-1||w.indexOf(":spam=1")!=-1){f("#undo-"+z).fadeIn(300,function(){f(this).show()})}})};commentReply={cid:"",act:"",originalContent:"",init:function(){var m=f("#replyrow");f("a.cancel",m).click(function(){return commentReply.revert()});f("a.save",m).click(function(){return commentReply.send()});f("input#author-name, input#author-email, input#author-url",m).keypress(function(n){if(n.which==13){commentReply.send();n.preventDefault();return false}});f("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle(f(this).parent())});f("#doaction, #doaction2, #post-query-submit").click(function(){if(f("#the-comment-list #replyrow").length>0){commentReply.close()}});this.comments_listing=f('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(m){m.each(function(){f(this).find(".column-comment > p").dblclick(function(){commentReply.toggle(f(this).parent())})})},toggle:function(m){if("none"!==f(m).css("display")&&(f("#replyrow").parent().is("#com-reply")||window.confirm(adminCommentsL10n.warnQuickEdit))){f(m).find("a.vim-q").click()}},revert:function(){if(f("#the-comment-list #replyrow").length<1){return false}f("#replyrow").fadeOut("fast",function(){commentReply.close()});return false},close:function(){var n,m=f("#replyrow");if(m.parent().is("#com-reply")){return}if(this.cid&&this.act=="edit-comment"){n=f("#comment-"+this.cid);n.fadeIn(300,function(){n.show()}).css("backgroundColor","")}if(typeof QTags!="undefined"){QTags.closeAllTags("replycontent")}f("#add-new-comment").css("display","");m.hide();f("#com-reply").append(m);f("#replycontent").css("height","").val("");f("#edithead input").val("");f(".error",m).empty().hide();f(".spinner",m).removeClass("is-active");this.cid="";this.originalContent=""},open:function(m,p,r){var n,q,u,x,w,y=this,v=f("#comment-"+m),s=v.height(),o=0;if(!this.discardCommentChanges()){return false}y.close();y.cid=m;n=f("#replyrow");q=f("#inline-"+m);r=r||"replyto";u="edit"==r?"edit":"replyto";u=y.act=u+"-comment";y.originalContent=f("textarea.comment",q).val();o=f("> th:visible, > td:visible",v).length;if(n.hasClass("inline-edit-row")&&0!==o){f("td",n).attr("colspan",o)}f("#action",n).val(u);f("#comment_post_ID",n).val(p);f("#comment_ID",n).val(m);if(r=="edit"){f("#author-name",n).val(f("div.author",q).text());f("#author-email",n).val(f("div.author-email",q).text());f("#author-url",n).val(f("div.author-url",q).text());f("#status",n).val(f("div.comment_status",q).text());f("#replycontent",n).val(f("textarea.comment",q).val());f("#edithead, #editlegend, #savebtn",n).show();f("#replyhead, #replybtn, #addhead, #addbtn",n).hide();if(s>120){w=s>500?500:s;f("#replycontent",n).css("height",w+"px")}v.after(n).fadeOut("fast",function(){f("#replyrow").fadeIn(300,function(){f(this).show()})})}else{if(r=="add"){f("#addhead, #addbtn",n).show();f("#replyhead, #replybtn, #edithead, #editlegend, #savebtn",n).hide();f("#the-comment-list").prepend(n);f("#replyrow").fadeIn(300)}else{x=f("#replybtn",n);f("#edithead, #editlegend, #savebtn, #addhead, #addbtn",n).hide();f("#replyhead, #replybtn",n).show();v.after(n);if(v.hasClass("unapproved")){x.text(adminCommentsL10n.replyApprove)}else{x.text(adminCommentsL10n.reply)}f("#replyrow").fadeIn(300,function(){f(this).show()})}}setTimeout(function(){var B,z,C,t,A;B=f("#replyrow").offset().top;z=B+f("#replyrow").height();C=window.pageYOffset||document.documentElement.scrollTop;t=document.documentElement.clientHeight||window.innerHeight||0;A=C+t;if(A-20<z){window.scroll(0,z-t+35)}else{if(B-20<C){window.scroll(0,B-35)}}f("#replycontent").focus().keyup(function(D){if(D.which==27){commentReply.revert()}})},600);return false},send:function(){var m={};f("#replysubmit .error").hide();f("#replysubmit .spinner").addClass("is-active");f("#replyrow input").not(":button").each(function(){var n=f(this);m[n.attr("name")]=n.val()});m.content=f("#replycontent").val();m.id=m.comment_post_ID;m.comments_listing=this.comments_listing;m.p=f('[name="p"]').val();if(f("#comment-"+f("#comment_ID").val()).hasClass("unapproved")){m.approve_parent=1}f.ajax({type:"POST",url:ajaxurl,data:m,success:function(n){commentReply.show(n)},error:function(n){commentReply.error(n)}});return false},show:function(n){var p=this,q,u,s,o,m;if(typeof(n)=="string"){p.error({responseText:n});return false}q=wpAjax.parseAjaxResponse(n);if(q.errors){p.error({responseText:wpAjax.broken});return false}p.revert();q=q.responses[0];s="#comment-"+q.id;if("edit-comment"==p.act){f(s).remove()}if(q.supplemental.parent_approved){m=f("#comment-"+q.supplemental.parent_approved);d(-1,q.supplemental.parent_post_id);if(this.comments_listing=="moderated"){m.animate({backgroundColor:"#CCEEBB"},400,function(){m.fadeOut()});return}}if(q.supplemental.i18n_comments_text){if(j){i(q.supplemental)}else{a(1,q.supplemental.parent_post_id);e("span.all-count",1)}}u=f.trim(q.data);f(u).hide();f("#replyrow").after(u);s=f(s);p.addEvents(s);o=s.hasClass("unapproved")?"#FFFFE0":s.closest(".widefat, .postbox").css("backgroundColor");s.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:o},300,function(){if(m&&m.length){m.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:o},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")}})},error:function(m){var n=m.statusText;f("#replysubmit .spinner").removeClass("is-active");if(m.responseText){n=m.responseText.replace(/<.[^<>]*?>/g,"")}if(n){f("#replysubmit .error").html(n).show()}},addcomment:function(m){var n=this;f("#add-new-comment").fadeOut(200,function(){n.open(0,m,"add");f("table.comments-box").css("display","");f("#no-comments").remove()})},discardCommentChanges:function(){var m=f("#replyrow");if(this.originalContent===f("#replycontent",m).val()){return true}return window.confirm(adminCommentsL10n.warnCommentChanges)}};f(document).ready(function(){var p,m,n,o;setCommentsList();commentReply.init();f(document).on("click","span.delete a.delete",function(q){q.preventDefault()});if(typeof f.table_hotkeys!="undefined"){p=function(q){return function(){var s,r;s="next"==q?"first":"last";r=f(".tablenav-pages ."+q+"-page:not(.disabled)");if(r.length){window.location=r[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+s+"=1"}}};m=function(r,q){window.location=f("span.edit a",q).attr("href")};n=function(){f("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")};o=function(q){return function(){var r=f('select[name="action"]');f('option[value="'+q+'"]',r).prop("selected",true);f("#doaction").click()}};f.table_hotkeys(f("table.widefat"),["a","u","s","d","r","q","z",["e",m],["shift+x",n],["shift+a",o("approve")],["shift+s",o("spam")],["shift+d",o("delete")],["shift+t",o("trash")],["shift+z",o("untrash")],["shift+u",o("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:p("prev"),next_page_link_cb:p("next"),hotkeys_opts:{disableInInput:true,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0})}f("#the-comment-list").on("click",".comment-inline",function(s){s.preventDefault();var q=f(this),r="replyto";if("undefined"!==typeof q.data("action")){r=q.data("action")}commentReply.open(q.data("commentId"),q.data("postId"),r)})})})(jQuery);