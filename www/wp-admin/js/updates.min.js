(function(c,a,b){var d=c(document);a=a||{};a.updates={};a.updates.ajaxNonce=b.ajax_nonce;a.updates.l10n=b.l10n;a.updates.searchTerm="";a.updates.shouldRequestFilesystemCredentials=false;a.updates.filesystemCredentials={ftp:{host:"",username:"",password:"",connectionType:""},ssh:{publicKey:"",privateKey:""},fsNonce:"",available:false};a.updates.ajaxLocked=false;a.updates.adminNotice=a.template("wp-updates-admin-notice");a.updates.queue=[];a.updates.$elToReturnFocusToFromCredentialsModal=undefined;a.updates.addAdminNotice=function(f){var g=c(f.selector),e;delete f.selector;e=a.updates.adminNotice(f);if(!g.length){g=c("#"+f.id)}if(g.length){g.replaceWith(e)}else{c(".wrap").find("> h1").after(e)}d.trigger("wp-updates-notice-added")};a.updates.ajax=function(g,f){var e={};if(a.updates.ajaxLocked){a.updates.queue.push({action:g,data:f});return c.Deferred()}a.updates.ajaxLocked=true;if(f.success){e.success=f.success;delete f.success}if(f.error){e.error=f.error;delete f.error}e.data=_.extend(f,{action:g,_ajax_nonce:a.updates.ajaxNonce,_fs_nonce:a.updates.filesystemCredentials.fsNonce,username:a.updates.filesystemCredentials.ftp.username,password:a.updates.filesystemCredentials.ftp.password,hostname:a.updates.filesystemCredentials.ftp.hostname,connection_type:a.updates.filesystemCredentials.ftp.connectionType,public_key:a.updates.filesystemCredentials.ssh.publicKey,private_key:a.updates.filesystemCredentials.ssh.privateKey});return a.ajax.send(e).always(a.updates.ajaxAlways)};a.updates.ajaxAlways=function(e){if(!e.errorCode||"unable_to_connect_to_filesystem"!==e.errorCode){a.updates.ajaxLocked=false;a.updates.queueChecker()}if("undefined"!==typeof e.debug&&window.console&&window.console.log){_.map(e.debug,function(f){window.console.log(c("<p />").html(f).text())})}};a.updates.refreshCount=function(){var i=c("#wp-admin-bar-updates"),e=c('a[href="update-core.php"] .update-plugins'),g=c('a[href="plugins.php"] .update-plugins'),h=c('a[href="themes.php"] .update-plugins'),f;i.find(".ab-item").removeAttr("title");i.find(".ab-label").text(b.totals.counts.total);if(0===b.totals.counts.total){i.find(".ab-label").parents("li").remove()}e.each(function(j,k){k.className=k.className.replace(/count-\d+/,"count-"+b.totals.counts.total)});if(b.totals.counts.total>0){e.find(".update-count").text(b.totals.counts.total)}else{e.remove()}g.each(function(j,k){k.className=k.className.replace(/count-\d+/,"count-"+b.totals.counts.plugins)});if(b.totals.counts.total>0){g.find(".plugin-count").text(b.totals.counts.plugins)}else{g.remove()}h.each(function(j,k){k.className=k.className.replace(/count-\d+/,"count-"+b.totals.counts.themes)});if(b.totals.counts.total>0){h.find(".theme-count").text(b.totals.counts.themes)}else{h.remove()}if("plugins"===pagenow||"plugins-network"===pagenow){f=b.totals.counts.plugins}else{if("themes"===pagenow||"themes-network"===pagenow){f=b.totals.counts.themes}}if(f>0){c(".subsubsub .upgrade .count").text("("+f+")")}else{c(".subsubsub .upgrade").remove()}};a.updates.decrementCount=function(e){b.totals.counts.total=Math.max(--b.totals.counts.total,0);if("plugin"===e){b.totals.counts.plugins=Math.max(--b.totals.counts.plugins,0)}else{if("theme"===e){b.totals.counts.themes=Math.max(--b.totals.counts.themes,0)}}a.updates.refreshCount(e)};a.updates.updatePlugin=function(f){var h,i,e,g;f=_.extend({success:a.updates.updatePluginSuccess,error:a.updates.updatePluginError},f);if("plugins"===pagenow||"plugins-network"===pagenow){h=c('tr[data-plugin="'+f.plugin+'"]');e=h.find(".update-message").removeClass("notice-error").addClass("updating-message notice-warning").find("p");g=a.updates.l10n.updatingLabel.replace("%s",h.find(".plugin-title strong").text())}else{if("plugin-install"===pagenow||"plugin-install-network"===pagenow){i=c(".plugin-card-"+f.slug);e=i.find(".update-now").addClass("updating-message");g=a.updates.l10n.updatingLabel.replace("%s",e.data("name"));i.removeClass("plugin-card-update-failed").find(".notice.notice-error").remove()}}if(e.html()!==a.updates.l10n.updating){e.data("originaltext",e.html())}e.attr("aria-label",g).text(a.updates.l10n.updating);d.trigger("wp-plugin-updating",f);return a.updates.ajax("update-plugin",f)};a.updates.updatePluginSuccess=function(f){var g,e,h;if("plugins"===pagenow||"plugins-network"===pagenow){g=c('tr[data-plugin="'+f.plugin+'"]').removeClass("update").addClass("updated");e=g.find(".update-message").removeClass("updating-message notice-warning").addClass("updated-message notice-success").find("p");h=g.find(".plugin-version-author-uri").html().replace(f.oldVersion,f.newVersion);g.find(".plugin-version-author-uri").html(h)}else{if("plugin-install"===pagenow||"plugin-install-network"===pagenow){e=c(".plugin-card-"+f.slug).find(".update-now").removeClass("updating-message").addClass("button-disabled updated-message")}}e.attr("aria-label",a.updates.l10n.updatedLabel.replace("%s",f.pluginName)).text(a.updates.l10n.updated);a.a11y.speak(a.updates.l10n.updatedMsg,"polite");a.updates.decrementCount("plugin");d.trigger("wp-plugin-update-success",f)};a.updates.updatePluginError=function(e){var h,g,f;if(!a.updates.isValidResponse(e,"update")){return}if(a.updates.maybeHandleCredentialError(e,"update-plugin")){return}f=a.updates.l10n.updateFailed.replace("%s",e.errorMessage);if("plugins"===pagenow||"plugins-network"===pagenow){if(e.plugin){g=c('tr[data-plugin="'+e.plugin+'"]').find(".update-message")}else{g=c('tr[data-slug="'+e.slug+'"]').find(".update-message")}g.removeClass("updating-message notice-warning").addClass("notice-error").find("p").html(f);if(e.pluginName){g.find("p").attr("aria-label",a.updates.l10n.updateFailedLabel.replace("%s",e.pluginName))}else{g.find("p").removeAttr("aria-label")}}else{if("plugin-install"===pagenow||"plugin-install-network"===pagenow){h=c(".plugin-card-"+e.slug).addClass("plugin-card-update-failed").append(a.updates.adminNotice({className:"update-message notice-error notice-alt is-dismissible",message:f}));h.find(".update-now").text(a.updates.l10n.updateFailedShort).removeClass("updating-message");if(e.pluginName){h.find(".update-now").attr("aria-label",a.updates.l10n.updateFailedLabel.replace("%s",e.pluginName))}else{h.find(".update-now").removeAttr("aria-label")}h.on("click",".notice.is-dismissible .notice-dismiss",function(){setTimeout(function(){h.removeClass("plugin-card-update-failed").find(".column-name a").focus();h.find(".update-now").attr("aria-label",false).text(a.updates.l10n.updateNow)},200)})}}a.a11y.speak(f,"assertive");d.trigger("wp-plugin-update-error",e)};a.updates.installPlugin=function(f){var g=c(".plugin-card-"+f.slug),e=g.find(".install-now");f=_.extend({success:a.updates.installPluginSuccess,error:a.updates.installPluginError},f);if("import"===pagenow){e=c('[data-slug="'+f.slug+'"]')}if(e.html()!==a.updates.l10n.installing){e.data("originaltext",e.html())}e.addClass("updating-message").attr("aria-label",a.updates.l10n.pluginInstallingLabel.replace("%s",e.data("name"))).text(a.updates.l10n.installing);a.a11y.speak(a.updates.l10n.installingMsg,"polite");g.removeClass("plugin-card-install-failed").find(".notice.notice-error").remove();d.trigger("wp-plugin-installing",f);return a.updates.ajax("install-plugin",f)};a.updates.installPluginSuccess=function(e){var f=c(".plugin-card-"+e.slug).find(".install-now");f.removeClass("updating-message").addClass("updated-message installed button-disabled").attr("aria-label",a.updates.l10n.pluginInstalledLabel.replace("%s",e.pluginName)).text(a.updates.l10n.installed);a.a11y.speak(a.updates.l10n.installedMsg,"polite");d.trigger("wp-plugin-install-success",e);if(e.activateUrl){setTimeout(function(){f.removeClass("install-now installed button-disabled updated-message").addClass("activate-now button-primary").attr("href",e.activateUrl).attr("aria-label",a.updates.l10n.activatePluginLabel.replace("%s",e.pluginName)).text(a.updates.l10n.activatePlugin)},1000)}};a.updates.installPluginError=function(e){var h=c(".plugin-card-"+e.slug),g=h.find(".install-now"),f;if(!a.updates.isValidResponse(e,"install")){return}if(a.updates.maybeHandleCredentialError(e,"install-plugin")){return}f=a.updates.l10n.installFailed.replace("%s",e.errorMessage);h.addClass("plugin-card-update-failed").append('<div class="notice notice-error notice-alt is-dismissible"><p>'+f+"</p></div>");h.on("click",".notice.is-dismissible .notice-dismiss",function(){setTimeout(function(){h.removeClass("plugin-card-update-failed").find(".column-name a").focus()},200)});g.removeClass("updating-message").addClass("button-disabled").attr("aria-label",a.updates.l10n.pluginInstallFailedLabel.replace("%s",g.data("name"))).text(a.updates.l10n.installFailedShort);a.a11y.speak(f,"assertive");d.trigger("wp-plugin-install-error",e)};a.updates.installImporterSuccess=function(e){a.updates.addAdminNotice({id:"install-success",className:"notice-success is-dismissible",message:a.updates.l10n.importerInstalledMsg.replace("%s",e.activateUrl+"&from=import")});c('[data-slug="'+e.slug+'"]').removeClass("install-now updating-message").addClass("activate-now").attr({href:e.activateUrl+"&from=import","aria-label":a.updates.l10n.activateImporterLabel.replace("%s",e.pluginName)}).text(a.updates.l10n.activateImporter);a.a11y.speak(a.updates.l10n.installedMsg,"polite");d.trigger("wp-importer-install-success",e)};a.updates.installImporterError=function(e){var f=a.updates.l10n.installFailed.replace("%s",e.errorMessage),h=c('[data-slug="'+e.slug+'"]'),g=h.data("name");if(!a.updates.isValidResponse(e,"install")){return}if(a.updates.maybeHandleCredentialError(e,"install-plugin")){return}a.updates.addAdminNotice({id:e.errorCode,className:"notice-error is-dismissible",message:f});h.removeClass("updating-message").text(a.updates.l10n.installNow).attr("aria-label",a.updates.l10n.installNowLabel.replace("%s",g));a.a11y.speak(f,"assertive");d.trigger("wp-importer-install-error",e)};a.updates.deletePlugin=function(f){var e=c('[data-plugin="'+f.plugin+'"]').find(".row-actions a.delete");f=_.extend({success:a.updates.deletePluginSuccess,error:a.updates.deletePluginError},f);if(e.html()!==a.updates.l10n.deleting){e.data("originaltext",e.html()).text(a.updates.l10n.deleting)}a.a11y.speak(a.updates.l10n.deleting,"polite");d.trigger("wp-plugin-deleting",f);return a.updates.ajax("delete-plugin",f)};a.updates.deletePluginSuccess=function(e){c('[data-plugin="'+e.plugin+'"]').css({backgroundColor:"#faafaa"}).fadeOut(350,function(){var h=c("#bulk-action-form"),k=c(".subsubsub"),i=c(this),j=h.find("thead th:not(.hidden), thead td").length,g=a.template("item-deleted-row"),f=b.plugins;if(!i.hasClass("plugin-update-tr")){i.after(g({slug:e.slug,plugin:e.plugin,colspan:j,name:e.pluginName}))}i.remove();if(-1!==_.indexOf(f.upgrade,e.plugin)){f.upgrade=_.without(f.upgrade,e.plugin);a.updates.decrementCount("plugin")}if(-1!==_.indexOf(f.inactive,e.plugin)){f.inactive=_.without(f.inactive,e.plugin);if(f.inactive.length){k.find(".inactive .count").text("("+f.inactive.length+")")}else{k.find(".inactive").remove()}}if(-1!==_.indexOf(f.active,e.plugin)){f.active=_.without(f.active,e.plugin);if(f.active.length){k.find(".active .count").text("("+f.active.length+")")}else{k.find(".active").remove()}}if(-1!==_.indexOf(f.recently_activated,e.plugin)){f.recently_activated=_.without(f.recently_activated,e.plugin);if(f.recently_activated.length){k.find(".recently_activated .count").text("("+f.recently_activated.length+")")}else{k.find(".recently_activated").remove()}}f.all=_.without(f.all,e.plugin);if(f.all.length){k.find(".all .count").text("("+f.all.length+")")}else{h.find(".tablenav").css({visibility:"hidden"});k.find(".all").remove();if(!h.find("tr.no-items").length){h.find("#the-list").append('<tr class="no-items"><td class="colspanchange" colspan="'+j+'">'+a.updates.l10n.noPlugins+"</td></tr>")}}});a.a11y.speak(a.updates.l10n.deleted,"polite");d.trigger("wp-plugin-delete-success",e)};a.updates.deletePluginError=function(f){var h,e,i=a.template("item-update-row"),g=a.updates.adminNotice({className:"update-message notice-error notice-alt",message:f.errorMessage});if(f.plugin){h=c('tr.inactive[data-plugin="'+f.plugin+'"]');e=h.siblings('[data-plugin="'+f.plugin+'"]')}else{h=c('tr.inactive[data-slug="'+f.slug+'"]');e=h.siblings('[data-slug="'+f.slug+'"]')}if(!a.updates.isValidResponse(f,"delete")){return}if(a.updates.maybeHandleCredentialError(f,"delete-plugin")){return}if(!e.length){h.addClass("update").after(i({slug:f.slug,plugin:f.plugin||f.slug,colspan:c("#bulk-action-form").find("thead th:not(.hidden), thead td").length,content:g}))}else{e.find(".notice-error").remove();e.find(".plugin-update").append(g)}d.trigger("wp-plugin-delete-error",f)};a.updates.updateTheme=function(e){var f;e=_.extend({success:a.updates.updateThemeSuccess,error:a.updates.updateThemeError},e);if("themes-network"===pagenow){f=c('[data-slug="'+e.slug+'"]').find(".update-message").removeClass("notice-error").addClass("updating-message notice-warning").find("p")}else{f=c("#update-theme").closest(".notice").removeClass("notice-large");f.find("h3").remove();f=f.add(c('[data-slug="'+e.slug+'"]').find(".update-message"));f=f.addClass("updating-message").find("p")}if(f.html()!==a.updates.l10n.updating){f.data("originaltext",f.html())}a.a11y.speak(a.updates.l10n.updatingMsg,"polite");f.text(a.updates.l10n.updating);d.trigger("wp-theme-updating",e);return a.updates.ajax("update-theme",e)};a.updates.updateThemeSuccess=function(e){var i=c("body.modal-open").length,g=c('[data-slug="'+e.slug+'"]'),f={className:"updated-message notice-success notice-alt",message:a.updates.l10n.updated},j,h;if("themes-network"===pagenow){j=g.find(".update-message");h=g.find(".theme-version-author-uri").html().replace(e.oldVersion,e.newVersion);g.find(".theme-version-author-uri").html(h)}else{j=c(".theme-info .notice").add(g.find(".update-message"));if(i){c(".load-customize:visible").focus()}else{g.find(".load-customize").focus()}}a.updates.addAdminNotice(_.extend({selector:j},f));a.a11y.speak(a.updates.l10n.updatedMsg,"polite");a.updates.decrementCount("theme");d.trigger("wp-theme-update-success",e);if(i){c(".theme-info .theme-author").after(a.updates.adminNotice(f))}};a.updates.updateThemeError=function(e){var g=c('[data-slug="'+e.slug+'"]'),f=a.updates.l10n.updateFailed.replace("%s",e.errorMessage),h;if(!a.updates.isValidResponse(e,"update")){return}if(a.updates.maybeHandleCredentialError(e,"update-theme")){return}if("themes-network"===pagenow){h=g.find(".update-message ")}else{h=c(".theme-info .notice").add(g.find(".notice"));c("body.modal-open").length?c(".load-customize:visible").focus():g.find(".load-customize").focus()}a.updates.addAdminNotice({selector:h,className:"update-message notice-error notice-alt is-dismissible",message:f});a.a11y.speak(f,"polite");d.trigger("wp-theme-update-error",e)};a.updates.installTheme=function(f){var e=c('.theme-install[data-slug="'+f.slug+'"]');f=_.extend({success:a.updates.installThemeSuccess,error:a.updates.installThemeError},f);e.addClass("updating-message");e.parents(".theme").addClass("focus");if(e.html()!==a.updates.l10n.installing){e.data("originaltext",e.html())}e.text(a.updates.l10n.installing).attr("aria-label",a.updates.l10n.themeInstallingLabel.replace("%s",e.data("name")));a.a11y.speak(a.updates.l10n.installingMsg,"polite");c('.install-theme-info, [data-slug="'+f.slug+'"]').removeClass("theme-install-failed").find(".notice.notice-error").remove();d.trigger("wp-theme-installing",f);return a.updates.ajax("install-theme",f)};a.updates.installThemeSuccess=function(e){var g=c(".wp-full-overlay-header, [data-slug="+e.slug+"]"),f;d.trigger("wp-theme-install-success",e);f=g.find(".button-primary").removeClass("updating-message").addClass("updated-message disabled").attr("aria-label",a.updates.l10n.themeInstalledLabel.replace("%s",e.themeName)).text(a.updates.l10n.installed);a.a11y.speak(a.updates.l10n.installedMsg,"polite");setTimeout(function(){if(e.activateUrl){f.attr("href",e.activateUrl).removeClass("theme-install updated-message disabled").addClass("activate").attr("aria-label",a.updates.l10n.activateThemeLabel.replace("%s",e.themeName)).text(a.updates.l10n.activateTheme)}if(e.customizeUrl){f.siblings(".preview").replaceWith(function(){return c("<a>").attr("href",e.customizeUrl).addClass("button load-customize").text(a.updates.l10n.livePreview)})}},1000)};a.updates.installThemeError=function(e){var i,h,g=a.updates.l10n.installFailed.replace("%s",e.errorMessage),f=a.updates.adminNotice({className:"update-message notice-error notice-alt",message:g});if(!a.updates.isValidResponse(e,"install")){return}if(a.updates.maybeHandleCredentialError(e,"install-theme")){return}if(d.find("body").hasClass("full-overlay-active")){h=c('.theme-install[data-slug="'+e.slug+'"]');i=c(".install-theme-info").prepend(f)}else{i=c('[data-slug="'+e.slug+'"]').removeClass("focus").addClass("theme-install-failed").append(f);h=i.find(".theme-install")}h.removeClass("updating-message").attr("aria-label",a.updates.l10n.themeInstallFailedLabel.replace("%s",h.data("name"))).text(a.updates.l10n.installFailedShort);a.a11y.speak(g,"assertive");d.trigger("wp-theme-install-error",e)};a.updates.deleteTheme=function(e){var f;if("themes"===pagenow){f=c(".theme-actions .delete-theme")}else{if("themes-network"===pagenow){f=c('[data-slug="'+e.slug+'"]').find(".row-actions a.delete")}}e=_.extend({success:a.updates.deleteThemeSuccess,error:a.updates.deleteThemeError},e);if(f&&f.html()!==a.updates.l10n.deleting){f.data("originaltext",f.html()).text(a.updates.l10n.deleting)}a.a11y.speak(a.updates.l10n.deleting,"polite");c(".theme-info .update-message").remove();d.trigger("wp-theme-deleting",e);return a.updates.ajax("delete-theme",e)};a.updates.deleteThemeSuccess=function(e){var f=c('[data-slug="'+e.slug+'"]');if("themes-network"===pagenow){f.css({backgroundColor:"#faafaa"}).fadeOut(350,function(){var i=c(".subsubsub"),j=c(this),h=b.themes,g=a.template("item-deleted-row");if(!j.hasClass("plugin-update-tr")){j.after(g({slug:e.slug,colspan:c("#bulk-action-form").find("thead th:not(.hidden), thead td").length,name:j.find(".theme-title strong").text()}))}j.remove();if(j.hasClass("update")){h.upgrade--;a.updates.decrementCount("theme")}if(j.hasClass("inactive")){h.disabled--;if(h.disabled){i.find(".disabled .count").text("("+h.disabled+")")}else{i.find(".disabled").remove()}}i.find(".all .count").text("("+ --h.all+")")})}a.a11y.speak(a.updates.l10n.deleted,"polite");d.trigger("wp-theme-delete-success",e)};a.updates.deleteThemeError=function(f){var k=c('tr.inactive[data-slug="'+f.slug+'"]'),i=c(".theme-actions .delete-theme"),e=a.template("item-update-row"),j=k.siblings("#"+f.slug+"-update"),h=a.updates.l10n.deleteFailed.replace("%s",f.errorMessage),g=a.updates.adminNotice({className:"update-message notice-error notice-alt",message:h});if(a.updates.maybeHandleCredentialError(f,"delete-theme")){return}if("themes-network"===pagenow){if(!j.length){k.addClass("update").after(e({slug:f.slug,colspan:c("#bulk-action-form").find("thead th:not(.hidden), thead td").length,content:g}))}else{j.find(".notice-error").remove();j.find(".plugin-update").append(g)}}else{c(".theme-info .theme-description").before(g)}i.html(i.data("originaltext"));a.a11y.speak(h,"assertive");d.trigger("wp-theme-delete-error",f)};a.updates._addCallbacks=function(f,e){if("import"===pagenow&&"install-plugin"===e){f.success=a.updates.installImporterSuccess;f.error=a.updates.installImporterError}return f};a.updates.queueChecker=function(){var e;if(a.updates.ajaxLocked||!a.updates.queue.length){return}e=a.updates.queue.shift();switch(e.action){case"install-plugin":a.updates.installPlugin(e.data);break;case"update-plugin":a.updates.updatePlugin(e.data);break;case"delete-plugin":a.updates.deletePlugin(e.data);break;case"install-theme":a.updates.installTheme(e.data);break;case"update-theme":a.updates.updateTheme(e.data);break;case"delete-theme":a.updates.deleteTheme(e.data);break;default:break}};a.updates.requestFilesystemCredentials=function(e){if(false===a.updates.filesystemCredentials.available){if(e&&!a.updates.$elToReturnFocusToFromCredentialsModal){a.updates.$elToReturnFocusToFromCredentialsModal=c(e.target)}a.updates.ajaxLocked=true;a.updates.requestForCredentialsModalOpen()}};a.updates.maybeRequestFilesystemCredentials=function(e){if(a.updates.shouldRequestFilesystemCredentials&&!a.updates.ajaxLocked){a.updates.requestFilesystemCredentials(e)}};a.updates.keydown=function(e){if(27===e.keyCode){a.updates.requestForCredentialsModalCancel()}else{if(9===e.keyCode){if("upgrade"===e.target.id&&!e.shiftKey){c("#hostname").focus();e.preventDefault()}else{if("hostname"===e.target.id&&e.shiftKey){c("#upgrade").focus();e.preventDefault()}}}}};a.updates.requestForCredentialsModalOpen=function(){var e=c("#request-filesystem-credentials-dialog");c("body").addClass("modal-open");e.show();e.find("input:enabled:first").focus();e.on("keydown",a.updates.keydown)};a.updates.requestForCredentialsModalClose=function(){c("#request-filesystem-credentials-dialog").hide();c("body").removeClass("modal-open");if(a.updates.$elToReturnFocusToFromCredentialsModal){a.updates.$elToReturnFocusToFromCredentialsModal.focus()}};a.updates.requestForCredentialsModalCancel=function(){if(!a.updates.ajaxLocked&&!a.updates.queue.length){return}_.each(a.updates.queue,function(e){d.trigger("credential-modal-cancel",e)});a.updates.ajaxLocked=false;a.updates.queue=[];a.updates.requestForCredentialsModalClose()};a.updates.showErrorInCredentialsForm=function(e){var f=c("#request-filesystem-credentials-form");f.find(".notice").remove();f.find("#request-filesystem-credentials-title").after('<div class="notice notice-alt notice-error"><p>'+e+"</p></div>")};a.updates.credentialError=function(e,f){e=a.updates._addCallbacks(e,f);a.updates.queue.unshift({action:f,data:e});a.updates.filesystemCredentials.available=false;a.updates.showErrorInCredentialsForm(e.errorMessage);a.updates.requestFilesystemCredentials()};a.updates.maybeHandleCredentialError=function(e,f){if(a.updates.shouldRequestFilesystemCredentials&&e.errorCode&&"unable_to_connect_to_filesystem"===e.errorCode){a.updates.credentialError(e,f);return true}return false};a.updates.isValidResponse=function(e,h){var g=a.updates.l10n.unknownError,f;if(_.isObject(e)&&!_.isFunction(e.always)){return true}if(_.isString(e)&&"-1"===e){g=a.updates.l10n.nonceError}else{if(_.isString(e)){g=e}else{if("undefined"!==typeof e.readyState&&0===e.readyState){g=a.updates.l10n.connectionError}else{if(_.isString(e.responseText)&&""!==e.responseText){g=e.responseText}else{if(_.isString(e.statusText)){g=e.statusText}}}}}switch(h){case"update":f=a.updates.l10n.updateFailed;break;case"install":f=a.updates.l10n.installFailed;break;case"delete":f=a.updates.l10n.deleteFailed;break}g=g.replace(/<[\/a-z][^<>]*>/gi,"");f=f.replace("%s",g);a.updates.addAdminNotice({id:"unknown_error",className:"notice-error is-dismissible",message:_.escape(f)});a.updates.ajaxLocked=false;a.updates.queue=[];c(".button.updating-message").removeClass("updating-message").removeAttr("aria-label").prop("disabled",true).text(a.updates.l10n.updateFailedShort);c(".updating-message:not(.button):not(.thickbox)").removeClass("updating-message notice-warning").addClass("notice-error").find("p").removeAttr("aria-label").text(f);a.a11y.speak(f,"assertive");return false};a.updates.beforeunload=function(){if(a.updates.ajaxLocked){return a.updates.l10n.beforeunload}};c(function(){var j=c("#plugin-filter"),f=c("#bulk-action-form"),i=c("#request-filesystem-credentials-form"),e=c("#request-filesystem-credentials-dialog"),h=c(".plugins-php .wp-filter-search"),g=c(".plugin-install-php .wp-filter-search");b=_.extend(b,window._wpUpdatesItemCounts||{});if(b.totals){a.updates.refreshCount()}a.updates.shouldRequestFilesystemCredentials=e.length>0;e.on("submit","form",function(k){k.preventDefault();a.updates.filesystemCredentials.ftp.hostname=c("#hostname").val();a.updates.filesystemCredentials.ftp.username=c("#username").val();a.updates.filesystemCredentials.ftp.password=c("#password").val();a.updates.filesystemCredentials.ftp.connectionType=c('input[name="connection_type"]:checked').val();a.updates.filesystemCredentials.ssh.publicKey=c("#public_key").val();a.updates.filesystemCredentials.ssh.privateKey=c("#private_key").val();a.updates.filesystemCredentials.fsNonce=c("#_fs_nonce").val();a.updates.filesystemCredentials.available=true;a.updates.ajaxLocked=false;a.updates.queueChecker();a.updates.requestForCredentialsModalClose()});e.on("click",'[data-js-action="close"], .notification-dialog-background',a.updates.requestForCredentialsModalCancel);i.on("change",'input[name="connection_type"]',function(){c("#ssh-keys").toggleClass("hidden",("ssh"!==c(this).val()))}).change();d.on("credential-modal-cancel",function(m,n){var l=c(".updating-message"),k,o;if("import"===pagenow){l.removeClass("updating-message")}else{if("plugins"===pagenow||"plugins-network"===pagenow){if("update-plugin"===n.action){k=c('tr[data-plugin="'+n.data.plugin+'"]').find(".update-message")}else{if("delete-plugin"===n.action){k=c('[data-plugin="'+n.data.plugin+'"]').find(".row-actions a.delete")}}}else{if("themes"===pagenow||"themes-network"===pagenow){if("update-theme"===n.action){k=c('[data-slug="'+n.data.slug+'"]').find(".update-message")}else{if("delete-theme"===n.action&&"themes-network"===pagenow){k=c('[data-slug="'+n.data.slug+'"]').find(".row-actions a.delete")}else{if("delete-theme"===n.action&&"themes"===pagenow){k=c(".theme-actions .delete-theme")}}}}else{k=l}}}if(k&&k.hasClass("updating-message")){o=k.data("originaltext");if("undefined"===typeof o){o=c("<p>").html(k.find("p").data("originaltext"))}k.removeClass("updating-message").html(o);if("plugin-install"===pagenow||"plugin-install-network"===pagenow){if("update-plugin"===n.action){k.attr("aria-label",a.updates.l10n.updateNowLabel.replace("%s",k.data("name")))}else{if("install-plugin"===n.action){k.attr("aria-label",a.updates.l10n.installNowLabel.replace("%s",k.data("name")))}}}}a.a11y.speak(a.updates.l10n.updateCancel,"polite")});f.on("click","[data-plugin] .update-link",function(m){var k=c(m.target),l=k.parents("tr");m.preventDefault();if(k.hasClass("updating-message")||k.hasClass("button-disabled")){return}a.updates.maybeRequestFilesystemCredentials(m);a.updates.$elToReturnFocusToFromCredentialsModal=l.find(".check-column input");a.updates.updatePlugin({plugin:l.data("plugin"),slug:l.data("slug")})});j.on("click",".update-now",function(k){var l=c(k.target);k.preventDefault();if(l.hasClass("updating-message")||l.hasClass("button-disabled")){return}a.updates.maybeRequestFilesystemCredentials(k);a.updates.updatePlugin({plugin:l.data("plugin"),slug:l.data("slug")})});j.on("click",".install-now",function(k){var l=c(k.target);k.preventDefault();if(l.hasClass("updating-message")||l.hasClass("button-disabled")){return}if(a.updates.shouldRequestFilesystemCredentials&&!a.updates.ajaxLocked){a.updates.requestFilesystemCredentials(k);d.on("credential-modal-cancel",function(){var m=c(".install-now.updating-message");m.removeClass("updating-message").text(a.updates.l10n.installNow);a.a11y.speak(a.updates.l10n.updateCancel,"polite")})}a.updates.installPlugin({slug:l.data("slug")})});d.on("click",".importer-item .install-now",function(k){var m=c(k.target),l=c(this).data("name");k.preventDefault();if(m.hasClass("updating-message")){return}if(a.updates.shouldRequestFilesystemCredentials&&!a.updates.ajaxLocked){a.updates.requestFilesystemCredentials(k);d.on("credential-modal-cancel",function(){m.removeClass("updating-message").text(a.updates.l10n.installNow).attr("aria-label",a.updates.l10n.installNowLabel.replace("%s",l));a.a11y.speak(a.updates.l10n.updateCancel,"polite")})}a.updates.installPlugin({slug:m.data("slug"),pagenow:pagenow,success:a.updates.installImporterSuccess,error:a.updates.installImporterError})});f.on("click","[data-plugin] a.delete",function(l){var k=c(l.target).parents("tr");l.preventDefault();if(!window.confirm(a.updates.l10n.aysDeleteUninstall.replace("%s",k.find(".plugin-title strong").text()))){return}a.updates.maybeRequestFilesystemCredentials(l);a.updates.deletePlugin({plugin:k.data("plugin"),slug:k.data("slug")})});d.on("click",".themes-php.network-admin .update-link",function(l){var k=c(l.target),m=k.parents("tr");l.preventDefault();if(k.hasClass("updating-message")||k.hasClass("button-disabled")){return}a.updates.maybeRequestFilesystemCredentials(l);a.updates.$elToReturnFocusToFromCredentialsModal=m.find(".check-column input");a.updates.updateTheme({slug:m.data("slug")})});d.on("click",".themes-php.network-admin a.delete",function(k){var l=c(k.target).parents("tr");k.preventDefault();if(!window.confirm(a.updates.l10n.aysDelete.replace("%s",l.find(".theme-title strong").text()))){return}a.updates.maybeRequestFilesystemCredentials(k);a.updates.deleteTheme({slug:l.data("slug")})});f.on("click",'[type="submit"]',function(n){var l=c(n.target).siblings("select").val(),p=f.find('input[name="checked[]"]:checked'),r=0,k=0,q=[],m,o;switch(pagenow){case"plugins":case"plugins-network":m="plugin";break;case"themes-network":m="theme";break;default:return}if(!p.length){n.preventDefault();c("html, body").animate({scrollTop:0});return a.updates.addAdminNotice({id:"no-items-selected",className:"notice-error is-dismissible",message:a.updates.l10n.noItemsSelected})}switch(l){case"update-selected":o=l.replace("selected",m);break;case"delete-selected":if(!window.confirm("plugin"===m?a.updates.l10n.aysBulkDelete:a.updates.l10n.aysBulkDeleteThemes)){n.preventDefault();return}o=l.replace("selected",m);break;default:return}a.updates.maybeRequestFilesystemCredentials(n);n.preventDefault();f.find('.manage-column [type="checkbox"]').prop("checked",false);d.trigger("wp-"+m+"-bulk-"+l,p);p.each(function(t,u){var v=c(u),s=v.parents("tr");if("update-selected"===l&&(!s.hasClass("update")||s.find("notice-error").length)){v.prop("checked",false);return}a.updates.queue.push({action:o,data:{plugin:s.data("plugin"),slug:s.data("slug")}})});d.on("wp-plugin-update-success wp-plugin-update-error wp-theme-update-success wp-theme-update-error",function(v,t){var u=c('[data-slug="'+t.slug+'"]'),s,w;if("wp-"+t.update+"-update-success"===v.type){r++}else{w=t.pluginName?t.pluginName:u.find(".column-primary strong").text();k++;q.push(w+": "+t.errorMessage)}u.find('input[name="checked[]"]:checked').prop("checked",false);a.updates.adminNotice=a.template("wp-bulk-updates-admin-notice");a.updates.addAdminNotice({id:"bulk-action-notice",className:"bulk-action-notice",successes:r,errors:k,errorMessages:q,type:t.update});s=c("#bulk-action-notice").on("click","button",function(){c(this).toggleClass("bulk-action-errors-collapsed").attr("aria-expanded",!c(this).hasClass("bulk-action-errors-collapsed"));s.find(".bulk-action-errors").toggleClass("hidden")});if(k>0&&!a.updates.queue.length){c("html, body").animate({scrollTop:0})}});d.on("wp-updates-notice-added",function(){a.updates.adminNotice=a.template("wp-updates-admin-notice")});a.updates.queueChecker()});if(g.length){g.attr("aria-describedby","live-search-desc")}g.on("keyup input",_.debounce(function(l,n){var k=c(".plugin-install-search"),m,o;m={_ajax_nonce:a.updates.ajaxNonce,s:l.target.value,tab:"search",type:c("#typeselector").val(),pagenow:pagenow};o=location.href.split("?")[0]+"?"+c.param(_.omit(m,["_ajax_nonce","pagenow"]));if("keyup"===l.type&&27===l.which){l.target.value=""}if(a.updates.searchTerm===m.s&&"typechange"!==n){return}else{j.empty();a.updates.searchTerm=m.s}if(window.history&&window.history.replaceState){window.history.replaceState(null,"",o)}if(!k.length){k=c('<li class="plugin-install-search" />').append(c("<a />",{"class":"current",href:o,text:a.updates.l10n.searchResultsLabel}));c(".wp-filter .filter-links .current").removeClass("current").parents(".filter-links").prepend(k);j.prev("p").remove();c(".plugins-popular-tags-wrapper").remove()}if("undefined"!==typeof a.updates.searchRequest){a.updates.searchRequest.abort()}c("body").addClass("loading-content");a.updates.searchRequest=a.ajax.post("search-install-plugins",m).done(function(p){c("body").removeClass("loading-content");j.append(p.items);delete a.updates.searchRequest;if(0===p.count){a.a11y.speak(a.updates.l10n.noPluginsFound)}else{a.a11y.speak(a.updates.l10n.pluginsFound.replace("%d",p.count))}})},500));if(h.length){h.attr("aria-describedby","live-search-desc")}h.on("keyup input",_.debounce(function(k){var l={_ajax_nonce:a.updates.ajaxNonce,s:k.target.value,pagenow:pagenow,plugin_status:"all"},m;if("keyup"===k.type&&27===k.which){k.target.value=""}if(a.updates.searchTerm===l.s){return}else{a.updates.searchTerm=l.s}m=_.object(_.compact(_.map(location.search.slice(1).split("&"),function(n){if(n){return n.split("=")}})));l.plugin_status=m.plugin_status||"all";if(window.history&&window.history.replaceState){window.history.replaceState(null,"",location.href.split("?")[0]+"?s="+l.s+"&plugin_status="+l.plugin_status)}if("undefined"!==typeof a.updates.searchRequest){a.updates.searchRequest.abort()}f.empty();c("body").addClass("loading-content");c(".subsubsub .current").removeClass("current");a.updates.searchRequest=a.ajax.post("search-plugins",l).done(function(n){var o=c("<span />").addClass("subtitle").html(a.updates.l10n.searchResults.replace("%s",_.escape(l.s))),p=c(".wrap .subtitle");if(!l.s.length){p.remove();c(".subsubsub ."+l.plugin_status+" a").addClass("current")}else{if(p.length){p.replaceWith(o)}else{c(".wrap h1").append(o)}}c("body").removeClass("loading-content");f.append(n.items);delete a.updates.searchRequest;if(0===n.count){a.a11y.speak(a.updates.l10n.noPluginsFound)}else{a.a11y.speak(a.updates.l10n.pluginsFound.replace("%d",n.count))}})},500));d.on("submit",".search-plugins",function(k){k.preventDefault();c("input.wp-filter-search").trigger("input")});c("#typeselector").on("change",function(){var k=c('input[name="s"]');if(k.val().length){k.trigger("input","typechange")}});c("#plugin_update_from_iframe").on("click",function(k){var l=window.parent===window?null:window.parent,m;c.support.postMessage=!!window.postMessage;if(false===c.support.postMessage||null===l||-1!==window.parent.location.pathname.indexOf("update-core.php")){return}k.preventDefault();m={action:"update-plugin",data:{plugin:c(this).data("plugin"),slug:c(this).data("slug")}};l.postMessage(JSON.stringify(m),window.location.origin)});c("#plugin_install_from_iframe").on("click",function(k){var m=window.parent===window?null:window.parent,l;c.support.postMessage=!!window.postMessage;if(false===c.support.postMessage||null===m||-1!==window.parent.location.pathname.indexOf("index.php")){return}k.preventDefault();l={action:"install-plugin",data:{slug:c(this).data("slug")}};m.postMessage(JSON.stringify(l),window.location.origin)});c(window).on("message",function(m){var k=m.originalEvent,o=document.location.protocol+"//"+document.location.hostname,l;if(k.origin!==o){return}try{l=c.parseJSON(k.data)}catch(n){return}if("undefined"===typeof l.action){return}switch(l.action){case"decrementUpdateCount":a.updates.decrementCount(l.upgradeType);break;case"install-plugin":case"update-plugin":window.tb_remove();l.data=a.updates._addCallbacks(l.data,l.action);a.updates.queue.push(l);a.updates.queueChecker();break}});c(window).on("beforeunload",a.updates.beforeunload)})})(jQuery,window.wp,window._wpUpdatesSettings);