(function(c,b){var a=function(){var e,ad,E,U=c(b),A=c(document),z=false,j=document.createElement("textarea"),d=false,W=b.wpPressThisConfig||{},Y=b.wpPressThisData||{},Z=128,P=false,w=[],u="is-off-screen",o="is-hidden",L=u+" "+o,l=/iPad|iPod|iPhone/.test(b.navigator.userAgent),f=c("#pressthis"),p=f[0],y=600,K=0,X=(function(){var af=document.documentElement.style;if(typeof af.transition!=="undefined"){return"transitionend"}if(typeof af.WebkitTransition!=="undefined"){return"webkitTransitionEnd"}return false}());function ae(af){if(af&&b.pressThisL10n){return b.pressThisL10n[af]||af}return af||""}function t(af){af=af||"";return af.replace(/<!--[\s\S]*?(-->|$)/g,"").replace(/<(script|style)[^>]*>[\s\S]*?(<\/\1>|$)/ig,"").replace(/<\/?[a-z][\s\S]*?(>|$)/ig,"")}function ac(ag){var af=t(ag);try{j.innerHTML=af;af=t(j.value)}catch(ah){}return af}function S(af){af=c.trim(af||"");if(/^(?:https?:)?\/\//.test(af)){af=t(af);return af.replace(/["\\]+/g,"")}return""}function ab(){c(".spinner").addClass("is-active");c(".post-actions button").attr("disabled","disabled")}function q(){c(".spinner").removeClass("is-active");c(".post-actions button").removeAttr("disabled")}function aa(ag){var ah,af;if(e&&!e.isHidden()){return}ag=(ag==="reset")||(K&&K>p.value.length);af=p.style.height;if(ag){ah=b.pageYOffset;p.style.height="auto";p.style.height=Math.max(p.scrollHeight,y)+"px";b.scrollTo(b.pageXOffset,ah)}else{if(parseInt(p.style.height,10)<p.scrollHeight){p.style.height=p.scrollHeight+"px"}}K=p.value.length}function s(){if(!e){return false}var ah=e.selection.getNode(),ag,af,ai;if(e.wp&&e.wp.getView&&(af=e.wp.getView(ah))){ai=af.getBoundingClientRect()}else{ag=e.selection.getRng();try{ai=ag.getClientRects()[0]}catch(aj){}if(!ai){ai=ah.getBoundingClientRect()}}return ai.height?ai:false}function B(ag){var ah=b.tinymce.util.VK,af=ag.keyCode;if(af<=47&&!(af===ah.SPACEBAR||af===ah.ENTER||af===ah.DELETE||af===ah.BACKSPACE||af===ah.UP||af===ah.LEFT||af===ah.DOWN||af===ah.UP)){return}else{if((af>=91&&af<=93)||(af>=112&&af<=123)||af===144||af===145){return}}R(af)}function R(ai){var al,ah,ag,am=s(),aj=50,af=65,ak=b.tinymce.util.VK;if(!am){return}al=am.top+e.iframeElement.getBoundingClientRect().top;ah=al+am.height;al=al-aj;ah=ah+af;ag=U.height();if(ag<am.height){return}if(al<0&&(ai===ak.UP||ai===ak.LEFT||ai===ak.BACKSPACE)){b.scrollTo(b.pageXOffset,al+b.pageYOffset)}else{if(ah>ag){b.scrollTo(b.pageXOffset,ah+b.pageYOffset-ag)}}}function D(){var af=c("#title-container");af.find("img.emoji").each(function(){var ag=c(this);ag.replaceWith(c("<span>").text(ag.attr("alt")))});return ac(af.text())}function x(){var af=c("#pressthis-form"),ag=c('<input type="hidden" name="post_category[]" value="">');e&&e.save();c("#post_title").val(D());if(b.tagBox){c("div.tagsdiv").each(function(){b.tagBox.flushTags(this,false,1)})}c(".categories-select .category").each(function(aj,ai){var ah=c(ai);if(ah.hasClass("selected")){af.append(ag.clone().val(ah.attr("data-term-id")||""))}})}function v(ag){var af;z=false;ab();if("publish"===ag){c("#post_status").val("publish")}x();af=c("#pressthis-form").serialize();c.ajax({type:"post",url:b.ajaxurl,data:af}).always(function(){q();V();c(".publish-button").removeClass("is-saving")}).done(function(ah){if(!ah.success){T(ah.data.errorMessage)}else{if(ah.data.redirect){if(b.opener&&(W.redirInParent||ah.data.force)){try{b.opener.location.href=ah.data.redirect;b.setTimeout(function(){b.self.close()},200)}catch(ai){b.location.href=ah.data.redirect}}else{b.location.href=ah.data.redirect}}}}).fail(function(){T(ae("serverError"))})}function k(ag){var ai,ah,af="";ai=S(ag.attr("data-wp-src")||"");ah=S(Y.u);if(ag.hasClass("is-image")){if(!ah){ah=ai}af='<a href="'+ah+'"><img class="alignnone size-full" src="'+ai+'" alt="" /></a>'}else{af="[embed]"+ai+"[/embed]"}if(e&&!e.isHidden()){if(!P){e.setContent("<p>"+af+"</p>"+e.getContent())}else{e.execCommand("mceInsertContent",false,af)}}else{if(b.QTags){b.QTags.insertContent(af)}}}function H(){var ag,af=c("#new-category").val();if(!af){return}ag={action:"press-this-add-category",post_id:c("#post_ID").val()||0,name:af,new_cat_nonce:c("#_ajax_nonce-add-category").val()||"",parent:c("#new-category-parent").val()||0};c.post(b.ajaxurl,ag,function(ai){if(!ai.success){T(ai.data.errorMessage)}else{var ak,aj,ah=c("ul.categories-select");c.each(ai.data,function(am,an){var al=c("<li>").append(c('<div class="category selected" tabindex="0" role="checkbox" aria-checked="true">').attr("data-term-id",an.term_id).text(an.name));if(an.parent){if(!aj||!aj.length){ak=ah.find('div[data-term-id="'+an.parent+'"]').parent();aj=ak.find("ul.children:first");if(!aj.length){aj=c('<ul class="children">').appendTo(ak)}}aj.prepend(al)}else{ah.prepend(al)}al.focus()});M()}})}function n(){if(Y.hasData){c("#scanbar").hide()}}function i(ai,ag){var af=c(".editor-wrapper div.alerts"),ah=ag?"is-error":"is-notice";af.append(c('<p class="alert '+ah+'">').text(ai))}function T(af){i(af,true)}function V(){c("div.alerts").empty()}function m(){if(Y.errors){c.each(Y.errors,function(af,ag){T(ag)})}}function I(ai,ah,ag){var af=E.clone().addClass("is-image");af.attr("data-wp-src",ai).css("background-image","url("+ah+")").find("span").text(ae("suggestedImgAlt").replace("%d",ag+1));ad.append(af)}function h(){var af=0;ad=c("ul.media-list");E=c('<li class="suggested-media-thumbnail" tabindex="0"><span class="screen-reader-text"></span></li>');if(Y._embeds){c.each(Y._embeds,function(ai,ak){var aj="",ah="",ag=E.clone().addClass("is-embed");ak=S(ak);if(ak.indexOf("youtube.com/")>-1){aj="https://i.ytimg.com/vi/"+ak.replace(/.+v=([^&]+).*/,"$1")+"/hqdefault.jpg";ah+=" is-video"}else{if(ak.indexOf("youtu.be/")>-1){aj="https://i.ytimg.com/vi/"+ak.replace(/\/([^\/])$/,"$1")+"/hqdefault.jpg";ah+=" is-video"}else{if(ak.indexOf("dailymotion.com")>-1){aj=ak.replace("/video/","/thumbnail/video/");ah+=" is-video"}else{if(ak.indexOf("soundcloud.com")>-1){ah+=" is-audio"}else{if(ak.indexOf("twitter.com")>-1){ah+=" is-tweet"}else{ah+=" is-video"}}}}}ag.attr("data-wp-src",ak).find("span").text(ae("suggestedEmbedAlt").replace("%d",ai+1));if(aj){ag.css("background-image","url("+aj+")")}ad.append(ag);af++})}if(Y._images){c.each(Y._images,function(ah,aj){var ai,ag=new Image();aj=S(aj);ai=aj.replace(/^(http[^\?]+)(\?.*)?$/,"$1");if(aj.indexOf("files.wordpress.com/")>-1){ai=ai.replace(/\?.*$/,"")+"?w="+Z}else{if(aj.indexOf("gravatar.com/")>-1){ai=ai.replace(/\?.*$/,"")+"?s="+Z}else{ai=aj}}ag.onload=function(){if((ag.width&&ag.width<256)||(ag.height&&ag.height<128)){return}I(aj,ai,ah)};ag.src=aj;af++})}if(af){c(".media-list-container").addClass("has-media")}}function N(){var ah=c(".post-options"),ag=c(".post-option"),ai=c(".setting-modal"),af=c(".modal-close");ag.on("click",function(){var ak=c(this).index(),aj=ai.eq(ak);ah.addClass(u).one(X,function(){c(this).addClass(o)});aj.removeClass(L).one(X,function(){c(this).find(".modal-close").focus()})});af.on("click",function(){var aj=c(this).parent(),ak=aj.index();ah.removeClass(L);aj.addClass(u);if(X){aj.one(X,function(){c(this).addClass(o);ag.eq(ak-1).focus()})}else{setTimeout(function(){aj.addClass(o);ag.eq(ak-1).focus()},350)}})}function J(){d=true;c(".options").removeClass("closed").addClass("open");c(".press-this-actions, #scanbar").addClass(o);c(".options-panel-back").removeClass(o);c(".options-panel").removeClass(L).one(X,function(){c(".post-option:first").focus()})}function Q(){d=false;c(".options").removeClass("open").addClass("closed");c(".options-panel-back").addClass(o);c(".press-this-actions, #scanbar").removeClass(o);c(".options-panel").addClass(u).one(X,function(){c(this).addClass(o);c(".post-options").removeClass(L);c(".setting-modal").addClass(L)})}function F(){var af=c("#title-container"),ag=c(".post-title-placeholder");af.on("focus",function(){ag.addClass("is-hidden")}).on("blur",function(){if(!af.text()&&!af.html()){ag.removeClass("is-hidden")}}).on("keyup",function(){z=true}).on("paste",function(ai){var ak,ah,aj=ai.originalEvent.clipboardData||b.clipboardData;if(aj){try{ak=aj.getData("Text")||aj.getData("text/plain");if(ak){ak=c.trim(ak.replace(/\s+/g," "));if(b.getSelection){ah=b.getSelection().getRangeAt(0);if(ah){if(!ah.collapsed){ah.deleteContents()}ah.insertNode(document.createTextNode(ak))}}else{if(document.selection){ah=document.selection.createRange();if(ah){ah.text=ak}}}}}catch(al){}ai.preventDefault()}z=true;setTimeout(function(){af.text(D())},50)});if(af.text()||af.html()){ag.addClass("is-hidden")}}function r(af){if(af.hasClass("selected")){af.removeClass("selected").attr("aria-checked","false")}else{af.addClass("selected").attr("aria-checked","true")}}function C(){c(".categories-select").on("click.press-this keydown.press-this",function(ag){var af=c(ag.target);if(af.is("div.category")){if(ag.type==="keydown"&&ag.keyCode!==32){return}r(af);ag.preventDefault()}})}function g(){c(".split-button").removeClass("is-open");c(".split-button-toggle").attr("aria-expanded","false")}function G(){n();h();m();if(b.tagBox){b.tagBox.init()}if(l){c(document.body).css("cursor","pointer")}}function O(){var af=c(".split-button");A.on("tinymce-editor-init",function(ah,ag){e=ag;e.on("nodechange",function(){P=true});e.on("focus",function(){g()});e.on("show",function(){setTimeout(function(){e.execCommand("wpAutoResize")},300)});e.on("hide",function(){setTimeout(function(){aa("reset")},100)});e.on("keyup",B);e.on("undo redo",R)}).on("click.press-this keypress.press-this",".suggested-media-thumbnail",function(ag){if(ag.type==="click"||ag.keyCode===13){k(c(this))}}).on("click.press-this",function(ag){if(!c(ag.target).closest("button").hasClass("split-button-toggle")){g()}});c(".post-actions").on("click.press-this",function(ai){var ah,ag=c(ai.target),aj=ag.closest("button");if(aj.length){if(aj.hasClass("draft-button")){c(".publish-button").addClass("is-saving");v("draft")}else{if(aj.hasClass("publish-button")){aj.addClass("is-saving");if(b.history.replaceState){ah=b.location.href;ah+=(ah.indexOf("?")!==-1)?"&":"?";ah+="wp-press-this-reload=true";b.history.replaceState(null,null,ah)}v("publish")}else{if(aj.hasClass("preview-button")){x();b.opener&&b.opener.focus();c("#wp-preview").val("dopreview");c("#pressthis-form").attr("target","_blank").submit().attr("target","");c("#wp-preview").val("")}else{if(aj.hasClass("standard-editor-button")){c(".publish-button").addClass("is-saving");c("#pt-force-redirect").val("true");v("draft")}else{if(aj.hasClass("split-button-toggle")){if(af.hasClass("is-open")){af.removeClass("is-open");aj.attr("aria-expanded","false")}else{af.addClass("is-open");aj.attr("aria-expanded","true")}}}}}}}});N();F();C();c(".options").on("click.press-this",function(){if(c(this).hasClass("open")){Q()}else{J()}});c(".options-panel, .options-panel-back").on("focusout.press-this",function(){setTimeout(function(){var ah=document.activeElement,ag=c(ah);if(d&&ah&&!ag.hasClass("options-panel-back")&&(ah.nodeName==="BODY"||(!ag.closest(".options-panel").length&&!ag.closest(".options").length))){Q()}},50)});c("#post-formats-select input").on("change",function(){var ag=c(this);if(ag.is(":checked")){c("#post-option-post-format").text(c('label[for="'+ag.attr("id")+'"]').text()||"")}});U.on("beforeunload.press-this",function(){if(z||(e&&e.isDirty())){return ae("saveAlert")}}).on("resize.press-this",function(){if(!e||e.isHidden()){aa("reset")}});c("button.add-cat-toggle").on("click.press-this",function(){var ag=c(this);ag.toggleClass("is-toggled");ag.attr("aria-expanded","false"===ag.attr("aria-expanded")?"true":"false");c(".setting-modal .add-category, .categories-search-wrapper").toggleClass("is-hidden")});c("button.add-cat-submit").on("click.press-this",H);c(".categories-search").on("keyup.press-this",function(){var ag=c(this).val().toLowerCase()||"";if(/[\x20-\xFF]+/.test(ag)&&ag.length<2){return}c.each(w,function(ai,ah){ah.node.removeClass("is-hidden searched-parent")});if(ag){c.each(w,function(ai,ah){if(ah.text.indexOf(ag)===-1){ah.node.addClass("is-hidden")}else{ah.parents.addClass("searched-parent")}})}});f.on("focus.press-this input.press-this propertychange.press-this",aa);return true}function M(){c(".categories-select").find("li").each(function(){var af=c(this);w.push({node:af,parents:af.parents("li"),text:af.children(".category").text().toLowerCase()})})}A.ready(function(){G();O();M()});return{renderNotice:i,renderError:T}};b.wp=b.wp||{};b.wp.pressThis=new a()}(jQuery,window));