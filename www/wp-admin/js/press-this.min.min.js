(function(f,d){var e=function(){var a3,aC,ay,ah=f(d),aG=f(document),aI=false,aY=document.createElement("textarea"),a4=false,af=d.wpPressThisConfig||{},b=d.wpPressThisData||{},a=128,am=false,aL=[],aN="is-off-screen",aT="is-hidden",aq=aN+" "+aT,aW=/iPad|iPod|iPhone/.test(d.navigator.userAgent),a2=f("#pressthis"),aS=a2[0],aJ=600,ar=0,c=(function(){var g=document.documentElement.style;if(typeof g.transition!=="undefined"){return"transitionend"}if(typeof g.WebkitTransition!=="undefined"){return"webkitTransitionEnd"}return false}());function az(g){if(g&&d.pressThisL10n){return d.pressThisL10n[g]||g}return g||""}function aO(g){g=g||"";return g.replace(/<!--[\s\S]*?(-->|$)/g,"").replace(/<(script|style)[^>]*>[\s\S]*?(<\/\1>|$)/ig,"").replace(/<\/?[a-z][\s\S]*?(>|$)/ig,"")}function aD(h){var i=aO(h);try{aY.innerHTML=i;i=aO(aY.value)}catch(g){}return i}function aj(g){g=f.trim(g||"");if(/^(?:https?:)?\/\//.test(g)){g=aO(g);return g.replace(/["\\]+/g,"")}return""}function aF(){f(".spinner").addClass("is-active");f(".post-actions button").attr("disabled","disabled")}function aR(){f(".spinner").removeClass("is-active");f(".post-actions button").removeAttr("disabled")}function aH(h){var g,i;if(a3&&!a3.isHidden()){return}h=(h==="reset")||(ar&&ar>aS.value.length);i=aS.style.height;if(h){g=d.pageYOffset;aS.style.height="auto";aS.style.height=Math.max(aS.scrollHeight,aJ)+"px";d.scrollTo(d.pageXOffset,g)}else{if(parseInt(aS.style.height,10)<aS.scrollHeight){aS.style.height=aS.scrollHeight+"px"}}ar=aS.value.length}function aP(){if(!a3){return false}var h=a3.selection.getNode(),i,j,g;if(a3.wp&&a3.wp.getView&&(j=a3.wp.getView(h))){g=j.getBoundingClientRect()}else{i=a3.selection.getRng();try{g=i.getClientRects()[0]}catch(k){}if(!g){g=h.getBoundingClientRect()}}return g.height?g:false}function aE(h){var g=d.tinymce.util.VK,i=h.keyCode;if(i<=47&&!(i===g.SPACEBAR||i===g.ENTER||i===g.DELETE||i===g.BACKSPACE||i===g.UP||i===g.LEFT||i===g.DOWN||i===g.UP)){return}else{if((i>=91&&i<=93)||(i>=112&&i<=123)||i===144||i===145){return}}ak(i)}function ak(g){var l,h,i,k=aP(),n=50,j=65,m=d.tinymce.util.VK;if(!k){return}l=k.top+a3.iframeElement.getBoundingClientRect().top;h=l+k.height;l=l-n;h=h+j;i=ah.height();if(i<k.height){return}if(l<0&&(g===m.UP||g===m.LEFT||g===m.BACKSPACE)){d.scrollTo(d.pageXOffset,l+d.pageYOffset)}else{if(h>i){d.scrollTo(d.pageXOffset,h+d.pageYOffset-i)}}}function aA(){var g=f("#title-container");g.find("img.emoji").each(function(){var h=f(this);h.replaceWith(f("<span>").text(h.attr("alt")))});return aD(g.text())}function aK(){var h=f("#pressthis-form"),g=f('<input type="hidden" name="post_category[]" value="">');a3&&a3.save();f("#post_title").val(aA());if(d.tagBox){f("div.tagsdiv").each(function(){d.tagBox.flushTags(this,false,1)})}f(".categories-select .category").each(function(k,i){var j=f(i);if(j.hasClass("selected")){h.append(g.clone().val(j.attr("data-term-id")||""))}})}function aM(g){var h;aI=false;aF();if("publish"===g){f("#post_status").val("publish")}aK();h=f("#pressthis-form").serialize();f.ajax({type:"post",url:d.ajaxurl,data:h}).always(function(){aR();ag();f(".publish-button").removeClass("is-saving")}).done(function(j){if(!j.success){ai(j.data.errorMessage)}else{if(j.data.redirect){if(d.opener&&(af.redirInParent||j.data.force)){try{d.opener.location.href=j.data.redirect;d.setTimeout(function(){d.self.close()},200)}catch(i){d.location.href=j.data.redirect}}else{d.location.href=j.data.redirect}}}}).fail(function(){ai(az("serverError"))})}function aX(i){var g,h,j="";g=aj(i.attr("data-wp-src")||"");h=aj(b.u);if(i.hasClass("is-image")){if(!h){h=g}j='<a href="'+h+'"><img class="alignnone size-full" src="'+g+'" alt="" /></a>'}else{j="[embed]"+g+"[/embed]"}if(a3&&!a3.isHidden()){if(!am){a3.setContent("<p>"+j+"</p>"+a3.getContent())}else{a3.execCommand("mceInsertContent",false,j)}}else{if(d.QTags){d.QTags.insertContent(j)}}}function av(){var g,h=f("#new-category").val();if(!h){return}g={action:"press-this-add-category",post_id:f("#post_ID").val()||0,name:h,new_cat_nonce:f("#_ajax_nonce-add-category").val()||"",parent:f("#new-category-parent").val()||0};f.post(d.ajaxurl,g,function(i){if(!i.success){ai(i.data.errorMessage)}else{var k,l,j=f("ul.categories-select");f.each(i.data,function(n,m){var o=f("<li>").append(f('<div class="category selected" tabindex="0" role="checkbox" aria-checked="true">').attr("data-term-id",m.term_id).text(m.name));if(m.parent){if(!l||!l.length){k=j.find('div[data-term-id="'+m.parent+'"]').parent();l=k.find("ul.children:first");if(!l.length){l=f('<ul class="children">').appendTo(k)}}l.prepend(o)}else{j.prepend(o)}o.focus()});ap()}})}function aU(){if(b.hasData){f("#scanbar").hide()}}function aZ(g,i){var j=f(".editor-wrapper div.alerts"),h=i?"is-error":"is-notice";j.append(f('<p class="alert '+h+'">').text(g))}function ai(g){aZ(g,true)}function ag(){f("div.alerts").empty()}function aV(){if(b.errors){f.each(b.errors,function(h,g){ai(g)})}}function au(g,h,i){var j=ay.clone().addClass("is-image");j.attr("data-wp-src",g).css("background-image","url("+h+")").find("span").text(az("suggestedImgAlt").replace("%d",i+1));aC.append(j)}function a0(){var g=0;aC=f("ul.media-list");ay=f('<li class="suggested-media-thumbnail" tabindex="0"><span class="screen-reader-text"></span></li>');if(b._embeds){f.each(b._embeds,function(h,k){var l="",i="",j=ay.clone().addClass("is-embed");k=aj(k);if(k.indexOf("youtube.com/")>-1){l="https://i.ytimg.com/vi/"+k.replace(/.+v=([^&]+).*/,"$1")+"/hqdefault.jpg";i+=" is-video"}else{if(k.indexOf("youtu.be/")>-1){l="https://i.ytimg.com/vi/"+k.replace(/\/([^\/])$/,"$1")+"/hqdefault.jpg";i+=" is-video"}else{if(k.indexOf("dailymotion.com")>-1){l=k.replace("/video/","/thumbnail/video/");i+=" is-video"}else{if(k.indexOf("soundcloud.com")>-1){i+=" is-audio"}else{if(k.indexOf("twitter.com")>-1){i+=" is-tweet"}else{i+=" is-video"}}}}}j.attr("data-wp-src",k).find("span").text(az("suggestedEmbedAlt").replace("%d",h+1));if(l){j.css("background-image","url("+l+")")}aC.append(j);g++})}if(b._images){f.each(b._images,function(i,k){var h,j=new Image();k=aj(k);h=k.replace(/^(http[^\?]+)(\?.*)?$/,"$1");if(k.indexOf("files.wordpress.com/")>-1){h=h.replace(/\?.*$/,"")+"?w="+a}else{if(k.indexOf("gravatar.com/")>-1){h=h.replace(/\?.*$/,"")+"?s="+a}else{h=k}}j.onload=function(){if((j.width&&j.width<256)||(j.height&&j.height<128)){return}au(k,h,i)};j.src=k;g++})}if(g){f(".media-list-container").addClass("has-media")}}function ao(){var h=f(".post-options"),i=f(".post-option"),g=f(".setting-modal"),j=f(".modal-close");i.on("click",function(){var k=f(this).index(),l=g.eq(k);h.addClass(aN).one(c,function(){f(this).addClass(aT)});l.removeClass(aq).one(c,function(){f(this).find(".modal-close").focus()})});j.on("click",function(){var l=f(this).parent(),k=l.index();h.removeClass(aq);l.addClass(aN);if(c){l.one(c,function(){f(this).addClass(aT);i.eq(k-1).focus()})}else{setTimeout(function(){l.addClass(aT);i.eq(k-1).focus()},350)}})}function at(){a4=true;f(".options").removeClass("closed").addClass("open");f(".press-this-actions, #scanbar").addClass(aT);f(".options-panel-back").removeClass(aT);f(".options-panel").removeClass(aq).one(c,function(){f(".post-option:first").focus()})}function al(){a4=false;f(".options").removeClass("open").addClass("closed");f(".options-panel-back").addClass(aT);f(".press-this-actions, #scanbar").removeClass(aT);f(".options-panel").addClass(aN).one(c,function(){f(this).addClass(aT);f(".post-options").removeClass(aq);f(".setting-modal").addClass(aq)})}function ax(){var h=f("#title-container"),g=f(".post-title-placeholder");h.on("focus",function(){g.addClass("is-hidden")}).on("blur",function(){if(!h.text()&&!h.html()){g.removeClass("is-hidden")}}).on("keyup",function(){aI=true}).on("paste",function(i){var l,j,m=i.originalEvent.clipboardData||d.clipboardData;if(m){try{l=m.getData("Text")||m.getData("text/plain");if(l){l=f.trim(l.replace(/\s+/g," "));if(d.getSelection){j=d.getSelection().getRangeAt(0);if(j){if(!j.collapsed){j.deleteContents()}j.insertNode(document.createTextNode(l))}}else{if(document.selection){j=document.selection.createRange();if(j){j.text=l}}}}}catch(k){}i.preventDefault()}aI=true;setTimeout(function(){h.text(aA())},50)});if(h.text()||h.html()){g.addClass("is-hidden")}}function aQ(g){if(g.hasClass("selected")){g.removeClass("selected").attr("aria-checked","false")}else{g.addClass("selected").attr("aria-checked","true")}}function aB(){f(".categories-select").on("click.press-this keydown.press-this",function(g){var h=f(g.target);if(h.is("div.category")){if(g.type==="keydown"&&g.keyCode!==32){return}aQ(h);g.preventDefault()}})}function a1(){f(".split-button").removeClass("is-open");f(".split-button-toggle").attr("aria-expanded","false")}function aw(){aU();a0();aV();if(d.tagBox){d.tagBox.init()}if(aW){f(document.body).css("cursor","pointer")}}function an(){var g=f(".split-button");aG.on("tinymce-editor-init",function(h,i){a3=i;a3.on("nodechange",function(){am=true});a3.on("focus",function(){a1()});a3.on("show",function(){setTimeout(function(){a3.execCommand("wpAutoResize")},300)});a3.on("hide",function(){setTimeout(function(){aH("reset")},100)});a3.on("keyup",aE);a3.on("undo redo",ak)}).on("click.press-this keypress.press-this",".suggested-media-thumbnail",function(h){if(h.type==="click"||h.keyCode===13){aX(f(this))}}).on("click.press-this",function(h){if(!f(h.target).closest("button").hasClass("split-button-toggle")){a1()}});f(".post-actions").on("click.press-this",function(h){var i,j=f(h.target),k=j.closest("button");if(k.length){if(k.hasClass("draft-button")){f(".publish-button").addClass("is-saving");aM("draft")}else{if(k.hasClass("publish-button")){k.addClass("is-saving");if(d.history.replaceState){i=d.location.href;i+=(i.indexOf("?")!==-1)?"&":"?";i+="wp-press-this-reload=true";d.history.replaceState(null,null,i)}aM("publish")}else{if(k.hasClass("preview-button")){aK();d.opener&&d.opener.focus();f("#wp-preview").val("dopreview");f("#pressthis-form").attr("target","_blank").submit().attr("target","");f("#wp-preview").val("")}else{if(k.hasClass("standard-editor-button")){f(".publish-button").addClass("is-saving");f("#pt-force-redirect").val("true");aM("draft")}else{if(k.hasClass("split-button-toggle")){if(g.hasClass("is-open")){g.removeClass("is-open");k.attr("aria-expanded","false")}else{g.addClass("is-open");k.attr("aria-expanded","true")}}}}}}}});ao();ax();aB();f(".options").on("click.press-this",function(){if(f(this).hasClass("open")){al()}else{at()}});f(".options-panel, .options-panel-back").on("focusout.press-this",function(){setTimeout(function(){var h=document.activeElement,i=f(h);if(a4&&h&&!i.hasClass("options-panel-back")&&(h.nodeName==="BODY"||(!i.closest(".options-panel").length&&!i.closest(".options").length))){al()}},50)});f("#post-formats-select input").on("change",function(){var h=f(this);if(h.is(":checked")){f("#post-option-post-format").text(f('label[for="'+h.attr("id")+'"]').text()||"")}});ah.on("beforeunload.press-this",function(){if(aI||(a3&&a3.isDirty())){return az("saveAlert")}}).on("resize.press-this",function(){if(!a3||a3.isHidden()){aH("reset")}});f("button.add-cat-toggle").on("click.press-this",function(){var h=f(this);h.toggleClass("is-toggled");h.attr("aria-expanded","false"===h.attr("aria-expanded")?"true":"false");f(".setting-modal .add-category, .categories-search-wrapper").toggleClass("is-hidden")});f("button.add-cat-submit").on("click.press-this",av);f(".categories-search").on("keyup.press-this",function(){var h=f(this).val().toLowerCase()||"";if(/[\x20-\xFF]+/.test(h)&&h.length<2){return}f.each(aL,function(i,j){j.node.removeClass("is-hidden searched-parent")});if(h){f.each(aL,function(i,j){if(j.text.indexOf(h)===-1){j.node.addClass("is-hidden")}else{j.parents.addClass("searched-parent")}})}});a2.on("focus.press-this input.press-this propertychange.press-this",aH);return true}function ap(){f(".categories-select").find("li").each(function(){var g=f(this);aL.push({node:g,parents:g.parents("li"),text:g.children(".category").text().toLowerCase()})})}aG.ready(function(){aw();an();ap()});return{renderNotice:aZ,renderError:ai}};d.wp=d.wp||{};d.wp.pressThis=new e()}(jQuery,window));