(function(f){var d=false,i,l,r,n,h,q,b,t,c,p,u,k,v;if("oninput" in document.createElement("input")){v="input"}else{v="keyup"}function s(){if(typeof zxcvbn!=="function"){setTimeout(s,50);return}else{if(!r.val()){r.val(r.data("pw"));r.trigger("pwupdate");j()}else{m();j()}}if(1!==parseInt(c.data("start-masked"),10)){l.addClass("show-password")}else{c.trigger("click")}f("#pw-weak-text-label").html(userProfileL10n.warnWeak)}function o(){k=r.val();l=r.parent();n=f('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(r[0].className).data("pw",r.data("pw")).val(r.val()).on(v,function(){if(n.val()===k){return}q.val(n.val());r.val(n.val()).trigger("pwupdate");k=n.val()});r.after(n);if(1===parseInt(r.data("reveal"),10)){s()}r.on(v+" pwupdate",function(){if(r.val()===k){return}k=r.val();if(n.val()!==k){n.val(k)}r.add(n).removeClass("short bad good strong");j()})}function a(){c.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden");n.focus();h.attr("for","pass1-text")}function g(){c=i.find(".wp-hide-pw");c.show().on("click",function(){if(1===parseInt(c.data("toggle"),10)){l.addClass("show-password");a();if(!_.isUndefined(n[0].setSelectionRange)){n[0].setSelectionRange(0,100)}}else{l.removeClass("show-password");c.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility");r.focus();h.attr("for","pass1");if(!_.isUndefined(r[0].setSelectionRange)){r[0].setSelectionRange(0,100)}}})}function e(){var y,x,w;i=f(".user-pass1-wrap");h=i.find("th label").attr("for","pass1-text");f(".user-pass2-wrap").hide();u=f("#submit").on("click",function(){d=false});p=u.add(" #createusersub");b=f(".pw-weak");t=b.find(".pw-checkbox");t.change(function(){p.prop("disabled",!t.prop("checked"))});r=f("#pass1");if(r.length){o()}q=f("#pass2").on(v,function(){if(q.val().length>0){r.val(q.val());q.val("");k="";r.trigger("pwupdate")}});if(r.is(":hidden")){r.prop("disabled",true);q.prop("disabled",true);n.prop("disabled",true)}y=i.find(".wp-pwd");x=i.find("button.wp-generate-pw");g();if(x.length){y.hide()}x.show();x.on("click",function(){d=true;x.hide();y.show();r.attr("disabled",false);q.attr("disabled",false);n.attr("disabled",false);if(n.val().length===0){s()}_.defer(function(){n.focus();if(!_.isUndefined(n[0].setSelectionRange)){n[0].setSelectionRange(0,100)}},0)});w=i.find("button.wp-cancel-pw");w.on("click",function(){d=false;n.val("");wp.ajax.post("generate-password").done(function(z){r.data("pw",z)});x.show();y.hide();b.hide(0,function(){t.removeProp("checked")});r.prop("disabled",true);q.prop("disabled",true);n.prop("disabled",true);a();if(i.closest("form").is("#your-profile")){r.val("").trigger("pwupdate");p.prop("disabled",false)}});i.closest("form").on("submit",function(){d=false;r.prop("disabled",false);q.prop("disabled",false);q.val(r.val());l.removeClass("show-password")})}function m(){var w=f("#pass1").val(),x;f("#pass-strength-result").removeClass("short bad good strong");if(!w){f("#pass-strength-result").html("&nbsp;");return}x=wp.passwordStrength.meter(w,wp.passwordStrength.userInputBlacklist(),w);switch(x){case -1:f("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:f("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:f("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:f("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:f("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:f("#pass-strength-result").addClass("short").html(pwsL10n["short"])}}function j(){var w=f("#pass-strength-result")[0];if(w.className){r.add(n).addClass(w.className);if("short"===w.className||"bad"===w.className){if(!t.prop("checked")){p.prop("disabled",true)}b.show()}else{p.prop("disabled",false);b.hide()}}}f(document).ready(function(){var A,y,x,z,w=f("#display_name");f("#pass1").val("").on(v+" pwupdate",m);f("#pass-strength-result").show();f(".color-palette").click(function(){f(this).siblings('input[name="admin_color"]').prop("checked",true)});if(w.length){f("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var C=[],B={display_nickname:f("#nickname").val()||"",display_username:f("#user_login").val()||"",display_firstname:f("#first_name").val()||"",display_lastname:f("#last_name").val()||""};if(B.display_firstname&&B.display_lastname){B.display_firstlast=B.display_firstname+" "+B.display_lastname;B.display_lastfirst=B.display_lastname+" "+B.display_firstname}f.each(f("option",w),function(D,E){C.push(E.value)});f.each(B,function(F,D){if(!D){return}var E=D.replace(/<\/?[a-z][^>]*>/gi,"");if(B[F].length&&f.inArray(E,C)===-1){C.push(E);f("<option />",{text:E}).appendTo(w)}})})}A=f("#color-picker");y=f("#colors-css");x=f("input#user_id").val();z=f('input[name="checkuser_id"]').val();A.on("click.colorpicker",".color-option",function(){var B,D=f(this);if(D.hasClass("selected")){return}D.siblings(".selected").removeClass("selected");D.addClass("selected").find('input[type="radio"]').prop("checked",true);if(x===z){if(0===y.length){y=f('<link rel="stylesheet" />').appendTo("head")}y.attr("href",D.children(".css_url").val());if(typeof wp!=="undefined"&&wp.svgPainter){try{B=f.parseJSON(D.children(".icon_colors").val())}catch(C){}if(B){wp.svgPainter.setColors(B);wp.svgPainter.paint()}}f.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:D.children('input[name="admin_color"]').val(),nonce:f("#color-nonce").val()}).done(function(E){if(E.success){f("body").removeClass(E.data.previousScheme).addClass(E.data.currentScheme)}})}});e()});f("#destroy-sessions").on("click",function(x){var w=f(this);wp.ajax.post("destroy-sessions",{nonce:f("#_wpnonce").val(),user_id:f("#user_id").val()}).done(function(y){w.prop("disabled",true);w.siblings(".notice").remove();w.before('<div class="notice notice-success inline"><p>'+y.message+"</p></div>")}).fail(function(y){w.siblings(".notice").remove();w.before('<div class="notice notice-error inline"><p>'+y.message+"</p></div>")});x.preventDefault()});window.generatePassword=s;f(window).on("beforeunload",function(){if(true===d){return userProfileL10n.warn}})})(jQuery);