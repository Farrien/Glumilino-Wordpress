(function(M){var O=false,J,G,A,E,K,B,Q,y,P,C,x,H,w;if("oninput" in document.createElement("input")){w="input"}else{w="keyup"}function z(){if(typeof zxcvbn!=="function"){setTimeout(z,50);return}else{if(!A.val()){A.val(A.data("pw"));A.trigger("pwupdate");I()}else{F();I()}}if(1!==parseInt(P.data("start-masked"),10)){G.addClass("show-password")}else{P.trigger("click")}M("#pw-weak-text-label").html(userProfileL10n.warnWeak)}function D(){H=A.val();G=A.parent();E=M('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(A[0].className).data("pw",A.data("pw")).val(A.val()).on(w,function(){if(E.val()===H){return}B.val(E.val());A.val(E.val()).trigger("pwupdate");H=E.val()});A.after(E);if(1===parseInt(A.data("reveal"),10)){z()}A.on(w+" pwupdate",function(){if(A.val()===H){return}H=A.val();if(E.val()!==H){E.val(H)}A.add(E).removeClass("short bad good strong");I()})}function R(){P.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden");E.focus();K.attr("for","pass1-text")}function L(){P=J.find(".wp-hide-pw");P.show().on("click",function(){if(1===parseInt(P.data("toggle"),10)){G.addClass("show-password");R();if(!_.isUndefined(E[0].setSelectionRange)){E[0].setSelectionRange(0,100)}}else{G.removeClass("show-password");P.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility");A.focus();K.attr("for","pass1");if(!_.isUndefined(A[0].setSelectionRange)){A[0].setSelectionRange(0,100)}}})}function N(){var c,a,b;J=M(".user-pass1-wrap");K=J.find("th label").attr("for","pass1-text");M(".user-pass2-wrap").hide();x=M("#submit").on("click",function(){O=false});C=x.add(" #createusersub");Q=M(".pw-weak");y=Q.find(".pw-checkbox");y.change(function(){C.prop("disabled",!y.prop("checked"))});A=M("#pass1");if(A.length){D()}B=M("#pass2").on(w,function(){if(B.val().length>0){A.val(B.val());B.val("");H="";A.trigger("pwupdate")}});if(A.is(":hidden")){A.prop("disabled",true);B.prop("disabled",true);E.prop("disabled",true)}c=J.find(".wp-pwd");a=J.find("button.wp-generate-pw");L();if(a.length){c.hide()}a.show();a.on("click",function(){O=true;a.hide();c.show();A.attr("disabled",false);B.attr("disabled",false);E.attr("disabled",false);if(E.val().length===0){z()}_.defer(function(){E.focus();if(!_.isUndefined(E[0].setSelectionRange)){E[0].setSelectionRange(0,100)}},0)});b=J.find("button.wp-cancel-pw");b.on("click",function(){O=false;E.val("");wp.ajax.post("generate-password").done(function(d){A.data("pw",d)});a.show();c.hide();Q.hide(0,function(){y.removeProp("checked")});A.prop("disabled",true);B.prop("disabled",true);E.prop("disabled",true);R();if(J.closest("form").is("#your-profile")){A.val("").trigger("pwupdate");C.prop("disabled",false)}});J.closest("form").on("submit",function(){O=false;A.prop("disabled",false);B.prop("disabled",false);B.val(A.val());G.removeClass("show-password")})}function F(){var b=M("#pass1").val(),a;M("#pass-strength-result").removeClass("short bad good strong");if(!b){M("#pass-strength-result").html("&nbsp;");return}a=wp.passwordStrength.meter(b,wp.passwordStrength.userInputBlacklist(),b);switch(a){case -1:M("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:M("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:M("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:M("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:M("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:M("#pass-strength-result").addClass("short").html(pwsL10n["short"])}}function I(){var a=M("#pass-strength-result")[0];if(a.className){A.add(E).addClass(a.className);if("short"===a.className||"bad"===a.className){if(!y.prop("checked")){C.prop("disabled",true)}Q.show()}else{C.prop("disabled",false);Q.hide()}}}M(document).ready(function(){var b,e,a,d,c=M("#display_name");M("#pass1").val("").on(w+" pwupdate",F);M("#pass-strength-result").show();M(".color-palette").click(function(){M(this).siblings('input[name="admin_color"]').prop("checked",true)});if(c.length){M("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var f=[],g={display_nickname:M("#nickname").val()||"",display_username:M("#user_login").val()||"",display_firstname:M("#first_name").val()||"",display_lastname:M("#last_name").val()||""};if(g.display_firstname&&g.display_lastname){g.display_firstlast=g.display_firstname+" "+g.display_lastname;g.display_lastfirst=g.display_lastname+" "+g.display_firstname}M.each(M("option",c),function(i,h){f.push(h.value)});M.each(g,function(h,j){if(!j){return}var i=j.replace(/<\/?[a-z][^>]*>/gi,"");if(g[h].length&&M.inArray(i,f)===-1){f.push(i);M("<option />",{text:i}).appendTo(c)}})})}b=M("#color-picker");e=M("#colors-css");a=M("input#user_id").val();d=M('input[name="checkuser_id"]').val();b.on("click.colorpicker",".color-option",function(){var h,f=M(this);if(f.hasClass("selected")){return}f.siblings(".selected").removeClass("selected");f.addClass("selected").find('input[type="radio"]').prop("checked",true);if(a===d){if(0===e.length){e=M('<link rel="stylesheet" />').appendTo("head")}e.attr("href",f.children(".css_url").val());if(typeof wp!=="undefined"&&wp.svgPainter){try{h=M.parseJSON(f.children(".icon_colors").val())}catch(g){}if(h){wp.svgPainter.setColors(h);wp.svgPainter.paint()}}M.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:f.children('input[name="admin_color"]').val(),nonce:M("#color-nonce").val()}).done(function(i){if(i.success){M("body").removeClass(i.data.previousScheme).addClass(i.data.currentScheme)}})}});N()});M("#destroy-sessions").on("click",function(a){var b=M(this);wp.ajax.post("destroy-sessions",{nonce:M("#_wpnonce").val(),user_id:M("#user_id").val()}).done(function(c){b.prop("disabled",true);b.siblings(".notice").remove();b.before('<div class="notice notice-success inline"><p>'+c.message+"</p></div>")}).fail(function(c){b.siblings(".notice").remove();b.before('<div class="notice notice-error inline"><p>'+c.message+"</p></div>")});a.preventDefault()});window.generatePassword=z;M(window).on("beforeunload",function(){if(true===O){return userProfileL10n.warn}})})(jQuery);