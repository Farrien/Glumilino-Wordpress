var setCommentsList,theList,theExtraList,commentReply;(function(s){var w,r,t,u,x,m,p,n=document.title,o=s("#dashboard_right_now").length,v,q;w=function(a){var b=parseInt(a.html().replace(/[^0-9]+/g,""),10);if(isNaN(b)){return 0}return b};r=function(c,b){var a="";if(isNaN(b)){return}b=b<1?"0":b.toString();if(b.length>3){while(b.length>3){a=thousandsSeparator+b.substr(b.length-3)+a;b=b.substr(0,b.length-3)}b=b+a}c.html(b)};x=function(d,b){var a=".post-com-count-"+b,f="comment-count-no-comments",c="comment-count-approved",e,g;t("span.approved-count",d);if(!b){return}e=s("span."+c,a);g=s("span."+f,a);e.each(function(){var i=s(this),h=w(i)+d;if(h<1){h=0}if(0===h){i.removeClass(c).addClass(f)}else{i.addClass(c).removeClass(f)}r(i,h)});g.each(function(){var h=s(this);if(d>0){h.removeClass(f).addClass(c)}else{h.addClass(f).removeClass(c)}r(h,d)})};t=function(a,b){s(a).each(function(){var d=s(this),c=w(d)+b;if(c<1){c=0}r(d,c)})};p=function(a){if(!o||!a||!a.i18n_comments_text){return}var b=s("#dashboard_right_now");s(".comment-count a",b).text(a.i18n_comments_text);s(".comment-mod-count a",b).text(a.i18n_moderation_text).parent()[a.in_moderation>0?"removeClass":"addClass"]("hidden")};m=function(c){var b,e,a,d;q=q||new RegExp(adminCommentsL10n.docTitleCommentsCount.replace("%s","\\([0-9"+thousandsSeparator+"]+\\)")+"?");v=v||s("<div />");b=n;d=q.exec(document.title);if(d){d=d[0];v.html(d);a=w(v)+c}else{v.html(0);a=c}if(a>=1){r(v,a);e=q.exec(document.title);if(e){b=document.title.replace(e[0],adminCommentsL10n.docTitleCommentsCount.replace("%s",v.text())+" ")}}else{e=q.exec(b);if(e){b=b.replace(e[0],adminCommentsL10n.docTitleComments)}}document.title=b};u=function(e,b){var a=".post-com-count-"+b,g="comment-count-no-pending",f="post-com-count-no-pending",h="comment-count-pending",d,c;if(!o){m(e)}s("span.pending-count").each(function(){var j=s(this),i=w(j)+e;if(i<1){i=0}j.closest(".awaiting-mod")[0===i?"addClass":"removeClass"]("count-0");r(j,i)});if(!b){return}d=s("span."+h,a);c=s("span."+g,a);d.each(function(){var j=s(this),i=w(j)+e;if(i<1){i=0}if(0===i){j.parent().addClass(f);j.removeClass(h).addClass(g)}else{j.parent().removeClass(f);j.addClass(h).removeClass(g)}r(j,i)});c.each(function(){var i=s(this);if(e>0){i.parent().removeClass(f);i.removeClass(g).addClass(h)}else{i.parent().addClass(f);i.addClass(g).removeClass(h)}r(i,e)})};setCommentsList=function(){var e,c,a,b,j,d,h,f,i,g=0;e=s('input[name="_total"]',"#comments-form");c=s('input[name="_per_page"]',"#comments-form");a=s('input[name="_page"]',"#comments-form");d=function(l,k,z){if(k<g){return}if(z){g=k}e.val(l.toString())};b=function(l,H){var k,F,E,D,G=s("#"+H.element);if(true!==H.parsed){D=H.parsed.responses[0]}k=s("#replyrow");F=s("#comment_ID",k).val();E=s("#replybtn",k);if(G.is(".unapproved")){if(H.data.id==F){E.text(adminCommentsL10n.replyApprove)}G.find(".row-actions span.view").addClass("hidden").end().find("div.comment_status").html("0")}else{if(H.data.id==F){E.text(adminCommentsL10n.reply)}G.find(".row-actions span.view").removeClass("hidden").end().find("div.comment_status").html("1")}i=s("#"+H.element).is("."+H.dimClass)?1:-1;if(D){p(D.supplemental);u(i,D.supplemental.postId);x(-1*i,D.supplemental.postId)}else{u(i);x(-1*i)}};j=function(J,k){var O,M,L,K,l,N,H,I=false,P=s(J.target).attr("data-wp-lists");J.data._total=e.val()||0;J.data._per_page=c.val()||0;J.data._page=a.val()||0;J.data._url=document.location.href;J.data.comment_status=s('input[name="comment_status"]',"#comments-form").val();if(P.indexOf(":trash=1")!=-1){I="trash"}else{if(P.indexOf(":spam=1")!=-1){I="spam"}}if(I){M=P.replace(/.*?comment-([0-9]+).*/,"$1");L=s("#comment-"+M);O=s("#"+I+"-undo-holder").html();L.find(".check-column :checkbox").prop("checked",false);if(L.siblings("#replyrow").length&&commentReply.cid==M){commentReply.close()}if(L.is("tr")){K=L.children(":visible").length;H=s(".author strong",L).text();l=s('<tr id="undo-'+M+'" class="undo un'+I+'" style="display:none;"><td colspan="'+K+'">'+O+"</td></tr>")}else{H=s(".comment-author",L).text();l=s('<div id="undo-'+M+'" style="display:none;" class="undo un'+I+'">'+O+"</div>")}L.before(l);s("strong","#undo-"+M).text(H);N=s(".undo a","#undo-"+M);N.attr("href","comment.php?action=un"+I+"comment&c="+M+"&_wpnonce="+J.data._ajax_nonce);N.attr("data-wp-lists","delete:the-comment-list:comment-"+M+"::un"+I+"=1");N.attr("class","vim-z vim-destructive");s(".avatar",L).first().clone().prependTo("#undo-"+M+" ."+I+"-undo-inside");N.click(function(y){y.preventDefault();y.stopPropagation();k.wpList.del(this);s("#undo-"+M).css({backgroundColor:"#ceb"}).fadeOut(350,function(){s(this).remove();s("#comment-"+M).css("backgroundColor","").fadeIn(300,function(){s(this).show()})})})}return J};h=function(ae,T){var Z,k,U,ab,aa=true===T.parsed?{}:T.parsed.responses[0],ah=true===T.parsed?"":aa.supplemental.status,V=true===T.parsed?"":aa.supplemental.postId,X=true===T.parsed?"":aa.supplemental,W=s(T.target).parent(),S=s("#"+T.element),Y,ac,aj,l,ag=S.hasClass("approved"),ad=S.hasClass("unapproved"),R=S.hasClass("spam"),ai=S.hasClass("trash"),af=false;p(X);if(W.is("span.undo")){if(W.hasClass("unspam")){Y=-1;if("trash"===ah){ac=1}else{if("1"===ah){l=1}else{if("0"===ah){aj=1}}}}else{if(W.hasClass("untrash")){ac=-1;if("spam"===ah){Y=1}else{if("1"===ah){l=1}else{if("0"===ah){aj=1}}}}}af=true}else{if(W.is("span.spam")){if(ag){l=-1}else{if(ad){aj=-1}else{if(ai){ac=-1}}}Y=1}else{if(W.is("span.unspam")){if(ag){aj=1}else{if(ad){l=1}else{if(ai){if(W.hasClass("approve")){l=1}else{if(W.hasClass("unapprove")){aj=1}}}else{if(R){if(W.hasClass("approve")){l=1}else{if(W.hasClass("unapprove")){aj=1}}}}}}Y=-1}else{if(W.is("span.trash")){if(ag){l=-1}else{if(ad){aj=-1}else{if(R){Y=-1}}}ac=1}else{if(W.is("span.untrash")){if(ag){aj=1}else{if(ad){l=1}else{if(ai){if(W.hasClass("approve")){l=1}else{if(W.hasClass("unapprove")){aj=1}}}}}ac=-1}else{if(W.is("span.approve:not(.unspam):not(.untrash)")){l=1;aj=-1}else{if(W.is("span.unapprove:not(.unspam):not(.untrash)")){l=-1;aj=1}else{if(W.is("span.delete")){if(R){Y=-1}else{if(ai){ac=-1}}}}}}}}}}if(aj){u(aj,V);t("span.all-count",aj)}if(l){x(l,V);t("span.all-count",l)}if(Y){t("span.spam-count",Y)}if(ac){t("span.trash-count",ac)}if(!o){k=e.val()?parseInt(e.val(),10):0;if(s(T.target).parent().is("span.undo")){k++}else{k--}if(k<0){k=0}if("object"===typeof ae){if(aa.supplemental.total_items_i18n&&g<aa.supplemental.time){Z=aa.supplemental.total_items_i18n||"";if(Z){s(".displaying-num").text(Z);s(".total-pages").text(aa.supplemental.total_pages_i18n);s(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",aa.supplemental.total_pages==s(".current-page").val())}d(k,aa.supplemental.time,true)}else{if(aa.supplemental.time){d(k,aa.supplemental.time,false)}}}else{d(k,ae,false)}}if(!theExtraList||theExtraList.length===0||theExtraList.children().length===0||af){return}theList.get(0).wpList.add(theExtraList.children(":eq(0):not(.no-items)").remove().clone());f();U=s(":animated","#the-comment-list");ab=function(){if(!s("#the-comment-list tr:visible").length){theList.get(0).wpList.add(theExtraList.find(".no-items").clone())}};if(U.length){U.promise().done(ab)}else{ab()}};f=function(A){var k=s.query.get(),l=s(".total-pages").text(),B=s('input[name="_per_page"]',"#comments-form").val();if(!k.paged){k.paged=1}if(k.paged>l){return}if(A){theExtraList.empty();k.number=Math.min(8,B)}else{k.number=1;k.offset=Math.min(8,B)-1}k.no_placeholder=true;k.paged++;if(true===k.comment_type){k.comment_type=""}k=s.extend(k,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:s("#_ajax_fetch_list_nonce").val()});s.ajax({url:ajaxurl,global:false,dataType:"json",data:k,success:function(y){theExtraList.get(0).wpList.add(y.rows)}})};theExtraList=s("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"});theList=s("#the-comment-list").wpList({alt:"",delBefore:j,dimAfter:b,delAfter:h,addColor:"none"}).bind("wpListDelEnd",function(B,k){var l=s(k.target).attr("data-wp-lists"),A=k.element.replace(/[^0-9]+/g,"");if(l.indexOf(":trash=1")!=-1||l.indexOf(":spam=1")!=-1){s("#undo-"+A).fadeIn(300,function(){s(this).show()})}})};commentReply={cid:"",act:"",originalContent:"",init:function(){var a=s("#replyrow");s("a.cancel",a).click(function(){return commentReply.revert()});s("a.save",a).click(function(){return commentReply.send()});s("input#author-name, input#author-email, input#author-url",a).keypress(function(b){if(b.which==13){commentReply.send();b.preventDefault();return false}});s("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle(s(this).parent())});s("#doaction, #doaction2, #post-query-submit").click(function(){if(s("#the-comment-list #replyrow").length>0){commentReply.close()}});this.comments_listing=s('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(a){a.each(function(){s(this).find(".column-comment > p").dblclick(function(){commentReply.toggle(s(this).parent())})})},toggle:function(a){if("none"!==s(a).css("display")&&(s("#replyrow").parent().is("#com-reply")||window.confirm(adminCommentsL10n.warnQuickEdit))){s(a).find("a.vim-q").click()}},revert:function(){if(s("#the-comment-list #replyrow").length<1){return false}s("#replyrow").fadeOut("fast",function(){commentReply.close()});return false},close:function(){var b,a=s("#replyrow");if(a.parent().is("#com-reply")){return}if(this.cid&&this.act=="edit-comment"){b=s("#comment-"+this.cid);b.fadeIn(300,function(){b.show()}).css("backgroundColor","")}if(typeof QTags!="undefined"){QTags.closeAllTags("replycontent")}s("#add-new-comment").css("display","");a.hide();s("#com-reply").append(a);s("#replycontent").css("height","").val("");s("#edithead input").val("");s(".error",a).empty().hide();s(".spinner",a).removeClass("is-active");this.cid="";this.originalContent=""},open:function(f,c,a){var e,b,k,h,i,g=this,j=s("#comment-"+f),l=j.height(),d=0;if(!this.discardCommentChanges()){return false}g.close();g.cid=f;e=s("#replyrow");b=s("#inline-"+f);a=a||"replyto";k="edit"==a?"edit":"replyto";k=g.act=k+"-comment";g.originalContent=s("textarea.comment",b).val();d=s("> th:visible, > td:visible",j).length;if(e.hasClass("inline-edit-row")&&0!==d){s("td",e).attr("colspan",d)}s("#action",e).val(k);s("#comment_post_ID",e).val(c);s("#comment_ID",e).val(f);if(a=="edit"){s("#author-name",e).val(s("div.author",b).text());s("#author-email",e).val(s("div.author-email",b).text());s("#author-url",e).val(s("div.author-url",b).text());s("#status",e).val(s("div.comment_status",b).text());s("#replycontent",e).val(s("textarea.comment",b).val());s("#edithead, #editlegend, #savebtn",e).show();s("#replyhead, #replybtn, #addhead, #addbtn",e).hide();if(l>120){i=l>500?500:l;s("#replycontent",e).css("height",i+"px")}j.after(e).fadeOut("fast",function(){s("#replyrow").fadeIn(300,function(){s(this).show()})})}else{if(a=="add"){s("#addhead, #addbtn",e).show();s("#replyhead, #replybtn, #edithead, #editlegend, #savebtn",e).hide();s("#the-comment-list").prepend(e);s("#replyrow").fadeIn(300)}else{h=s("#replybtn",e);s("#edithead, #editlegend, #savebtn, #addhead, #addbtn",e).hide();s("#replyhead, #replybtn",e).show();j.after(e);if(j.hasClass("unapproved")){h.text(adminCommentsL10n.replyApprove)}else{h.text(adminCommentsL10n.reply)}s("#replyrow").fadeIn(300,function(){s(this).show()})}}setTimeout(function(){var G,F,E,D,y;G=s("#replyrow").offset().top;F=G+s("#replyrow").height();E=window.pageYOffset||document.documentElement.scrollTop;D=document.documentElement.clientHeight||window.innerHeight||0;y=E+D;if(y-20<F){window.scroll(0,F-D+35)}else{if(G-20<E){window.scroll(0,G-35)}}s("#replycontent").focus().keyup(function(z){if(z.which==27){commentReply.revert()}})},600);return false},send:function(){var a={};s("#replysubmit .error").hide();s("#replysubmit .spinner").addClass("is-active");s("#replyrow input").not(":button").each(function(){var b=s(this);a[b.attr("name")]=b.val()});a.content=s("#replycontent").val();a.id=a.comment_post_ID;a.comments_listing=this.comments_listing;a.p=s('[name="p"]').val();if(s("#comment-"+s("#comment_ID").val()).hasClass("unapproved")){a.approve_parent=1}s.ajax({type:"POST",url:ajaxurl,data:a,success:function(b){commentReply.show(b)},error:function(b){commentReply.error(b)}});return false},show:function(g){var e=this,d,b,c,f,a;if(typeof(g)=="string"){e.error({responseText:g});return false}d=wpAjax.parseAjaxResponse(g);if(d.errors){e.error({responseText:wpAjax.broken});return false}e.revert();d=d.responses[0];c="#comment-"+d.id;if("edit-comment"==e.act){s(c).remove()}if(d.supplemental.parent_approved){a=s("#comment-"+d.supplemental.parent_approved);u(-1,d.supplemental.parent_post_id);if(this.comments_listing=="moderated"){a.animate({backgroundColor:"#CCEEBB"},400,function(){a.fadeOut()});return}}if(d.supplemental.i18n_comments_text){if(o){p(d.supplemental)}else{x(1,d.supplemental.parent_post_id);t("span.all-count",1)}}b=s.trim(d.data);s(b).hide();s("#replyrow").after(b);c=s(c);e.addEvents(c);f=c.hasClass("unapproved")?"#FFFFE0":c.closest(".widefat, .postbox").css("backgroundColor");c.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:f},300,function(){if(a&&a.length){a.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:f},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")}})},error:function(a){var b=a.statusText;s("#replysubmit .spinner").removeClass("is-active");if(a.responseText){b=a.responseText.replace(/<.[^<>]*?>/g,"")}if(b){s("#replysubmit .error").html(b).show()}},addcomment:function(a){var b=this;s("#add-new-comment").fadeOut(200,function(){b.open(0,a,"add");s("table.comments-box").css("display","");s("#no-comments").remove()})},discardCommentChanges:function(){var a=s("#replyrow");if(this.originalContent===s("#replycontent",a).val()){return true}return window.confirm(adminCommentsL10n.warnCommentChanges)}};s(document).ready(function(){var b,a,d,c;setCommentsList();commentReply.init();s(document).on("click","span.delete a.delete",function(e){e.preventDefault()});if(typeof s.table_hotkeys!="undefined"){b=function(e){return function(){var f,g;f="next"==e?"first":"last";g=s(".tablenav-pages ."+e+"-page:not(.disabled)");if(g.length){window.location=g[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+f+"=1"}}};a=function(e,f){window.location=s("span.edit a",f).attr("href")};d=function(){s("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")};c=function(e){return function(){var f=s('select[name="action"]');s('option[value="'+e+'"]',f).prop("selected",true);s("#doaction").click()}};s.table_hotkeys(s("table.widefat"),["a","u","s","d","r","q","z",["e",a],["shift+x",d],["shift+a",c("approve")],["shift+s",c("spam")],["shift+d",c("delete")],["shift+t",c("trash")],["shift+z",c("untrash")],["shift+u",c("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:b("prev"),next_page_link_cb:b("next"),hotkeys_opts:{disableInInput:true,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0})}s("#the-comment-list").on("click",".comment-inline",function(e){e.preventDefault();var g=s(this),f="replyto";if("undefined"!==typeof g.data("action")){f=g.data("action")}commentReply.open(g.data("commentId"),g.data("postId"),f)})})})(jQuery);