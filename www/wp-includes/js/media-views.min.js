(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0)}if(a){return a(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l)},h,h.exports,e,b,g,d)}return g[m].exports}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f])}return c})({1:[function(b,c,a){var d=wp.media.model.Selection,g=wp.media.controller.Library,f;f=g.extend({defaults:_.defaults({multiple:"add",filterable:"uploaded",priority:100,syncSelection:false},g.prototype.defaults),initialize:function(){var h=this.get("collectionType");if("video"===this.get("type")){h="video-"+h}this.set("id",h+"-library");this.set("toolbar",h+"-add");this.set("menu",h);if(!this.get("library")){this.set("library",wp.media.query({type:this.get("type")}))}g.prototype.initialize.apply(this,arguments)},activate:function(){var h=this.get("library"),i=this.get("editLibrary"),j=this.frame.state(this.get("collectionType")+"-edit").get("library");if(i&&i!==j){h.unobserve(i)}h.validator=function(k){return !!this.mirroring.get(k.cid)&&!j.get(k.cid)&&d.prototype.validator.apply(this,arguments)};h.reset(h.mirroring.models,{silent:true});h.observe(j);this.set("editLibrary",j);g.prototype.activate.apply(this,arguments)}});c.exports=f},{}],2:[function(b,d,a){var h=wp.media.controller.Library,c=wp.media.view.l10n,f=jQuery,g;g=h.extend({defaults:{multiple:false,sortable:true,date:false,searchable:false,content:"browse",describe:true,dragInfo:true,idealColumnWidth:170,editing:false,priority:60,SettingsView:false,syncSelection:false},initialize:function(){var i=this.get("collectionType");if("video"===this.get("type")){i="video-"+i}this.set("id",i+"-edit");this.set("toolbar",i+"-edit");if(!this.get("library")){this.set("library",new wp.media.model.Selection())}if(!this.get("AttachmentView")){this.set("AttachmentView",wp.media.view.Attachment.EditLibrary)}h.prototype.initialize.apply(this,arguments)},activate:function(){var i=this.get("library");i.props.set("type",this.get("type"));this.get("library").observe(wp.Uploader.queue);this.frame.on("content:render:browse",this.renderSettings,this);h.prototype.activate.apply(this,arguments)},deactivate:function(){this.get("library").unobserve(wp.Uploader.queue);this.frame.off("content:render:browse",this.renderSettings,this);h.prototype.deactivate.apply(this,arguments)},renderSettings:function(n){var j=this.get("library"),k=this.get("collectionType"),l=this.get("dragInfoText"),i=this.get("SettingsView"),m={};if(!j||!n){return}j[k]=j[k]||new Backbone.Model();m[k]=new i({controller:this,model:j[k],priority:40});n.sidebar.set(m);if(l){n.toolbar.set("dragInfo",new wp.media.View({el:f('<div class="instructions">'+l+"</div>")[0],priority:-40}))}n.toolbar.set("reverse",{text:c.reverseOrder,priority:80,click:function(){j.reset(j.toArray().reverse())}})}});d.exports=g},{}],3:[function(c,f,a){var d=wp.media.view.l10n,b;b=wp.media.controller.State.extend({defaults:{id:"cropper",title:d.cropImage,toolbar:"crop",content:"crop",router:false,canSkipCrop:false,doCropArgs:{}},activate:function(){this.frame.on("content:create:crop",this.createCropContent,this);this.frame.on("close",this.removeCropper,this);this.set("selection",new Backbone.Collection(this.frame._selection.single))},deactivate:function(){this.frame.toolbar.mode("browse")},createCropContent:function(){this.cropperView=new wp.media.view.Cropper({controller:this,attachment:this.get("selection").first()});this.cropperView.on("image-loaded",this.createCropToolbar,this);this.frame.content.set(this.cropperView)},removeCropper:function(){this.imgSelect.cancelSelection();this.imgSelect.setOptions({remove:true});this.imgSelect.update();this.cropperView.remove()},createCropToolbar:function(){var h,g;h=this.get("canSkipCrop")||false;g={controller:this.frame,items:{insert:{style:"primary",text:d.cropImage,priority:80,requires:{library:false,selection:false},click:function(){var i=this.controller,j;j=i.state().get("selection").first();j.set({cropDetails:i.state().imgSelect.getSelection()});this.$el.text(d.cropping);this.$el.attr("disabled",true);i.state().doCrop(j).done(function(k){i.trigger("cropped",k);i.close()}).fail(function(){i.trigger("content:error:crop")})}}}};if(h){_.extend(g.items,{skip:{style:"secondary",text:d.skipCropping,priority:70,requires:{library:false,selection:false},click:function(){var i=this.controller.state().get("selection").first();this.controller.state().cropperView.remove();this.controller.trigger("skippedcrop",i);this.controller.close()}}})}this.frame.toolbar.set(new wp.media.view.Toolbar(g))},doCrop:function(g){return wp.ajax.post("custom-header-crop",_.extend({},this.defaults.doCropArgs,{nonce:g.get("nonces").edit,id:g.get("id"),cropDetails:g.get("cropDetails")}))}});f.exports=b},{}],4:[function(b,c,a){var f=wp.media.controller,d;d=f.Cropper.extend({doCrop:function(j){var i=j.get("cropDetails"),h=this.get("control"),g=i.width/i.height;if(h.params.flex_width&&h.params.flex_height){i.dst_width=i.width;i.dst_height=i.height}else{i.dst_width=h.params.flex_width?h.params.height*g:h.params.width;i.dst_height=h.params.flex_height?h.params.width/g:h.params.height}return wp.ajax.post("crop-image",{wp_customize:"on",nonce:j.get("nonces").edit,id:j.get("id"),context:h.id,cropDetails:i})}});c.exports=d},{}],5:[function(c,f,a){var d=wp.media.view.l10n,b;b=wp.media.controller.State.extend({defaults:{id:"edit-image",title:d.editImage,menu:false,toolbar:"edit-image",content:"edit-image",url:""},activate:function(){this.frame.on("toolbar:render:edit-image",_.bind(this.toolbar,this))},deactivate:function(){this.frame.off("toolbar:render:edit-image")},toolbar:function(){var i=this.frame,g=i.lastState(),h=g&&g.id;i.toolbar.set(new wp.media.view.Toolbar({controller:i,items:{back:{style:"primary",text:d.back,priority:20,click:function(){if(h){i.setState(h)}else{i.close()}}}}}))}});f.exports=b},{}],6:[function(b,d,a){var c=wp.media.view.l10n,g=Backbone.$,f;f=wp.media.controller.State.extend({defaults:{id:"embed",title:c.insertFromUrlTitle,content:"embed",menu:"default",toolbar:"main-embed",priority:120,type:"link",url:"",metadata:{}},sensitivity:400,initialize:function(h){this.metadata=h.metadata;this.debouncedScan=_.debounce(_.bind(this.scan,this),this.sensitivity);this.props=new Backbone.Model(this.metadata||{url:""});this.props.on("change:url",this.debouncedScan,this);this.props.on("change:url",this.refresh,this);this.on("scan",this.scanImage,this)},scan:function(){var i,j=this,h={type:"link",scanners:[]};if(this.props.get("url")){this.trigger("scan",h)}if(h.scanners.length){i=h.scanners=g.when.apply(g,h.scanners);i.always(function(){if(j.get("scanners")===i){j.set("loading",false)}})}else{h.scanners=null}h.loading=!!h.scanners;this.set(h)},scanImage:function(i){var m=this.frame,k=this,j=this.props.get("url"),l=new Image(),h=g.Deferred();i.scanners.push(h.promise());l.onload=function(){h.resolve();if(k!==m.state()||j!==k.props.get("url")){return}k.set({type:"image"});k.props.set({width:l.width,height:l.height})};l.onerror=h.reject;l.src=j},refresh:function(){this.frame.toolbar.get().refresh()},reset:function(){this.props.clear().set({url:""});if(this.active){this.refresh()}}});d.exports=f},{}],7:[function(b,d,a){var f=wp.media.model.Attachment,h=wp.media.controller.Library,c=wp.media.view.l10n,g;g=h.extend({defaults:_.defaults({id:"featured-image",title:c.setFeaturedImageTitle,multiple:false,filterable:"uploaded",toolbar:"featured-image",priority:60,syncSelection:true},h.prototype.defaults),initialize:function(){var j,i;if(!this.get("library")){this.set("library",wp.media.query({type:"image"}))}h.prototype.initialize.apply(this,arguments);j=this.get("library");i=j.comparator;j.comparator=function(l,k){var n=!!this.mirroring.get(l.cid),m=!!this.mirroring.get(k.cid);if(!n&&m){return -1}else{if(n&&!m){return 1}else{return i.apply(this,arguments)}}};j.observe(this.get("selection"))},activate:function(){this.updateSelection();this.frame.on("open",this.updateSelection,this);h.prototype.activate.apply(this,arguments)},deactivate:function(){this.frame.off("open",this.updateSelection,this);h.prototype.deactivate.apply(this,arguments)},updateSelection:function(){var i=this.get("selection"),k=wp.media.view.settings.post.featuredImageId,j;if(""!==k&&-1!==k){j=f.get(k);j.fetch()}i.reset(j?[j]:[])}});d.exports=g},{}],8:[function(b,d,a){var f=wp.media.model.Selection,h=wp.media.controller.Library,c=wp.media.view.l10n,g;g=h.extend({defaults:_.defaults({id:"gallery-library",title:c.addToGalleryTitle,multiple:"add",filterable:"uploaded",menu:"gallery",toolbar:"gallery-add",priority:100,syncSelection:false},h.prototype.defaults),initialize:function(){if(!this.get("library")){this.set("library",wp.media.query({type:"image"}))}h.prototype.initialize.apply(this,arguments)},activate:function(){var i=this.get("library"),j=this.frame.state("gallery-edit").get("library");if(this.editLibrary&&this.editLibrary!==j){i.unobserve(this.editLibrary)}i.validator=function(k){return !!this.mirroring.get(k.cid)&&!j.get(k.cid)&&f.prototype.validator.apply(this,arguments)};i.reset(i.mirroring.models,{silent:true});i.observe(j);this.editLibrary=j;h.prototype.activate.apply(this,arguments)}});d.exports=g},{}],9:[function(c,f,a){var g=wp.media.controller.Library,d=wp.media.view.l10n,b;b=g.extend({defaults:{id:"gallery-edit",title:d.editGalleryTitle,multiple:false,searchable:false,sortable:true,date:false,display:false,content:"browse",toolbar:"gallery-edit",describe:true,displaySettings:true,dragInfo:true,idealColumnWidth:170,editing:false,priority:60,syncSelection:false},initialize:function(){if(!this.get("library")){this.set("library",new wp.media.model.Selection())}if(!this.get("AttachmentView")){this.set("AttachmentView",wp.media.view.Attachment.EditLibrary)}g.prototype.initialize.apply(this,arguments)},activate:function(){var h=this.get("library");h.props.set("type","image");this.get("library").observe(wp.Uploader.queue);this.frame.on("content:render:browse",this.gallerySettings,this);g.prototype.activate.apply(this,arguments)},deactivate:function(){this.get("library").unobserve(wp.Uploader.queue);this.frame.off("content:render:browse",this.gallerySettings,this);g.prototype.deactivate.apply(this,arguments)},gallerySettings:function(i){if(!this.get("displaySettings")){return}var h=this.get("library");if(!h||!i){return}h.gallery=h.gallery||new Backbone.Model();i.sidebar.set({gallery:new wp.media.view.Settings.Gallery({controller:this,model:h.gallery,priority:40})});i.toolbar.set("reverse",{text:d.reverseOrder,priority:80,click:function(){h.reset(h.toArray().reverse())}})}});f.exports=b},{}],10:[function(c,f,b){var a=wp.media.controller.State,g=wp.media.controller.Library,d=wp.media.view.l10n,h;h=a.extend({defaults:_.defaults({id:"image-details",title:d.imageDetailsTitle,content:"image-details",menu:false,router:false,toolbar:"image-details",editing:false,priority:60},g.prototype.defaults),initialize:function(i){this.image=i.image;a.prototype.initialize.apply(this,arguments)},activate:function(){this.frame.modal.$el.addClass("image-details")}});f.exports=h},{}],11:[function(c,f,b){var d=wp.media.view.l10n,a=window.getUserSetting,g=window.setUserSetting,h;h=wp.media.controller.State.extend({defaults:{id:"library",title:d.mediaLibraryTitle,multiple:false,content:"upload",menu:"default",router:"browse",toolbar:"select",searchable:true,filterable:false,sortable:true,autoSelect:true,describe:false,contentUserSetting:true,syncSelection:true},initialize:function(){var j=this.get("selection"),i;if(!this.get("library")){this.set("library",wp.media.query())}if(!(j instanceof wp.media.model.Selection)){i=j;if(!i){i=this.get("library").props.toJSON();i=_.omit(i,"orderby","query")}this.set("selection",new wp.media.model.Selection(null,{multiple:this.get("multiple"),props:i}))}this.resetDisplays()},activate:function(){this.syncSelection();wp.Uploader.queue.on("add",this.uploading,this);this.get("selection").on("add remove reset",this.refreshContent,this);if(this.get("router")&&this.get("contentUserSetting")){this.frame.on("content:activate",this.saveContentMode,this);this.set("content",a("libraryContent",this.get("content")))}},deactivate:function(){this.recordSelection();this.frame.off("content:activate",this.saveContentMode,this);this.get("selection").off(null,null,this);wp.Uploader.queue.off(null,null,this)},reset:function(){this.get("selection").reset();this.resetDisplays();this.refreshContent()},resetDisplays:function(){var i=wp.media.view.settings.defaultProps;this._displays=[];this._defaultDisplaySettings={align:a("align",i.align)||"none",size:a("imgsize",i.size)||"medium",link:a("urlbutton",i.link)||"none"}},display:function(j){var i=this._displays;if(!i[j.cid]){i[j.cid]=new Backbone.Model(this.defaultDisplaySettings(j))}return i[j.cid]},defaultDisplaySettings:function(j){var i=_.clone(this._defaultDisplaySettings);if(i.canEmbed=this.canEmbed(j)){i.link="embed"}else{if(!this.isImageAttachment(j)&&i.link==="none"){i.link="file"}}return i},isImageAttachment:function(i){if(i.get("uploading")){return/\.(jpe?g|png|gif)$/i.test(i.get("filename"))}return i.get("type")==="image"},canEmbed:function(j){if(!j.get("uploading")){var i=j.get("type");if(i!=="audio"&&i!=="video"){return false}}return _.contains(wp.media.view.settings.embedExts,j.get("filename").split(".").pop())},refreshContent:function(){var j=this.get("selection"),l=this.frame,i=l.router.get(),k=l.content.mode();if(this.active&&!j.length&&i&&!i.get(k)){this.frame.content.render(this.get("content"))}},uploading:function(j){var i=this.frame.content;if("upload"===i.mode()){this.frame.content.mode("browse")}if(this.get("autoSelect")){this.get("selection").add(j);this.frame.trigger("library:selection:add")}},saveContentMode:function(){if("browse"!==this.get("router")){return}var j=this.frame.content.mode(),i=this.frame.router.get();if(i&&i.get(j)){g("libraryContent",j)}}});_.extend(h.prototype,wp.media.selectionSync);f.exports=h},{}],12:[function(b,c,a){var d=wp.media.controller.Library,f;f=d.extend({defaults:_.defaults({filterable:"uploaded",displaySettings:false,priority:80,syncSelection:false},d.prototype.defaults),initialize:function(g){this.media=g.media;this.type=g.type;this.set("library",wp.media.query({type:this.type}));d.prototype.initialize.apply(this,arguments)},activate:function(){if(wp.media.frame.lastMime){this.set("library",wp.media.query({type:wp.media.frame.lastMime}));delete wp.media.frame.lastMime}d.prototype.activate.apply(this,arguments)}});c.exports=f},{}],13:[function(b,c,a){var d=function(f){_.extend(this,_.pick(f||{},"id","view","selector"))};d.extend=Backbone.Model.extend;_.extend(d.prototype,{mode:function(f){if(!f){return this._mode}if(f===this._mode){return this}this.trigger("deactivate");this._mode=f;this.render(f);this.trigger("activate");return this},render:function(g){if(g&&g!==this._mode){return this.mode(g)}var h={view:null},f;this.trigger("create",h);f=h.view;this.trigger("render",f);if(f){this.set(f)}return this},get:function(){return this.view.views.first(this.selector)},set:function(f,g){if(g){g.add=false}return this.view.views.set(this.selector,f,g)},trigger:function(g){var h,f;if(!this._mode){return}f=_.toArray(arguments);h=this.id+":"+g;f[0]=h+":"+this._mode;this.view.trigger.apply(this.view,f);f[0]=h;this.view.trigger.apply(this.view,f);return this}});c.exports=d},{}],14:[function(c,f,a){var g=wp.media.controller.Library,d=wp.media.view.l10n,b;b=g.extend({defaults:_.defaults({id:"replace-image",title:d.replaceImageTitle,multiple:false,filterable:"uploaded",toolbar:"replace",menu:false,priority:60,syncSelection:true},g.prototype.defaults),initialize:function(j){var i,h;this.image=j.image;if(!this.get("library")){this.set("library",wp.media.query({type:"image"}))}g.prototype.initialize.apply(this,arguments);i=this.get("library");h=i.comparator;i.comparator=function(l,k){var n=!!this.mirroring.get(l.cid),m=!!this.mirroring.get(k.cid);if(!n&&m){return -1}else{if(n&&!m){return 1}else{return h.apply(this,arguments)}}};i.observe(this.get("selection"))},activate:function(){this.updateSelection();g.prototype.activate.apply(this,arguments)},updateSelection:function(){var h=this.get("selection"),i=this.image.attachment;h.reset(i?[i]:[])}});f.exports=b},{}],15:[function(c,d,b){var f=wp.media.controller,a;a=f.Cropper.extend({activate:function(){this.frame.on("content:create:crop",this.createCropContent,this);this.frame.on("close",this.removeCropper,this);this.set("selection",new Backbone.Collection(this.frame._selection.single))},createCropContent:function(){this.cropperView=new wp.media.view.SiteIconCropper({controller:this,attachment:this.get("selection").first()});this.cropperView.on("image-loaded",this.createCropToolbar,this);this.frame.content.set(this.cropperView)},doCrop:function(i){var h=i.get("cropDetails"),g=this.get("control");h.dst_width=g.params.width;h.dst_height=g.params.height;return wp.ajax.post("crop-image",{nonce:i.get("nonces").edit,id:i.get("id"),context:"site-icon",cropDetails:h})}});d.exports=a},{}],16:[function(c,d,b){var a=function(f){this.states=new Backbone.Collection(f)};a.extend=Backbone.Model.extend;_.extend(a.prototype,Backbone.Events,{state:function(f){this.states=this.states||new Backbone.Collection();f=f||this._state;if(f&&!this.states.get(f)){this.states.add({id:f})}return this.states.get(f)},setState:function(g){var f=this.state();if((f&&g===f.id)||!this.states||!this.states.get(g)){return this}if(f){f.trigger("deactivate");this._lastState=f.id}this._state=g;this.state().trigger("activate");return this},lastState:function(){if(this._lastState){return this.state(this._lastState)}}});_.each(["on","off","trigger"],function(f){a.prototype[f]=function(){this.states=this.states||new Backbone.Collection();this.states[f].apply(this.states,arguments);return this}});d.exports=a},{}],17:[function(c,d,b){var a=Backbone.Model.extend({constructor:function(){this.on("activate",this._preActivate,this);this.on("activate",this.activate,this);this.on("activate",this._postActivate,this);this.on("deactivate",this._deactivate,this);this.on("deactivate",this.deactivate,this);this.on("reset",this.reset,this);this.on("ready",this._ready,this);this.on("ready",this.ready,this);Backbone.Model.apply(this,arguments);this.on("change:menu",this._updateMenu,this)},ready:function(){},activate:function(){},deactivate:function(){},reset:function(){},_ready:function(){this._updateMenu()},_preActivate:function(){this.active=true},_postActivate:function(){this.on("change:menu",this._menu,this);this.on("change:titleMode",this._title,this);this.on("change:content",this._content,this);this.on("change:toolbar",this._toolbar,this);this.frame.on("title:render:default",this._renderTitle,this);this._title();this._menu();this._toolbar();this._content();this._router()},_deactivate:function(){this.active=false;this.frame.off("title:render:default",this._renderTitle,this);this.off("change:menu",this._menu,this);this.off("change:titleMode",this._title,this);this.off("change:content",this._content,this);this.off("change:toolbar",this._toolbar,this)},_title:function(){this.frame.title.render(this.get("titleMode")||"default")},_renderTitle:function(f){f.$el.text(this.get("title")||"")},_router:function(){var g=this.frame.router,h=this.get("router"),f;this.frame.$el.toggleClass("hide-router",!h);if(!h){return}this.frame.router.render(h);f=g.get();if(f&&f.select){f.select(this.frame.content.mode())}},_menu:function(){var h=this.frame.menu,g=this.get("menu"),f;this.frame.$el.toggleClass("hide-menu",!g);if(!g){return}h.mode(g);f=h.get();if(f&&f.select){f.select(this.id)}},_updateMenu:function(){var f=this.previous("menu"),g=this.get("menu");if(f){this.frame.off("menu:render:"+f,this._renderMenu,this)}if(g){this.frame.on("menu:render:"+g,this._renderMenu,this)}},_renderMenu:function(f){var h=this.get("menuItem"),i=this.get("title"),g=this.get("priority");if(!h&&i){h={text:i};if(g){h.priority=g}}if(!h){return}f.set(this.id,h)}});_.each(["toolbar","content"],function(f){a.prototype["_"+f]=function(){var g=this.get(f);if(g){this.frame[f].render(g)}}});d.exports=a},{}],18:[function(b,c,a){var d={syncSelection:function(){var g=this.get("selection"),f=this.frame._selection;if(!this.get("syncSelection")||!f||!g){return}if(g.multiple){g.reset([],{silent:true});g.validateAll(f.attachments);f.difference=_.difference(f.attachments.models,g.models)}g.single(f.single)},recordSelection:function(){var g=this.get("selection"),f=this.frame._selection;if(!this.get("syncSelection")||!f||!g){return}if(g.multiple){f.attachments.reset(g.toArray().concat(f.difference));f.difference=[]}else{f.attachments.add(g.toArray())}f.single=g._single}};c.exports=d},{}],19:[function(b,d,a){var g=wp.media,f=jQuery,c;g.isTouchDevice=("ontouchend" in document);c=g.view.l10n=window._wpMediaViewsL10n||{};g.view.settings=c.settings||{};delete c.settings;g.model.settings.post=g.view.settings.post;f.support.transition=(function(){var h=document.documentElement.style,i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},j;j=_.find(_.keys(i),function(k){return !_.isUndefined(h[k])});return j&&{end:i[j]}}());g.events=_.extend({},Backbone.Events);g.transition=function(h,i){var j=f.Deferred();i=i||2000;if(f.support.transition){if(!(h instanceof f)){h=f(h)}h.first().one(f.support.transition.end,j.resolve);_.delay(j.resolve,i)}else{j.resolve()}return j.promise()};g.controller.Region=b("./controllers/region.js");g.controller.StateMachine=b("./controllers/state-machine.js");g.controller.State=b("./controllers/state.js");g.selectionSync=b("./utils/selection-sync.js");g.controller.Library=b("./controllers/library.js");g.controller.ImageDetails=b("./controllers/image-details.js");g.controller.GalleryEdit=b("./controllers/gallery-edit.js");g.controller.GalleryAdd=b("./controllers/gallery-add.js");g.controller.CollectionEdit=b("./controllers/collection-edit.js");g.controller.CollectionAdd=b("./controllers/collection-add.js");g.controller.FeaturedImage=b("./controllers/featured-image.js");g.controller.ReplaceImage=b("./controllers/replace-image.js");g.controller.EditImage=b("./controllers/edit-image.js");g.controller.MediaLibrary=b("./controllers/media-library.js");g.controller.Embed=b("./controllers/embed.js");g.controller.Cropper=b("./controllers/cropper.js");g.controller.CustomizeImageCropper=b("./controllers/customize-image-cropper.js");g.controller.SiteIconCropper=b("./controllers/site-icon-cropper.js");g.View=b("./views/view.js");g.view.Frame=b("./views/frame.js");g.view.MediaFrame=b("./views/media-frame.js");g.view.MediaFrame.Select=b("./views/frame/select.js");g.view.MediaFrame.Post=b("./views/frame/post.js");g.view.MediaFrame.ImageDetails=b("./views/frame/image-details.js");g.view.Modal=b("./views/modal.js");g.view.FocusManager=b("./views/focus-manager.js");g.view.UploaderWindow=b("./views/uploader/window.js");g.view.EditorUploader=b("./views/uploader/editor.js");g.view.UploaderInline=b("./views/uploader/inline.js");g.view.UploaderStatus=b("./views/uploader/status.js");g.view.UploaderStatusError=b("./views/uploader/status-error.js");g.view.Toolbar=b("./views/toolbar.js");g.view.Toolbar.Select=b("./views/toolbar/select.js");g.view.Toolbar.Embed=b("./views/toolbar/embed.js");g.view.Button=b("./views/button.js");g.view.ButtonGroup=b("./views/button-group.js");g.view.PriorityList=b("./views/priority-list.js");g.view.MenuItem=b("./views/menu-item.js");g.view.Menu=b("./views/menu.js");g.view.RouterItem=b("./views/router-item.js");g.view.Router=b("./views/router.js");g.view.Sidebar=b("./views/sidebar.js");g.view.Attachment=b("./views/attachment.js");g.view.Attachment.Library=b("./views/attachment/library.js");g.view.Attachment.EditLibrary=b("./views/attachment/edit-library.js");g.view.Attachments=b("./views/attachments.js");g.view.Search=b("./views/search.js");g.view.AttachmentFilters=b("./views/attachment-filters.js");g.view.DateFilter=b("./views/attachment-filters/date.js");g.view.AttachmentFilters.Uploaded=b("./views/attachment-filters/uploaded.js");g.view.AttachmentFilters.All=b("./views/attachment-filters/all.js");g.view.AttachmentsBrowser=b("./views/attachments/browser.js");g.view.Selection=b("./views/selection.js");g.view.Attachment.Selection=b("./views/attachment/selection.js");g.view.Attachments.Selection=b("./views/attachments/selection.js");g.view.Attachment.EditSelection=b("./views/attachment/edit-selection.js");g.view.Settings=b("./views/settings.js");g.view.Settings.AttachmentDisplay=b("./views/settings/attachment-display.js");g.view.Settings.Gallery=b("./views/settings/gallery.js");g.view.Settings.Playlist=b("./views/settings/playlist.js");g.view.Attachment.Details=b("./views/attachment/details.js");g.view.AttachmentCompat=b("./views/attachment-compat.js");g.view.Iframe=b("./views/iframe.js");g.view.Embed=b("./views/embed.js");g.view.Label=b("./views/label.js");g.view.EmbedUrl=b("./views/embed/url.js");g.view.EmbedLink=b("./views/embed/link.js");g.view.EmbedImage=b("./views/embed/image.js");g.view.ImageDetails=b("./views/image-details.js");g.view.Cropper=b("./views/cropper.js");g.view.SiteIconCropper=b("./views/site-icon-cropper.js");g.view.SiteIconPreview=b("./views/site-icon-preview.js");g.view.EditImage=b("./views/edit-image.js");g.view.Spinner=b("./views/spinner.js")},{"./controllers/collection-add.js":1,"./controllers/collection-edit.js":2,"./controllers/cropper.js":3,"./controllers/customize-image-cropper.js":4,"./controllers/edit-image.js":5,"./controllers/embed.js":6,"./controllers/featured-image.js":7,"./controllers/gallery-add.js":8,"./controllers/gallery-edit.js":9,"./controllers/image-details.js":10,"./controllers/library.js":11,"./controllers/media-library.js":12,"./controllers/region.js":13,"./controllers/replace-image.js":14,"./controllers/site-icon-cropper.js":15,"./controllers/state-machine.js":16,"./controllers/state.js":17,"./utils/selection-sync.js":18,"./views/attachment-compat.js":20,"./views/attachment-filters.js":21,"./views/attachment-filters/all.js":22,"./views/attachment-filters/date.js":23,"./views/attachment-filters/uploaded.js":24,"./views/attachment.js":25,"./views/attachment/details.js":26,"./views/attachment/edit-library.js":27,"./views/attachment/edit-selection.js":28,"./views/attachment/library.js":29,"./views/attachment/selection.js":30,"./views/attachments.js":31,"./views/attachments/browser.js":32,"./views/attachments/selection.js":33,"./views/button-group.js":34,"./views/button.js":35,"./views/cropper.js":36,"./views/edit-image.js":37,"./views/embed.js":38,"./views/embed/image.js":39,"./views/embed/link.js":40,"./views/embed/url.js":41,"./views/focus-manager.js":42,"./views/frame.js":43,"./views/frame/image-details.js":44,"./views/frame/post.js":45,"./views/frame/select.js":46,"./views/iframe.js":47,"./views/image-details.js":48,"./views/label.js":49,"./views/media-frame.js":50,"./views/menu-item.js":51,"./views/menu.js":52,"./views/modal.js":53,"./views/priority-list.js":54,"./views/router-item.js":55,"./views/router.js":56,"./views/search.js":57,"./views/selection.js":58,"./views/settings.js":59,"./views/settings/attachment-display.js":60,"./views/settings/gallery.js":61,"./views/settings/playlist.js":62,"./views/sidebar.js":63,"./views/site-icon-cropper.js":64,"./views/site-icon-preview.js":65,"./views/spinner.js":66,"./views/toolbar.js":67,"./views/toolbar/embed.js":68,"./views/toolbar/select.js":69,"./views/uploader/editor.js":70,"./views/uploader/inline.js":71,"./views/uploader/status-error.js":72,"./views/uploader/status.js":73,"./views/uploader/window.js":74,"./views/view.js":75}],20:[function(c,d,b){var f=wp.media.View,a;a=f.extend({tagName:"form",className:"compat-item",events:{submit:"preventDefault","change input":"save","change select":"save","change textarea":"save"},initialize:function(){this.listenTo(this.model,"change:compat",this.render)},dispose:function(){if(this.$(":focus").length){this.save()}return f.prototype.dispose.apply(this,arguments)},render:function(){var g=this.model.get("compat");if(!g||!g.item){return}this.views.detach();this.$el.html(g.item);this.views.render();return this},preventDefault:function(g){g.preventDefault()},save:function(g){var h={};if(g){g.preventDefault()}_.each(this.$el.serializeArray(),function(i){h[i.name]=i.value});this.controller.trigger("attachment:compat:waiting",["waiting"]);this.model.saveCompat(h).always(_.bind(this.postSave,this))},postSave:function(){this.controller.trigger("attachment:compat:ready",["ready"])}});d.exports=a},{}],21:[function(b,c,a){var f=jQuery,d;d=wp.media.View.extend({tagName:"select",className:"attachment-filters",id:"media-attachment-filters",events:{change:"change"},keys:[],initialize:function(){this.createFilters();_.extend(this.filters,this.options.filters);this.$el.html(_.chain(this.filters).map(function(g,h){return{el:f("<option></option>").val(h).html(g.text)[0],priority:g.priority||50}},this).sortBy("priority").pluck("el").value());this.listenTo(this.model,"change",this.select);this.select()},createFilters:function(){this.filters={}},change:function(){var g=this.filters[this.el.value];if(g){this.model.set(g.props)}},select:function(){var g=this.model,i="all",h=g.toJSON();_.find(this.filters,function(k,l){var j=_.all(k.props,function(n,m){return n===(_.isUndefined(h[m])?null:h[m])});if(j){return i=l}});this.$el.val(i)}});c.exports=d},{}],22:[function(c,f,b){var d=wp.media.view.l10n,a;a=wp.media.view.AttachmentFilters.extend({createFilters:function(){var g={};_.each(wp.media.view.settings.mimeTypes||{},function(i,h){g[h]={text:i,props:{status:null,type:h,uploadedTo:null,orderby:"date",order:"DESC"}}});g.all={text:d.allMediaItems,props:{status:null,type:null,uploadedTo:null,orderby:"date",order:"DESC"},priority:10};if(wp.media.view.settings.post.id){g.uploaded={text:d.uploadedToThisPost,props:{status:null,type:null,uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20}}g.unattached={text:d.unattached,props:{status:null,uploadedTo:0,type:null,orderby:"menuOrder",order:"ASC"},priority:50};if(wp.media.view.settings.mediaTrash&&this.controller.isModeActive("grid")){g.trash={text:d.trash,props:{uploadedTo:null,status:"trash",type:null,orderby:"date",order:"DESC"},priority:50}}this.filters=g}});f.exports=a},{}],23:[function(c,f,b){var d=wp.media.view.l10n,a;a=wp.media.view.AttachmentFilters.extend({id:"media-attachment-date-filters",createFilters:function(){var g={};_.each(wp.media.view.settings.months||{},function(i,h){g[h]={text:i.text,props:{year:i.year,monthnum:i.month}}});g.all={text:d.allDates,props:{monthnum:false,year:false},priority:10};this.filters=g}});f.exports=a},{}],24:[function(c,f,b){var d=wp.media.view.l10n,a;a=wp.media.view.AttachmentFilters.extend({createFilters:function(){var h=this.model.get("type"),g=wp.media.view.settings.mimeTypes,i;if(g&&h){i=g[h]}this.filters={all:{text:i||d.allMediaItems,props:{uploadedTo:null,orderby:"date",order:"DESC"},priority:10},uploaded:{text:d.uploadedToThisPost,props:{uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20},unattached:{text:d.unattached,props:{uploadedTo:0,orderby:"menuOrder",order:"ASC"},priority:50}}}});f.exports=a},{}],25:[function(b,c,a){var g=wp.media.View,f=jQuery,d;d=g.extend({tagName:"li",className:"attachment",template:wp.template("attachment"),attributes:function(){return{tabIndex:0,role:"checkbox","aria-label":this.model.get("title"),"aria-checked":false,"data-id":this.model.get("id")}},events:{"click .js--select-attachment":"toggleSelectionHandler","change [data-setting]":"updateSetting","change [data-setting] input":"updateSetting","change [data-setting] select":"updateSetting","change [data-setting] textarea":"updateSetting","click .attachment-close":"removeFromLibrary","click .check":"checkClickHandler",keydown:"toggleSelectionHandler"},buttons:{},initialize:function(){var i=this.options.selection,h=_.defaults(this.options,{rerenderOnModelChange:true});if(h.rerenderOnModelChange){this.listenTo(this.model,"change",this.render)}else{this.listenTo(this.model,"change:percent",this.progress)}this.listenTo(this.model,"change:title",this._syncTitle);this.listenTo(this.model,"change:caption",this._syncCaption);this.listenTo(this.model,"change:artist",this._syncArtist);this.listenTo(this.model,"change:album",this._syncAlbum);this.listenTo(this.model,"add",this.select);this.listenTo(this.model,"remove",this.deselect);if(i){i.on("reset",this.updateSelect,this);this.listenTo(this.model,"selection:single selection:unsingle",this.details);this.details(this.model,this.controller.state().get("selection"))}this.listenTo(this.controller,"attachment:compat:waiting attachment:compat:ready",this.updateSave)},dispose:function(){var h=this.options.selection;this.updateAll();if(h){h.off(null,null,this)}g.prototype.dispose.apply(this,arguments);return this},render:function(){var h=_.defaults(this.model.toJSON(),{orientation:"landscape",uploading:false,type:"",subtype:"",icon:"",filename:"",caption:"",title:"",dateFormatted:"",width:"",height:"",compat:false,alt:"",description:""},this.options);h.buttons=this.buttons;h.describe=this.controller.state().get("describe");if("image"===h.type){h.size=this.imageSize()}h.can={};if(h.nonces){h.can.remove=!!h.nonces["delete"];h.can.save=!!h.nonces.update}if(this.controller.state().get("allowLocalEdits")){h.allowLocalEdits=true}if(h.uploading&&!h.percent){h.percent=0}this.views.detach();this.$el.html(this.template(h));this.$el.toggleClass("uploading",h.uploading);if(h.uploading){this.$bar=this.$(".media-progress-bar div")}else{delete this.$bar}this.updateSelect();this.updateSave();this.views.render();return this},progress:function(){if(this.$bar&&this.$bar.length){this.$bar.width(this.model.get("percent")+"%")}},toggleSelectionHandler:function(h){var i;if("INPUT"===h.target.nodeName||"BUTTON"===h.target.nodeName){return}if(37===h.keyCode||38===h.keyCode||39===h.keyCode||40===h.keyCode){this.controller.trigger("attachment:keydown:arrow",h);return}if("keydown"===h.type&&13!==h.keyCode&&32!==h.keyCode){return}h.preventDefault();if(this.controller.isModeActive("grid")){if(this.controller.isModeActive("edit")){this.controller.trigger("edit:attachment",this.model,h.currentTarget);return}if(this.controller.isModeActive("select")){i="toggle"}}if(h.shiftKey){i="between"}else{if(h.ctrlKey||h.metaKey){i="toggle"}}this.toggleSelection({method:i});this.controller.trigger("selection:toggle")},toggleSelection:function(p){var l=this.collection,m=this.options.selection,k=this.model,h=p&&p.method,n,i,j,o;if(!m){return}n=m.single();h=_.isUndefined(h)?m.multiple:h;if("between"===h&&n&&m.multiple){if(n===k){return}j=l.indexOf(n);o=l.indexOf(this.model);if(j<o){i=l.models.slice(j,o+1)}else{i=l.models.slice(o,j+1)}m.add(i);m.single(k);return}else{if("toggle"===h){m[this.selected()?"remove":"add"](k);m.single(k);return}else{if("add"===h){m.add(k);m.single(k);return}}}if(!h){h="add"}if(h!=="add"){h="reset"}if(this.selected()){m[n===k?"remove":"single"](k)}else{m[h](k);m.single(k)}},updateSelect:function(){this[this.selected()?"select":"deselect"]()},selected:function(){var h=this.options.selection;if(h){return !!h.get(this.model.cid)}},select:function(i,k){var j=this.options.selection,h=this.controller;if(!j||(k&&k!==j)){return}if(this.$el.hasClass("selected")){return}this.$el.addClass("selected").attr("aria-checked",true);if(!(h.isModeActive("grid")&&h.isModeActive("select"))){this.$(".check").attr("tabindex","0")}},deselect:function(h,j){var i=this.options.selection;if(!i||(j&&j!==i)){return}this.$el.removeClass("selected").attr("aria-checked",false).find(".check").attr("tabindex","-1")},details:function(h,k){var j=this.options.selection,i;if(j!==k){return}i=j.single();this.$el.toggleClass("details",i===this.model)},imageSize:function(i){var j=this.model.get("sizes"),h=false;i=i||"medium";if(j){if(j[i]){h=j[i]}else{if(j.large){h=j.large}else{if(j.thumbnail){h=j.thumbnail}else{if(j.full){h=j.full}}}}if(h){return _.clone(h)}}return{url:this.model.get("url"),width:this.model.get("width"),height:this.model.get("height"),orientation:this.model.get("orientation")}},updateSetting:function(j){var h=f(j.target).closest("[data-setting]"),i,k;if(!h.length){return}i=h.data("setting");k=j.target.value;if(this.model.get(i)!==k){this.save(i,k)}},save:function(){var h=this,j=this._save=this._save||{status:"ready"},i=this.model.save.apply(this.model,arguments),k=j.requests?f.when(i,j.requests):i;if(j.savedTimer){clearTimeout(j.savedTimer)}this.updateSave("waiting");j.requests=k;k.always(function(){if(j.requests!==k){return}h.updateSave(k.state()==="resolved"?"complete":"error");j.savedTimer=setTimeout(function(){h.updateSave("ready");delete j.savedTimer},2000)})},updateSave:function(h){var i=this._save=this._save||{status:"ready"};if(h&&h!==i.status){this.$el.removeClass("save-"+i.status);i.status=h}this.$el.addClass("save-"+i.status);return this},updateAll:function(){var i=this.$("[data-setting]"),h=this.model,j;j=_.chain(i).map(function(l){var n=f("input, textarea, select, [value]",l),k,m;if(!n.length){return}k=f(l).data("setting");m=n.val();if(h.get(k)!==m){return[k,m]}}).compact().object().value();if(!_.isEmpty(j)){h.save(j)}},removeFromLibrary:function(h){if("keydown"===h.type&&13!==h.keyCode&&32!==h.keyCode){return}h.stopPropagation();this.collection.remove(this.model)},checkClickHandler:function(i){var h=this.options.selection;if(!h){return}i.stopPropagation();if(h.where({id:this.model.get("id")}).length){h.remove(this.model);this.$el.focus()}else{h.add(this.model)}}});_.each({caption:"_syncCaption",title:"_syncTitle",artist:"_syncArtist",album:"_syncAlbum"},function(i,h){d.prototype[i]=function(j,l){var k=this.$('[data-setting="'+h+'"]');if(!k.length){return this}if(l===k.find("input, textarea, select, [value]").val()){return this}return this.render()}});c.exports=d},{}],26:[function(c,f,b){var g=wp.media.view.Attachment,d=wp.media.view.l10n,a;a=g.extend({tagName:"div",className:"attachment-details",template:wp.template("attachment-details"),attributes:function(){return{tabIndex:0,"data-id":this.model.get("id")}},events:{"change [data-setting]":"updateSetting","change [data-setting] input":"updateSetting","change [data-setting] select":"updateSetting","change [data-setting] textarea":"updateSetting","click .delete-attachment":"deleteAttachment","click .trash-attachment":"trashAttachment","click .untrash-attachment":"untrashAttachment","click .edit-attachment":"editAttachment",keydown:"toggleSelectionHandler"},initialize:function(){this.options=_.defaults(this.options,{rerenderOnModelChange:false});this.on("ready",this.initialFocus);g.prototype.initialize.apply(this,arguments)},initialFocus:function(){if(!wp.media.isTouchDevice){this.$('input[type="text"]').eq(0).focus()}},deleteAttachment:function(h){h.preventDefault();if(window.confirm(d.warnDelete)){this.model.destroy();this.controller.modal.focusManager.focus()}},trashAttachment:function(i){var h=this.controller.library;i.preventDefault();if(wp.media.view.settings.mediaTrash&&"edit-metadata"===this.controller.content.mode()){this.model.set("status","trash");this.model.save().done(function(){h._requery(true)})}else{this.model.destroy()}},untrashAttachment:function(i){var h=this.controller.library;i.preventDefault();this.model.set("status","inherit");this.model.save().done(function(){h._requery(true)})},editAttachment:function(i){var h=this.controller.states.get("edit-image");if(window.imageEdit&&h){i.preventDefault();h.set("image",this.model);this.controller.setState("edit-image")}else{this.$el.addClass("needs-refresh")}},toggleSelectionHandler:function(h){if("keydown"===h.type&&9===h.keyCode&&h.shiftKey&&h.target===this.$(":tabbable").get(0)){this.controller.trigger("attachment:details:shift-tab",h);return false}if(37===h.keyCode||38===h.keyCode||39===h.keyCode||40===h.keyCode){this.controller.trigger("attachment:keydown:arrow",h);return}}});f.exports=a},{}],27:[function(b,c,a){var d=wp.media.view.Attachment.extend({buttons:{close:true}});c.exports=d},{}],28:[function(b,c,a){var d=wp.media.view.Attachment.Selection.extend({buttons:{close:true}});c.exports=d},{}],29:[function(b,c,a){var d=wp.media.view.Attachment.extend({buttons:{check:true}});c.exports=d},{}],30:[function(b,c,a){var d=wp.media.view.Attachment.extend({className:"attachment selection",toggleSelection:function(){this.options.selection.single(this.model)}});c.exports=d},{}],31:[function(b,d,a){var g=wp.media.View,f=jQuery,c;c=g.extend({tagName:"ul",className:"attachments",attributes:{tabIndex:-1},initialize:function(){this.el.id=_.uniqueId("__attachments-view-");_.defaults(this.options,{refreshSensitivity:wp.media.isTouchDevice?300:200,refreshThreshold:3,AttachmentView:wp.media.view.Attachment,sortable:false,resize:true,idealColumnWidth:f(window).width()<640?135:150});this._viewsByCid={};this.$window=f(window);this.resizeEvent="resize.media-modal-columns";this.collection.on("add",function(h){this.views.add(this.createAttachmentView(h),{at:this.collection.indexOf(h)})},this);this.collection.on("remove",function(i){var h=this._viewsByCid[i.cid];delete this._viewsByCid[i.cid];if(h){h.remove()}},this);this.collection.on("reset",this.render,this);this.listenTo(this.controller,"library:selection:add",this.attachmentFocus);this.scroll=_.chain(this.scroll).bind(this).throttle(this.options.refreshSensitivity).value();this.options.scrollElement=this.options.scrollElement||this.el;f(this.options.scrollElement).on("scroll",this.scroll);this.initSortable();_.bindAll(this,"setColumns");if(this.options.resize){this.on("ready",this.bindEvents);this.controller.on("open",this.setColumns);_.defer(this.setColumns,this)}},bindEvents:function(){this.$window.off(this.resizeEvent).on(this.resizeEvent,_.debounce(this.setColumns,50))},attachmentFocus:function(){this.$("li:first").focus()},restoreFocus:function(){this.$("li.selected:first").focus()},arrowEvent:function(k){var h=this.$el.children("li"),j=this.columns,i=h.filter(":focus").index(),l=(i+1)<=j?1:Math.ceil((i+1)/j);if(i===-1){return}if(37===k.keyCode){if(0===i){return}h.eq(i-1).focus()}if(38===k.keyCode){if(1===l){return}h.eq(i-j).focus()}if(39===k.keyCode){if(h.length===i){return}h.eq(i+1).focus()}if(40===k.keyCode){if(Math.ceil(h.length/j)===l){return}h.eq(i+j).focus()}},dispose:function(){this.collection.props.off(null,null,this);if(this.options.resize){this.$window.off(this.resizeEvent)}g.prototype.dispose.apply(this,arguments)},setColumns:function(){var i=this.columns,h=this.$el.width();if(h){this.columns=Math.min(Math.round(h/this.options.idealColumnWidth),12)||1;if(!i||i!==this.columns){this.$el.closest(".media-frame-content").attr("data-columns",this.columns)}}},initSortable:function(){var h=this.collection;if(!this.options.sortable||!f.fn.sortable){return}this.$el.sortable(_.extend({disabled:!!h.comparator,tolerance:"pointer",start:function(i,j){j.item.data("sortableIndexStart",j.item.index())},update:function(k,l){var j=h.at(l.item.data("sortableIndexStart")),i=h.comparator;delete h.comparator;h.remove(j,{silent:true});h.add(j,{silent:true,at:l.item.index()});h.comparator=i;h.trigger("reset",h);h.saveMenuOrder()}},this.options.sortable));h.props.on("change:orderby",function(){this.$el.sortable("option","disabled",!!h.comparator)},this);this.collection.props.on("change:orderby",this.refreshSortable,this);this.refreshSortable()},refreshSortable:function(){if(!this.options.sortable||!f.fn.sortable){return}var j=this.collection,i=j.props.get("orderby"),h="menuOrder"===i||!j.comparator;this.$el.sortable("option","disabled",!h)},createAttachmentView:function(i){var h=new this.options.AttachmentView({controller:this.controller,model:i,collection:this.collection,selection:this.options.selection});return this._viewsByCid[i.cid]=h},prepare:function(){if(this.collection.length){this.views.set(this.collection.map(this.createAttachmentView,this))}else{this.views.unset();this.collection.more().done(this.scroll)}},ready:function(){this.scroll()},scroll:function(){var h=this,i=this.options.scrollElement,k=i.scrollTop,j;if(i===document){i=document.body;k=f(document).scrollTop()}if(!f(i).is(":visible")||!this.collection.hasMore()){return}j=this.views.parent.toolbar;if(i.scrollHeight-(k+i.clientHeight)<i.clientHeight/3){j.get("spinner").show()}if(i.scrollHeight<k+(i.clientHeight*this.options.refreshThreshold)){this.collection.more().done(function(){h.scroll();j.get("spinner").hide()})}}});d.exports=c},{}],32:[function(b,d,a){var i=wp.media.View,g=wp.media.view.settings.mediaTrash,c=wp.media.view.l10n,h=jQuery,f;f=i.extend({tagName:"div",className:"attachments-browser",initialize:function(){_.defaults(this.options,{filters:false,search:true,date:true,display:false,sidebar:true,AttachmentView:wp.media.view.Attachment.Library});this.controller.on("toggle:upload:attachment",this.toggleUploader,this);this.controller.on("edit:selection",this.editSelection);this.createToolbar();if(this.options.sidebar&&"errors"===this.options.sidebar){this.createSidebar()}this.createUploader();this.createAttachments();if(this.options.sidebar&&"errors"!==this.options.sidebar){this.createSidebar()}this.updateContent();if(!this.options.sidebar||"errors"===this.options.sidebar){this.$el.addClass("hide-sidebar");if("errors"===this.options.sidebar){this.$el.addClass("sidebar-for-errors")}}this.collection.on("add remove reset",this.updateContent,this)},editSelection:function(j){j.$(".media-button-backToLibrary").focus()},dispose:function(){this.options.selection.off(null,null,this);i.prototype.dispose.apply(this,arguments);return this},createToolbar:function(){var j,k,l;l={controller:this.controller};if(this.controller.isModeActive("grid")){l.className="media-toolbar wp-filter"}this.toolbar=new wp.media.view.Toolbar(l);this.views.add(this.toolbar);this.toolbar.set("spinner",new wp.media.view.Spinner({priority:-60}));if(-1!==h.inArray(this.options.filters,["uploaded","all"])){this.toolbar.set("filtersLabel",new wp.media.view.Label({value:c.filterByType,attributes:{"for":"media-attachment-filters"},priority:-80}).render());if("uploaded"===this.options.filters){this.toolbar.set("filters",new wp.media.view.AttachmentFilters.Uploaded({controller:this.controller,model:this.collection.props,priority:-80}).render())}else{k=new wp.media.view.AttachmentFilters.All({controller:this.controller,model:this.collection.props,priority:-80});this.toolbar.set("filters",k.render())}}if(this.controller.isModeActive("grid")){j=i.extend({className:"view-switch media-grid-view-switch",template:wp.template("media-library-view-switcher")});this.toolbar.set("libraryViewSwitcher",new j({controller:this.controller,priority:-90}).render());this.toolbar.set("dateFilterLabel",new wp.media.view.Label({value:c.filterByDate,attributes:{"for":"media-attachment-date-filters"},priority:-75}).render());this.toolbar.set("dateFilter",new wp.media.view.DateFilter({controller:this.controller,model:this.collection.props,priority:-75}).render());this.toolbar.set("selectModeToggleButton",new wp.media.view.SelectModeToggleButton({text:c.bulkSelect,controller:this.controller,priority:-70}).render());this.toolbar.set("deleteSelectedButton",new wp.media.view.DeleteSelectedButton({filters:k,style:"primary",disabled:true,text:g?c.trashSelected:c.deleteSelected,controller:this.controller,priority:-60,click:function(){var p=[],o=[],n=this.controller.state().get("selection"),m=this.controller.state().get("library");if(!n.length){return}if(!g&&!window.confirm(c.warnBulkDelete)){return}if(g&&"trash"!==n.at(0).get("status")&&!window.confirm(c.warnBulkTrash)){return}n.each(function(q){if(!q.get("nonces")["delete"]){o.push(q);return}if(g&&"trash"===q.get("status")){q.set("status","inherit");p.push(q.save());o.push(q)}else{if(g){q.set("status","trash");p.push(q.save());o.push(q)}else{q.destroy({wait:true})}}});if(p.length){n.remove(o);h.when.apply(null,p).then(_.bind(function(){m._requery(true);this.controller.trigger("selection:action:done")},this))}else{this.controller.trigger("selection:action:done")}}}).render());if(g){this.toolbar.set("deleteSelectedPermanentlyButton",new wp.media.view.DeleteSelectedPermanentlyButton({filters:k,style:"primary",disabled:true,text:c.deleteSelected,controller:this.controller,priority:-55,click:function(){var n=[],m=this.controller.state().get("selection");if(!m.length||!window.confirm(c.warnBulkDelete)){return}m.each(function(o){if(!o.get("nonces")["delete"]){n.push(o);return}o.destroy()});m.remove(n);this.controller.trigger("selection:action:done")}}).render())}}else{if(this.options.date){this.toolbar.set("dateFilterLabel",new wp.media.view.Label({value:c.filterByDate,attributes:{"for":"media-attachment-date-filters"},priority:-75}).render());this.toolbar.set("dateFilter",new wp.media.view.DateFilter({controller:this.controller,model:this.collection.props,priority:-75}).render())}}if(this.options.search){this.toolbar.set("searchLabel",new wp.media.view.Label({value:c.searchMediaLabel,attributes:{"for":"media-search-input"},priority:60}).render());this.toolbar.set("search",new wp.media.view.Search({controller:this.controller,model:this.collection.props,priority:60}).render())}if(this.options.dragInfo){this.toolbar.set("dragInfo",new i({el:h('<div class="instructions">'+c.dragInfo+"</div>")[0],priority:-40}))}if(this.options.suggestedWidth&&this.options.suggestedHeight){this.toolbar.set("suggestedDimensions",new i({el:h('<div class="instructions">'+c.suggestedDimensions+" "+this.options.suggestedWidth+" &times; "+this.options.suggestedHeight+"</div>")[0],priority:-40}))}},updateContent:function(){var j=this,k;if(this.controller.isModeActive("grid")){k=j.attachmentsNoResults}else{k=j.uploader}if(!this.collection.length){this.toolbar.get("spinner").show();this.dfd=this.collection.more().done(function(){if(!j.collection.length){k.$el.removeClass("hidden")}else{k.$el.addClass("hidden")}j.toolbar.get("spinner").hide()})}else{k.$el.addClass("hidden");j.toolbar.get("spinner").hide()}},createUploader:function(){this.uploader=new wp.media.view.UploaderInline({controller:this.controller,status:false,message:this.controller.isModeActive("grid")?"":c.noItemsFound,canClose:this.controller.isModeActive("grid")});this.uploader.hide();this.views.add(this.uploader)},toggleUploader:function(){if(this.uploader.$el.hasClass("hidden")){this.uploader.show()}else{this.uploader.hide()}},createAttachments:function(){this.attachments=new wp.media.view.Attachments({controller:this.controller,collection:this.collection,selection:this.options.selection,model:this.model,sortable:this.options.sortable,scrollElement:this.options.scrollElement,idealColumnWidth:this.options.idealColumnWidth,AttachmentView:this.options.AttachmentView});this.controller.on("attachment:keydown:arrow",_.bind(this.attachments.arrowEvent,this.attachments));this.controller.on("attachment:details:shift-tab",_.bind(this.attachments.restoreFocus,this.attachments));this.views.add(this.attachments);if(this.controller.isModeActive("grid")){this.attachmentsNoResults=new i({controller:this.controller,tagName:"p"});this.attachmentsNoResults.$el.addClass("hidden no-media");this.attachmentsNoResults.$el.html(c.noMedia);this.views.add(this.attachmentsNoResults)}},createSidebar:function(){var j=this.options,k=j.selection,l=this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.views.add(l);if(this.controller.uploader){l.set("uploads",new wp.media.view.UploaderStatus({controller:this.controller,priority:40}))}k.on("selection:single",this.createSingle,this);k.on("selection:unsingle",this.disposeSingle,this);if(k.single()){this.createSingle()}},createSingle:function(){var j=this.sidebar,k=this.options.selection.single();j.set("details",new wp.media.view.Attachment.Details({controller:this.controller,model:k,priority:80}));j.set("compat",new wp.media.view.AttachmentCompat({controller:this.controller,model:k,priority:120}));if(this.options.display){j.set("display",new wp.media.view.Settings.AttachmentDisplay({controller:this.controller,model:this.model.display(k),attachment:k,priority:160,userSettings:this.model.get("displayUserSettings")}))}if(this.model.id==="insert"){j.$el.addClass("visible")}},disposeSingle:function(){var j=this.sidebar;j.unset("details");j.unset("compat");j.unset("display");j.$el.removeClass("visible")}});d.exports=f},{}],33:[function(b,d,a){var c=wp.media.view.Attachments,f;f=c.extend({events:{},initialize:function(){_.defaults(this.options,{sortable:false,resize:false,AttachmentView:wp.media.view.Attachment.Selection});return c.prototype.initialize.apply(this,arguments)}});d.exports=f},{}],34:[function(b,d,a){var f=Backbone.$,c;c=wp.media.View.extend({tagName:"div",className:"button-group button-large media-button-group",initialize:function(){this.buttons=_.map(this.options.buttons||[],function(g){if(g instanceof Backbone.View){return g}else{return new wp.media.view.Button(g).render()}});delete this.options.buttons;if(this.options.classes){this.$el.addClass(this.options.classes)}},render:function(){this.$el.html(f(_.pluck(this.buttons,"el")).detach());return this}});d.exports=c},{}],35:[function(c,d,b){var a=wp.media.View.extend({tagName:"button",className:"media-button",attributes:{type:"button"},events:{click:"click"},defaults:{text:"",style:"",size:"large",disabled:false},initialize:function(){this.model=new Backbone.Model(this.defaults);_.each(this.defaults,function(h,f){var g=this.options[f];if(_.isUndefined(g)){return}this.model.set(f,g);delete this.options[f]},this);this.listenTo(this.model,"change",this.render)},render:function(){var g=["button",this.className],f=this.model.toJSON();if(f.style){g.push("button-"+f.style)}if(f.size){g.push("button-"+f.size)}g=_.uniq(g.concat(this.options.classes));this.el.className=g.join(" ");this.$el.attr("disabled",f.disabled);this.$el.text(this.model.get("text"));return this},click:function(f){if("#"===this.attributes.href){f.preventDefault()}if(this.options.click&&!this.model.get("disabled")){this.options.click.apply(this,arguments)}}});d.exports=a},{}],36:[function(c,f,a){var i=wp.media.View,h=wp.media.view.UploaderStatus,d=wp.media.view.l10n,g=jQuery,b;b=i.extend({className:"crop-content",template:wp.template("crop-content"),initialize:function(){_.bindAll(this,"onImageLoad")},ready:function(){this.controller.frame.on("content:error:crop",this.onError,this);this.$image=this.$el.find(".crop-image");this.$image.on("load",this.onImageLoad);g(window).on("resize.cropper",_.debounce(this.onImageLoad,250))},remove:function(){g(window).off("resize.cropper");this.$el.remove();this.$el.off();i.prototype.remove.apply(this,arguments)},prepare:function(){return{title:d.cropYourImage,url:this.options.attachment.get("url")}},onImageLoad:function(){var j=this.controller.get("imgSelectOptions");if(typeof j==="function"){j=j(this.options.attachment,this.controller)}j=_.extend(j,{parent:this.$el});this.trigger("image-loaded");this.controller.imgSelect=this.$image.imgAreaSelect(j)},onError:function(){var j=this.options.attachment.get("filename");this.views.add(".upload-errors",new wp.media.view.UploaderStatusError({filename:h.prototype.filename(j),message:window._wpMediaViewsL10n.cropError}),{at:0})}});f.exports=b},{}],37:[function(c,d,a){var f=wp.media.View,b;b=f.extend({className:"image-editor",template:wp.template("image-editor"),initialize:function(g){this.editor=window.imageEdit;this.controller=g.controller;f.prototype.initialize.apply(this,arguments)},prepare:function(){return this.model.toJSON()},loadEditor:function(){var g=this.editor.open(this.model.get("id"),this.model.get("nonces").edit,this);g.done(_.bind(this.focus,this))},focus:function(){this.$(".imgedit-submit .button").eq(0).focus()},back:function(){var g=this.controller.lastState();this.controller.setState(g)},refresh:function(){this.model.fetch()},save:function(){var g=this.controller.lastState();this.model.fetch().done(_.bind(function(){this.controller.setState(g)},this))}});d.exports=b},{}],38:[function(b,c,a){var d=wp.media.View.extend({className:"media-embed",initialize:function(){this.url=new wp.media.view.EmbedUrl({controller:this.controller,model:this.model.props}).render();this.views.set([this.url]);this.refresh();this.listenTo(this.model,"change:type",this.refresh);this.listenTo(this.model,"change:loading",this.loading)},settings:function(f){if(this._settings){this._settings.remove()}this._settings=f;this.views.add(f)},refresh:function(){var g=this.model.get("type"),f;if("image"===g){f=wp.media.view.EmbedImage}else{if("link"===g){f=wp.media.view.EmbedLink}else{return}}this.settings(new f({controller:this.controller,model:this.model.props,priority:40}))},loading:function(){this.$el.toggleClass("embed-loading",this.model.get("loading"))}});c.exports=d},{}],39:[function(c,d,a){var f=wp.media.view.Settings.AttachmentDisplay,b;b=f.extend({className:"embed-media-settings",template:wp.template("embed-image-settings"),initialize:function(){f.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"change:url",this.updateImage)},updateImage:function(){this.$("img").attr("src",this.model.get("url"))}});d.exports=b},{}],40:[function(c,d,b){var f=jQuery,a;a=wp.media.view.Settings.extend({className:"embed-link-settings",template:wp.template("embed-link-settings"),initialize:function(){this.listenTo(this.model,"change:url",this.updateoEmbed)},updateoEmbed:_.debounce(function(){var g=this.model.get("url");this.$(".embed-container").hide().find(".embed-preview").empty();this.$(".setting").hide();if(g&&(g.length<11||!g.match(/^http(s)?:\/\//))){return}this.fetch()},wp.media.controller.Embed.sensitivity),fetch:function(){var g;if(f("#embed-url-field").val()!==this.model.get("url")){return}if(this.dfd&&"pending"===this.dfd.state()){this.dfd.abort()}g=new wp.shortcode({tag:"embed",attrs:_.pick(this.model.attributes,["width","height","src"]),content:this.model.get("url")});this.dfd=f.ajax({type:"POST",url:wp.ajax.settings.url,context:this,data:{action:"parse-embed",post_ID:wp.media.view.settings.post.id,shortcode:g.string()}}).done(this.renderoEmbed).fail(this.renderFail)},renderFail:function(h,g){if("abort"===g){return}this.$(".link-text").show()},renderoEmbed:function(g){var h=(g&&g.data&&g.data.body)||"";if(h){this.$(".embed-container").show().find(".embed-preview").html(h)}else{this.renderFail()}}});d.exports=a},{}],41:[function(b,c,a){var g=wp.media.View,f=jQuery,d;d=g.extend({tagName:"label",className:"embed-url",events:{input:"url",keyup:"url",change:"url"},initialize:function(){this.$input=f('<input id="embed-url-field" type="url" />').val(this.model.get("url"));this.input=this.$input[0];this.spinner=f('<span class="spinner" />')[0];this.$el.append([this.input,this.spinner]);this.listenTo(this.model,"change:url",this.render);if(this.model.get("url")){_.delay(_.bind(function(){this.model.trigger("change:url")},this),500)}},render:function(){var h=this.$input;if(h.is(":focus")){return}this.input.value=this.model.get("url")||"http://";g.prototype.render.apply(this,arguments);return this},ready:function(){if(!wp.media.isTouchDevice){this.focus()}},url:function(h){this.model.set("url",h.target.value)},focus:function(){var h=this.$input;if(h.is(":visible")){h.focus()[0].select()}}});c.exports=d},{}],42:[function(c,d,b){var a=wp.media.View.extend({events:{keydown:"constrainTabbing"},focus:function(){this.$(".media-menu-item").first().focus()},constrainTabbing:function(g){var f;if(9!==g.keyCode){return}f=this.$(":tabbable").not('.moxie-shim input[type="file"]');if(f.last()[0]===g.target&&!g.shiftKey){f.first().focus();return false}else{if(f.first()[0]===g.target&&g.shiftKey){f.last().focus();return false}}}});d.exports=a},{}],43:[function(b,d,a){var c=wp.media.View.extend({initialize:function(){_.defaults(this.options,{mode:["select"]});this._createRegions();this._createStates();this._createModes()},_createRegions:function(){this.regions=this.regions?this.regions.slice():[];_.each(this.regions,function(f){this[f]=new wp.media.controller.Region({view:this,id:f,selector:".media-frame-"+f})},this)},_createStates:function(){this.states=new Backbone.Collection(null,{model:wp.media.controller.State});this.states.on("add",function(f){f.frame=this;f.trigger("ready")},this);if(this.options.states){this.states.add(this.options.states)}},_createModes:function(){this.activeModes=new Backbone.Collection();this.activeModes.on("add remove reset",_.bind(this.triggerModeEvents,this));_.each(this.options.mode,function(f){this.activateMode(f)},this)},reset:function(){this.states.invoke("trigger","reset");return this},triggerModeEvents:function(i,k,h){var g,f={add:"activate",remove:"deactivate"},j;_.each(h,function(m,l){if(m){g=l}});if(!_.has(f,g)){return}j=i.get("id")+":"+f[g];this.trigger(j)},activateMode:function(f){if(this.isModeActive(f)){return}this.activeModes.add([{id:f}]);this.$el.addClass("mode-"+f);return this},deactivateMode:function(f){if(!this.isModeActive(f)){return this}this.activeModes.remove(this.activeModes.where({id:f}));this.$el.removeClass("mode-"+f);this.trigger(f+":deactivate");return this},isModeActive:function(f){return Boolean(this.activeModes.where({id:f}).length)}});_.extend(c.prototype,wp.media.controller.StateMachine.prototype);d.exports=c},{}],44:[function(b,d,a){var g=wp.media.view.MediaFrame.Select,c=wp.media.view.l10n,f;f=g.extend({defaults:{id:"image",url:"",menu:"image-details",content:"image-details",toolbar:"image-details",type:"link",title:c.imageDetailsTitle,priority:120},initialize:function(h){this.image=new wp.media.model.PostImage(h.metadata);this.options.selection=new wp.media.model.Selection(this.image.attachment,{multiple:false});g.prototype.initialize.apply(this,arguments)},bindHandlers:function(){g.prototype.bindHandlers.apply(this,arguments);this.on("menu:create:image-details",this.createMenu,this);this.on("content:create:image-details",this.imageDetailsContent,this);this.on("content:render:edit-image",this.editImageContent,this);this.on("toolbar:render:image-details",this.renderImageDetailsToolbar,this);this.on("toolbar:render:replace",this.renderReplaceImageToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.ImageDetails({image:this.image,editable:false}),new wp.media.controller.ReplaceImage({id:"replace-image",library:wp.media.query({type:"image"}),image:this.image,multiple:false,title:c.imageReplaceTitle,toolbar:"replace",priority:80,displaySettings:true}),new wp.media.controller.EditImage({image:this.image,selection:this.options.selection})])},imageDetailsContent:function(h){h.view=new wp.media.view.ImageDetails({controller:this,model:this.state().image,attachment:this.state().image.attachment})},editImageContent:function(){var j=this.state(),i=j.get("image"),h;if(!i){return}h=new wp.media.view.EditImage({model:i,controller:this}).render();this.content.set(h);h.loadEditor()},renderImageDetailsToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{select:{style:"primary",text:c.update,priority:80,click:function(){var h=this.controller,i=h.state();h.close();i.trigger("update",h.image.toJSON());h.setState(h.options.state);h.reset()}}}}))},renderReplaceImageToolbar:function(){var j=this,h=j.lastState(),i=h&&h.id;this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{back:{text:c.back,priority:20,click:function(){if(i){j.setState(i)}else{j.close()}}},replace:{style:"primary",text:c.replace,priority:80,click:function(){var k=this.controller,m=k.state(),l=m.get("selection"),n=l.single();k.close();k.image.changeAttachment(n,m.display(n));m.trigger("replace",k.image.toJSON());k.setState(k.options.state);k.reset()}}}}))}});d.exports=f},{}],45:[function(c,f,b){var h=wp.media.view.MediaFrame.Select,g=wp.media.controller.Library,d=wp.media.view.l10n,a;a=h.extend({initialize:function(){this.counts={audio:{count:wp.media.view.settings.attachmentCounts.audio,state:"playlist"},video:{count:wp.media.view.settings.attachmentCounts.video,state:"video-playlist"}};_.defaults(this.options,{multiple:true,editing:false,state:"insert",metadata:{}});h.prototype.initialize.apply(this,arguments);this.createIframeStates()},createStates:function(){var i=this.options;this.states.add([new g({id:"insert",title:d.insertMediaTitle,priority:20,toolbar:"main-insert",filterable:"all",library:wp.media.query(i.library),multiple:i.multiple?"reset":false,editable:true,allowLocalEdits:true,displaySettings:true,displayUserSettings:true}),new g({id:"gallery",title:d.createGalleryTitle,priority:40,toolbar:"main-gallery",filterable:"uploaded",multiple:"add",editable:false,library:wp.media.query(_.defaults({type:"image"},i.library))}),new wp.media.controller.Embed({metadata:i.metadata}),new wp.media.controller.EditImage({model:i.editImage}),new wp.media.controller.GalleryEdit({library:i.selection,editing:i.editing,menu:"gallery"}),new wp.media.controller.GalleryAdd(),new g({id:"playlist",title:d.createPlaylistTitle,priority:60,toolbar:"main-playlist",filterable:"uploaded",multiple:"add",editable:false,library:wp.media.query(_.defaults({type:"audio"},i.library))}),new wp.media.controller.CollectionEdit({type:"audio",collectionType:"playlist",title:d.editPlaylistTitle,SettingsView:wp.media.view.Settings.Playlist,library:i.selection,editing:i.editing,menu:"playlist",dragInfoText:d.playlistDragInfo,dragInfo:false}),new wp.media.controller.CollectionAdd({type:"audio",collectionType:"playlist",title:d.addToPlaylistTitle}),new g({id:"video-playlist",title:d.createVideoPlaylistTitle,priority:60,toolbar:"main-video-playlist",filterable:"uploaded",multiple:"add",editable:false,library:wp.media.query(_.defaults({type:"video"},i.library))}),new wp.media.controller.CollectionEdit({type:"video",collectionType:"playlist",title:d.editVideoPlaylistTitle,SettingsView:wp.media.view.Settings.Playlist,library:i.selection,editing:i.editing,menu:"video-playlist",dragInfoText:d.videoPlaylistDragInfo,dragInfo:false}),new wp.media.controller.CollectionAdd({type:"video",collectionType:"playlist",title:d.addToVideoPlaylistTitle})]);if(wp.media.view.settings.post.featuredImageId){this.states.add(new wp.media.controller.FeaturedImage())}},bindHandlers:function(){var i,j;h.prototype.bindHandlers.apply(this,arguments);this.on("activate",this.activate,this);j=_.find(this.counts,function(k){return k.count===0});if(typeof j!=="undefined"){this.listenTo(wp.media.model.Attachments.all,"change:type",this.mediaTypeCounts)}this.on("menu:create:gallery",this.createMenu,this);this.on("menu:create:playlist",this.createMenu,this);this.on("menu:create:video-playlist",this.createMenu,this);this.on("toolbar:create:main-insert",this.createToolbar,this);this.on("toolbar:create:main-gallery",this.createToolbar,this);this.on("toolbar:create:main-playlist",this.createToolbar,this);this.on("toolbar:create:main-video-playlist",this.createToolbar,this);this.on("toolbar:create:featured-image",this.featuredImageToolbar,this);this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this);i={menu:{"default":"mainMenu",gallery:"galleryMenu",playlist:"playlistMenu","video-playlist":"videoPlaylistMenu"},content:{embed:"embedContent","edit-image":"editImageContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar","main-gallery":"mainGalleryToolbar","gallery-edit":"galleryEditToolbar","gallery-add":"galleryAddToolbar","main-playlist":"mainPlaylistToolbar","playlist-edit":"playlistEditToolbar","playlist-add":"playlistAddToolbar","main-video-playlist":"mainVideoPlaylistToolbar","video-playlist-edit":"videoPlaylistEditToolbar","video-playlist-add":"videoPlaylistAddToolbar"}};_.each(i,function(l,k){_.each(l,function(n,m){this.on(k+":render:"+m,this[n],this)},this)},this)},activate:function(){_.each(this.counts,function(i){if(i.count<1){this.menuItemVisibility(i.state,"hide")}},this)},mediaTypeCounts:function(j,i){if(typeof this.counts[i]!=="undefined"&&this.counts[i].count<1){this.counts[i].count++;this.menuItemVisibility(this.counts[i].state,"show")}},mainMenu:function(i){i.set({"library-separator":new wp.media.View({className:"separator",priority:100})})},menuItemVisibility:function(j,i){var k=this.menu.get();if(i==="hide"){k.hide(j)}else{if(i==="show"){k.show(j)}}},galleryMenu:function(i){var j=this.lastState(),k=j&&j.id,l=this;i.set({cancel:{text:d.cancelGalleryTitle,priority:20,click:function(){if(k){l.setState(k)}else{l.close()}this.controller.modal.focusManager.focus()}},separateCancel:new wp.media.View({className:"separator",priority:40})})},playlistMenu:function(i){var j=this.lastState(),k=j&&j.id,l=this;i.set({cancel:{text:d.cancelPlaylistTitle,priority:20,click:function(){if(k){l.setState(k)}else{l.close()}}},separateCancel:new wp.media.View({className:"separator",priority:40})})},videoPlaylistMenu:function(i){var j=this.lastState(),k=j&&j.id,l=this;i.set({cancel:{text:d.cancelVideoPlaylistTitle,priority:20,click:function(){if(k){l.setState(k)}else{l.close()}}},separateCancel:new wp.media.View({className:"separator",priority:40})})},embedContent:function(){var i=new wp.media.view.Embed({controller:this,model:this.state()}).render();this.content.set(i);if(!wp.media.isTouchDevice){i.url.focus()}},editSelectionContent:function(){var k=this.state(),j=k.get("selection"),i;i=new wp.media.view.AttachmentsBrowser({controller:this,collection:j,selection:j,model:k,sortable:true,search:false,date:false,dragInfo:true,AttachmentView:wp.media.view.Attachments.EditSelection}).render();i.toolbar.set("backToLibrary",{text:d.returnToLibrary,priority:-100,click:function(){this.controller.content.mode("browse")}});this.content.set(i);this.trigger("edit:selection",this)},editImageContent:function(){var j=this.state().get("image"),i=new wp.media.view.EditImage({model:j,controller:this}).render();this.content.set(i);i.loadEditor()},selectionStatusToolbar:function(i){var j=this.state().get("editable");i.set("selection",new wp.media.view.Selection({controller:this,collection:this.state().get("selection"),priority:-40,editable:j&&function(){this.controller.content.mode("edit-selection")}}).render())},mainInsertToolbar:function(j){var i=this;this.selectionStatusToolbar(j);j.set("insert",{style:"primary",priority:80,text:d.insertIntoPost,requires:{selection:true},click:function(){var l=i.state(),k=l.get("selection");i.close();l.trigger("insert",k).reset()}})},mainGalleryToolbar:function(j){var i=this;this.selectionStatusToolbar(j);j.set("gallery",{style:"primary",text:d.createNewGallery,priority:60,requires:{selection:true},click:function(){var k=i.state().get("selection"),l=i.state("gallery-edit"),m=k.where({type:"image"});l.set("library",new wp.media.model.Selection(m,{props:k.props.toJSON(),multiple:true}));this.controller.setState("gallery-edit");this.controller.modal.focusManager.focus()}})},mainPlaylistToolbar:function(j){var i=this;this.selectionStatusToolbar(j);j.set("playlist",{style:"primary",text:d.createNewPlaylist,priority:100,requires:{selection:true},click:function(){var k=i.state().get("selection"),l=i.state("playlist-edit"),m=k.where({type:"audio"});l.set("library",new wp.media.model.Selection(m,{props:k.props.toJSON(),multiple:true}));this.controller.setState("playlist-edit");this.controller.modal.focusManager.focus()}})},mainVideoPlaylistToolbar:function(j){var i=this;this.selectionStatusToolbar(j);j.set("video-playlist",{style:"primary",text:d.createNewVideoPlaylist,priority:100,requires:{selection:true},click:function(){var k=i.state().get("selection"),l=i.state("video-playlist-edit"),m=k.where({type:"video"});l.set("library",new wp.media.model.Selection(m,{props:k.props.toJSON(),multiple:true}));this.controller.setState("video-playlist-edit");this.controller.modal.focusManager.focus()}})},featuredImageToolbar:function(i){this.createSelectToolbar(i,{text:d.setFeaturedImage,state:this.options.state})},mainEmbedToolbar:function(i){i.view=new wp.media.view.Toolbar.Embed({controller:this})},galleryEditToolbar:function(){var i=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:i?d.updateGallery:d.insertGallery,priority:80,requires:{library:true},click:function(){var j=this.controller,k=j.state();j.close();k.trigger("update",k.get("library"));j.setState(j.options.state);j.reset()}}}}))},galleryAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:d.addToGallery,priority:80,requires:{selection:true},click:function(){var i=this.controller,k=i.state(),j=i.state("gallery-edit");j.get("library").add(k.get("selection").models);k.trigger("reset");i.setState("gallery-edit")}}}}))},playlistEditToolbar:function(){var i=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:i?d.updatePlaylist:d.insertPlaylist,priority:80,requires:{library:true},click:function(){var j=this.controller,k=j.state();j.close();k.trigger("update",k.get("library"));j.setState(j.options.state);j.reset()}}}}))},playlistAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:d.addToPlaylist,priority:80,requires:{selection:true},click:function(){var i=this.controller,k=i.state(),j=i.state("playlist-edit");j.get("library").add(k.get("selection").models);k.trigger("reset");i.setState("playlist-edit")}}}}))},videoPlaylistEditToolbar:function(){var i=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:i?d.updateVideoPlaylist:d.insertVideoPlaylist,priority:140,requires:{library:true},click:function(){var j=this.controller,l=j.state(),k=l.get("library");k.type="video";j.close();l.trigger("update",k);j.setState(j.options.state);j.reset()}}}}))},videoPlaylistAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:d.addToVideoPlaylist,priority:140,requires:{selection:true},click:function(){var i=this.controller,k=i.state(),j=i.state("video-playlist-edit");j.get("library").add(k.get("selection").models);k.trigger("reset");i.setState("video-playlist-edit")}}}}))}});f.exports=a},{}],46:[function(b,d,a){var f=wp.media.view.MediaFrame,c=wp.media.view.l10n,g;g=f.extend({initialize:function(){f.prototype.initialize.apply(this,arguments);_.defaults(this.options,{selection:[],library:{},multiple:false,state:"library"});this.createSelection();this.createStates();this.bindHandlers()},createSelection:function(){var h=this.options.selection;if(!(h instanceof wp.media.model.Selection)){this.options.selection=new wp.media.model.Selection(h,{multiple:this.options.multiple})}this._selection={attachments:new wp.media.model.Attachments(),difference:[]}},createStates:function(){var h=this.options;if(this.options.states){return}this.states.add([new wp.media.controller.Library({library:wp.media.query(h.library),multiple:h.multiple,title:h.title,priority:20})])},bindHandlers:function(){this.on("router:create:browse",this.createRouter,this);this.on("router:render:browse",this.browseRouter,this);this.on("content:create:browse",this.browseContent,this);this.on("content:render:upload",this.uploadContent,this);this.on("toolbar:create:select",this.createSelectToolbar,this)},browseRouter:function(h){h.set({upload:{text:c.uploadFilesTitle,priority:20},browse:{text:c.mediaLibraryTitle,priority:40}})},browseContent:function(h){var i=this.state();this.$el.removeClass("hide-toolbar");h.view=new wp.media.view.AttachmentsBrowser({controller:this,collection:i.get("library"),selection:i.get("selection"),model:i,sortable:i.get("sortable"),search:i.get("searchable"),filters:i.get("filterable"),date:i.get("date"),display:i.has("display")?i.get("display"):i.get("displaySettings"),dragInfo:i.get("dragInfo"),idealColumnWidth:i.get("idealColumnWidth"),suggestedWidth:i.get("suggestedWidth"),suggestedHeight:i.get("suggestedHeight"),AttachmentView:i.get("AttachmentView")})},uploadContent:function(){this.$el.removeClass("hide-toolbar");this.content.set(new wp.media.view.UploaderInline({controller:this}))},createSelectToolbar:function(i,h){h=h||this.options.button||{};h.controller=this;i.view=new wp.media.view.Toolbar.Select(h)}});d.exports=g},{}],47:[function(b,d,a){var c=wp.media.View.extend({className:"media-iframe",render:function(){this.views.detach();this.$el.html('<iframe src="'+this.controller.state().get("src")+'" />');this.views.render();return this}});d.exports=c},{}],48:[function(b,c,a){var f=wp.media.view.Settings.AttachmentDisplay,d=jQuery,g;g=f.extend({className:"image-details",template:wp.template("image-details"),events:_.defaults(f.prototype.events,{"click .edit-attachment":"editAttachment","click .replace-attachment":"replaceAttachment","click .advanced-toggle":"onToggleAdvanced",'change [data-setting="customWidth"]':"onCustomSize",'change [data-setting="customHeight"]':"onCustomSize",'keyup [data-setting="customWidth"]':"onCustomSize",'keyup [data-setting="customHeight"]':"onCustomSize"}),initialize:function(){this.options.attachment=this.model.attachment;this.listenTo(this.model,"change:url",this.updateUrl);this.listenTo(this.model,"change:link",this.toggleLinkSettings);this.listenTo(this.model,"change:size",this.toggleCustomSize);f.prototype.initialize.apply(this,arguments)},prepare:function(){var h=false;if(this.model.attachment){h=this.model.attachment.toJSON()}return _.defaults({model:this.model.toJSON(),attachment:h},this.options)},render:function(){var h=arguments;if(this.model.attachment&&"pending"===this.model.dfd.state()){this.model.dfd.done(_.bind(function(){f.prototype.render.apply(this,h);this.postRender()},this)).fail(_.bind(function(){this.model.attachment=false;f.prototype.render.apply(this,h);this.postRender()},this))}else{f.prototype.render.apply(this,arguments);this.postRender()}return this},postRender:function(){setTimeout(_.bind(this.resetFocus,this),10);this.toggleLinkSettings();if(window.getUserSetting("advImgDetails")==="show"){this.toggleAdvanced(true)}this.trigger("post-render")},resetFocus:function(){this.$(".link-to-custom").blur();this.$(".embed-media-settings").scrollTop(0)},updateUrl:function(){this.$(".image img").attr("src",this.model.get("url"));this.$(".url").val(this.model.get("url"))},toggleLinkSettings:function(){if(this.model.get("link")==="none"){this.$(".link-settings").addClass("hidden")}else{this.$(".link-settings").removeClass("hidden")}},toggleCustomSize:function(){if(this.model.get("size")!=="custom"){this.$(".custom-size").addClass("hidden")}else{this.$(".custom-size").removeClass("hidden")}},onCustomSize:function(i){var k=d(i.target).data("setting"),h=d(i.target).val(),j;if(!/^\d+/.test(h)||parseInt(h,10)<1){i.preventDefault();return}if(k==="customWidth"){j=Math.round(1/this.model.get("aspectRatio")*h);this.model.set("customHeight",j,{silent:true});this.$('[data-setting="customHeight"]').val(j)}else{j=Math.round(this.model.get("aspectRatio")*h);this.model.set("customWidth",j,{silent:true});this.$('[data-setting="customWidth"]').val(j)}},onToggleAdvanced:function(h){h.preventDefault();this.toggleAdvanced()},toggleAdvanced:function(h){var i=this.$el.find(".advanced-section"),j;if(i.hasClass("advanced-visible")||h===false){i.removeClass("advanced-visible");i.find(".advanced-settings").addClass("hidden");j="hide"}else{i.addClass("advanced-visible");i.find(".advanced-settings").removeClass("hidden");j="show"}window.setUserSetting("advImgDetails",j)},editAttachment:function(i){var h=this.controller.states.get("edit-image");if(window.imageEdit&&h){i.preventDefault();h.set("image",this.model.attachment);this.controller.setState("edit-image")}},replaceAttachment:function(h){h.preventDefault();this.controller.setState("replace-image")}});c.exports=g},{}],49:[function(b,c,a){var d=wp.media.View.extend({tagName:"label",className:"screen-reader-text",initialize:function(){this.value=this.options.value},render:function(){this.$el.html(this.value);return this}});c.exports=d},{}],50:[function(b,d,a){var c=wp.media.view.Frame,g=jQuery,f;f=c.extend({className:"media-frame",template:wp.template("media-frame"),regions:["menu","title","content","toolbar","router"],events:{"click div.media-frame-title h1":"toggleMenu"},initialize:function(){c.prototype.initialize.apply(this,arguments);_.defaults(this.options,{title:"",modal:true,uploader:true});this.$el.addClass("wp-core-ui");if(this.options.modal){this.modal=new wp.media.view.Modal({controller:this,title:this.options.title});this.modal.content(this)}if(wp.Uploader.limitExceeded||!wp.Uploader.browser.supported){this.options.uploader=false}if(this.options.uploader){this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.modal?this.modal.$el:this.$el,container:this.$el}});this.views.set(".media-frame-uploader",this.uploader)}this.on("attach",_.bind(this.views.ready,this.views),this);this.on("title:create:default",this.createTitle,this);this.title.mode("default");this.on("title:render",function(h){h.$el.append('<span class="dashicons dashicons-arrow-down"></span>')});this.on("menu:create:default",this.createMenu,this)},render:function(){if(!this.state()&&this.options.state){this.setState(this.options.state)}return c.prototype.render.apply(this,arguments)},createTitle:function(h){h.view=new wp.media.View({controller:this,tagName:"h1"})},createMenu:function(h){h.view=new wp.media.view.Menu({controller:this})},toggleMenu:function(){this.$el.find(".media-menu").toggleClass("visible")},createToolbar:function(h){h.view=new wp.media.view.Toolbar({controller:this})},createRouter:function(h){h.view=new wp.media.view.Router({controller:this})},createIframeStates:function(h){var k=wp.media.view.settings,j=k.tabs,l=k.tabUrl,i;if(!j||!l){return}i=g("#post_ID");if(i.length){l+="&post_id="+i.val()}_.each(j,function(m,n){this.state("iframe:"+n).set(_.defaults({tab:n,src:l+"&tab="+n,title:m,content:"iframe",menu:"default"},h))},this);this.on("content:create:iframe",this.iframeContent,this);this.on("content:deactivate:iframe",this.iframeContentCleanup,this);this.on("menu:render:default",this.iframeMenu,this);this.on("open",this.hijackThickbox,this);this.on("close",this.restoreThickbox,this)},iframeContent:function(h){this.$el.addClass("hide-toolbar");h.view=new wp.media.view.Iframe({controller:this})},iframeContentCleanup:function(){this.$el.removeClass("hide-toolbar")},iframeMenu:function(i){var h={};if(!i){return}_.each(wp.media.view.settings.tabs,function(j,k){h["iframe:"+k]={text:this.state("iframe:"+k).get("title"),priority:200}},this);i.set(h)},hijackThickbox:function(){var h=this;if(!window.tb_remove||this._tb_remove){return}this._tb_remove=window.tb_remove;window.tb_remove=function(){h.close();h.reset();h.setState(h.options.state);h._tb_remove.call(window)}},restoreThickbox:function(){if(!this._tb_remove){return}window.tb_remove=this._tb_remove;delete this._tb_remove}});_.each(["open","close","attach","detach","escape"],function(h){f.prototype[h]=function(){if(this.modal){this.modal[h].apply(this.modal,arguments)}return this}});d.exports=f},{}],51:[function(b,c,a){var f=jQuery,d;d=wp.media.View.extend({tagName:"a",className:"media-menu-item",attributes:{href:"#"},events:{click:"_click"},_click:function(g){var h=this.options.click;if(g){g.preventDefault()}if(h){h.call(this)}else{this.click()}if(!wp.media.isTouchDevice){f(".media-frame-content input").first().focus()}},click:function(){var g=this.options.state;if(g){this.controller.setState(g);this.views.parent.$el.removeClass("visible")}},render:function(){var g=this.options;if(g.text){this.$el.text(g.text)}else{if(g.html){this.$el.html(g.html)}}return this}});c.exports=d},{}],52:[function(b,d,a){var g=wp.media.view.MenuItem,c=wp.media.view.PriorityList,f;f=c.extend({tagName:"div",className:"media-menu",property:"state",ItemView:g,region:"menu",toView:function(h,i){h=h||{};h[this.property]=h[this.property]||i;return new this.ItemView(h).render()},ready:function(){c.prototype.ready.apply(this,arguments);this.visibility()},set:function(){c.prototype.set.apply(this,arguments);this.visibility()},unset:function(){c.prototype.unset.apply(this,arguments);this.visibility()},visibility:function(){var k=this.region,i=this.controller[k].get(),h=this.views.get(),j=!h||h.length<2;if(this===i){this.controller.$el.toggleClass("hide-"+k,j)}},select:function(i){var h=this.get(i);if(!h){return}this.deselect();h.$el.addClass("active")},deselect:function(){this.$el.children().removeClass("active")},hide:function(i){var h=this.get(i);if(!h){return}h.$el.addClass("hidden")},show:function(i){var h=this.get(i);if(!h){return}h.$el.removeClass("hidden")}});d.exports=f},{}],53:[function(c,d,b){var f=jQuery,a;a=wp.media.View.extend({tagName:"div",template:wp.template("media-modal"),attributes:{tabindex:0},events:{"click .media-modal-backdrop, .media-modal-close":"escapeHandler",keydown:"keydown"},clickedOpenerEl:null,initialize:function(){_.defaults(this.options,{container:document.body,title:"",propagate:true,freeze:true});this.focusManager=new wp.media.view.FocusManager({el:this.el})},prepare:function(){return{title:this.options.title}},attach:function(){if(this.views.attached){return this}if(!this.views.rendered){this.render()}this.$el.appendTo(this.options.container);this.views.attached=true;this.views.ready();return this.propagate("attach")},detach:function(){if(this.$el.is(":visible")){this.close()}this.$el.detach();this.views.attached=false;return this.propagate("detach")},open:function(){var i=this.$el,h=this.options,g;if(i.is(":visible")){return this}this.clickedOpenerEl=document.activeElement;if(!this.views.attached){this.attach()}if(h.freeze){this._freeze={scrollTop:f(window).scrollTop()}}f("body").addClass("modal-open");i.show();if("ontouchend" in document){if((g=window.tinymce&&window.tinymce.activeEditor)&&!g.isHidden()&&g.iframeElement){g.iframeElement.focus();g.iframeElement.blur();setTimeout(function(){g.iframeElement.blur()},100)}}this.$el.focus();return this.propagate("open")},close:function(g){var h=this._freeze;if(!this.views.attached||!this.$el.is(":visible")){return this}f("body").removeClass("modal-open");this.$el.hide().undelegate("keydown");if(null!==this.clickedOpenerEl){this.clickedOpenerEl.focus()}else{f("#wpbody-content").focus()}this.propagate("close");if(h){f(window).scrollTop(h.scrollTop)}if(g&&g.escape){this.propagate("escape")}return this},escape:function(){return this.close({escape:true})},escapeHandler:function(g){g.preventDefault();this.escape()},content:function(g){this.views.set(".media-modal-content",g);return this},propagate:function(g){this.trigger(g);if(this.options.propagate){this.controller.trigger(g)}return this},keydown:function(g){if(27===g.which&&this.$el.is(":visible")){this.escape();g.stopImmediatePropagation()}}});d.exports=a},{}],54:[function(b,d,a){var c=wp.media.View.extend({tagName:"div",initialize:function(){this._views={};this.set(_.extend({},this._views,this.options.views),{silent:true});delete this.options.views;if(!this.options.silent){this.render()}},set:function(k,g,i){var j,f,h;i=i||{};if(_.isObject(k)){_.each(k,function(l,m){this.set(m,l)},this);return this}if(!(g instanceof Backbone.View)){g=this.toView(g,k,i)}g.controller=g.controller||this.controller;this.unset(k);j=g.options.priority||10;f=this.views.get()||[];_.find(f,function(m,l){if(m.options.priority>j){h=l;return true}});this._views[k]=g;this.views.add(g,{at:_.isNumber(h)?h:f.length||0});return this},get:function(f){return this._views[f]},unset:function(g){var f=this.get(g);if(f){f.remove()}delete this._views[g];return this},toView:function(f){return new wp.media.View(f)}});d.exports=c},{}],55:[function(b,c,a){var d=wp.media.view.MenuItem.extend({click:function(){var f=this.options.contentMode;if(f){this.controller.content.mode(f)}}});c.exports=d},{}],56:[function(c,d,b){var f=wp.media.view.Menu,a;a=f.extend({tagName:"div",className:"media-router",property:"contentMode",ItemView:wp.media.view.RouterItem,region:"router",initialize:function(){this.controller.on("content:render",this.update,this);f.prototype.initialize.apply(this,arguments)},update:function(){var g=this.controller.content.mode();if(g){this.select(g)}}});d.exports=a},{}],57:[function(c,f,a){var d=wp.media.view.l10n,b;b=wp.media.View.extend({tagName:"input",className:"search",id:"media-search-input",attributes:{type:"search",placeholder:d.searchMediaPlaceholder},events:{input:"search",keyup:"search",change:"search",search:"search"},render:function(){this.el.value=this.model.escape("search");return this},search:function(g){if(g.target.value){this.model.set("search",g.target.value)}else{this.model.unset("search")}}});f.exports=b},{}],58:[function(b,d,a){var c=wp.media.view.l10n,f;f=wp.media.View.extend({tagName:"div",className:"media-selection",template:wp.template("media-selection"),events:{"click .edit-selection":"edit","click .clear-selection":"clear"},initialize:function(){_.defaults(this.options,{editable:false,clearable:true});this.attachments=new wp.media.view.Attachments.Selection({controller:this.controller,collection:this.collection,selection:this.collection,model:new Backbone.Model()});this.views.set(".selection-view",this.attachments);this.collection.on("add remove reset",this.refresh,this);this.controller.on("content:activate",this.refresh,this)},ready:function(){this.refresh()},refresh:function(){if(!this.$el.children().length){return}var h=this.collection,g="edit-selection"===this.controller.content.mode();this.$el.toggleClass("empty",!h.length);this.$el.toggleClass("one",1===h.length);this.$el.toggleClass("editing",g);this.$(".count").text(c.selected.replace("%d",h.length))},edit:function(g){g.preventDefault();if(this.options.editable){this.options.editable.call(this,this.collection)}},clear:function(g){g.preventDefault();this.collection.reset();this.controller.modal.focusManager.focus()}});d.exports=f},{}],59:[function(b,c,a){var g=wp.media.View,f=Backbone.$,d;d=g.extend({events:{"click button":"updateHandler","change input":"updateHandler","change select":"updateHandler","change textarea":"updateHandler"},initialize:function(){this.model=this.model||new Backbone.Model();this.listenTo(this.model,"change",this.updateChanges)},prepare:function(){return _.defaults({model:this.model.toJSON()},this.options)},render:function(){g.prototype.render.apply(this,arguments);_(this.model.attributes).chain().keys().each(this.update,this);return this},update:function(k){var l=this.model.get(k),j=this.$('[data-setting="'+k+'"]'),h,i;if(!j.length){return}if(j.is("select")){i=j.find('[value="'+l+'"]');if(i.length){j.find("option").prop("selected",false);i.prop("selected",true)}else{this.model.set(k,j.find(":selected").val())}}else{if(j.hasClass("button-group")){h=j.find("button").removeClass("active");h.filter('[value="'+l+'"]').addClass("active")}else{if(j.is('input[type="text"], textarea')){if(!j.is(":focus")){j.val(l)}}else{if(j.is('input[type="checkbox"]')){j.prop("checked",!!l&&"false"!==l)}}}}},updateHandler:function(j){var i=f(j.target).closest("[data-setting]"),k=j.target.value,h;j.preventDefault();if(!i.length){return}if(i.is('input[type="checkbox"]')){k=i[0].checked}this.model.set(i.data("setting"),k);if(h=i.data("userSetting")){window.setUserSetting(h,k)}},updateChanges:function(h){if(h.hasChanged()){_(h.changed).chain().keys().each(this.update,this)}}});c.exports=d},{}],60:[function(b,c,a){var d=wp.media.view.Settings,f;f=d.extend({className:"attachment-display-settings",template:wp.template("attachment-display-settings"),initialize:function(){var g=this.options.attachment;_.defaults(this.options,{userSettings:false});d.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"change:link",this.updateLinkTo);if(g){g.on("change:uploading",this.render,this)}},dispose:function(){var g=this.options.attachment;if(g){g.off(null,null,this)}d.prototype.dispose.apply(this,arguments)},render:function(){var g=this.options.attachment;if(g){_.extend(this.options,{sizes:g.get("sizes"),type:g.get("type")})}d.prototype.render.call(this);this.updateLinkTo();return this},updateLinkTo:function(){var h=this.model.get("link"),i=this.$(".link-to-custom"),g=this.options.attachment;if("none"===h||"embed"===h||(!g&&"custom"!==h)){i.addClass("hidden");return}if(g){if("post"===h){i.val(g.get("link"))}else{if("file"===h){i.val(g.get("url"))}else{if(!this.model.get("linkUrl")){i.val("http://")}}}i.prop("readonly","custom"!==h)}i.removeClass("hidden");if(!wp.media.isTouchDevice&&i.is(":visible")){i.focus()[0].select()}}});c.exports=f},{}],61:[function(b,c,a){var d=wp.media.view.Settings.extend({className:"collection-settings gallery-settings",template:wp.template("gallery-settings")});c.exports=d},{}],62:[function(b,c,a){var d=wp.media.view.Settings.extend({className:"collection-settings playlist-settings",template:wp.template("playlist-settings")});c.exports=d},{}],63:[function(b,c,a){var d=wp.media.view.PriorityList.extend({className:"media-sidebar"});c.exports=d},{}],64:[function(c,d,b){var f=wp.media.view,a;a=f.Cropper.extend({className:"crop-content site-icon",ready:function(){f.Cropper.prototype.ready.apply(this,arguments);this.$(".crop-image").on("load",_.bind(this.addSidebar,this))},addSidebar:function(){this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.sidebar.set("preview",new wp.media.view.SiteIconPreview({controller:this.controller,attachment:this.options.attachment}));this.controller.cropperView.views.add(this.sidebar)}});d.exports=a},{}],65:[function(b,c,a){var g=wp.media.View,f=jQuery,d;d=g.extend({className:"site-icon-preview",template:wp.template("site-icon-preview"),ready:function(){this.controller.imgSelect.setOptions({onInit:this.updatePreview,onSelectChange:this.updatePreview})},prepare:function(){return{url:this.options.attachment.get("url")}},updatePreview:function(h,l){var m=64/l.width,k=64/l.height,j=16/l.width,i=16/l.height;f("#preview-app-icon").css({width:Math.round(m*this.imageWidth)+"px",height:Math.round(k*this.imageHeight)+"px",marginLeft:"-"+Math.round(m*l.x1)+"px",marginTop:"-"+Math.round(k*l.y1)+"px"});f("#preview-favicon").css({width:Math.round(j*this.imageWidth)+"px",height:Math.round(i*this.imageHeight)+"px",marginLeft:"-"+Math.round(j*l.x1)+"px",marginTop:"-"+Math.floor(i*l.y1)+"px"})}});c.exports=d},{}],66:[function(b,c,a){var d=wp.media.View.extend({tagName:"span",className:"spinner",spinnerTimeout:false,delay:400,show:function(){if(!this.spinnerTimeout){this.spinnerTimeout=_.delay(function(f){f.addClass("is-active")},this.delay,this.$el)}return this},hide:function(){this.$el.removeClass("is-active");this.spinnerTimeout=clearTimeout(this.spinnerTimeout);return this}});c.exports=d},{}],67:[function(b,d,a){var f=wp.media.View,c;c=f.extend({tagName:"div",className:"media-toolbar",initialize:function(){var i=this.controller.state(),h=this.selection=i.get("selection"),g=this.library=i.get("library");this._views={};this.primary=new wp.media.view.PriorityList();this.secondary=new wp.media.view.PriorityList();this.primary.$el.addClass("media-toolbar-primary search-form");this.secondary.$el.addClass("media-toolbar-secondary");this.views.set([this.secondary,this.primary]);if(this.options.items){this.set(this.options.items,{silent:true})}if(!this.options.silent){this.render()}if(h){h.on("add remove reset",this.refresh,this)}if(g){g.on("add remove reset",this.refresh,this)}},dispose:function(){if(this.selection){this.selection.off(null,null,this)}if(this.library){this.library.off(null,null,this)}return f.prototype.dispose.apply(this,arguments)},ready:function(){this.refresh()},set:function(j,g,h){var i;h=h||{};if(_.isObject(j)){_.each(j,function(k,l){this.set(l,k,{silent:true})},this)}else{if(!(g instanceof Backbone.View)){g.classes=["media-button-"+j].concat(g.classes||[]);g=new wp.media.view.Button(g).render()}g.controller=g.controller||this.controller;this._views[j]=g;i=g.options.priority<0?"secondary":"primary";this[i].set(j,g,h)}if(!h.silent){this.refresh()}return this},get:function(g){return this._views[g]},unset:function(h,g){delete this._views[h];this.primary.unset(h,g);this.secondary.unset(h,g);if(!g||!g.silent){this.refresh()}return this},refresh:function(){var i=this.controller.state(),g=i.get("library"),h=i.get("selection");_.each(this._views,function(j){if(!j.model||!j.options||!j.options.requires){return}var l=j.options.requires,k=false;k=_.some(h.models,function(m){return m.get("uploading")===true});if(l.selection&&h&&!h.length){k=true}else{if(l.library&&g&&!g.length){k=true}}j.model.set("disabled",k)})}});d.exports=c},{}],68:[function(b,d,a){var g=wp.media.view.Toolbar.Select,c=wp.media.view.l10n,f;f=g.extend({initialize:function(){_.defaults(this.options,{text:c.insertIntoPost,requires:false});g.prototype.initialize.apply(this,arguments)},refresh:function(){var h=this.controller.state().props.get("url");this.get("select").model.set("disabled",!h||h==="http://");g.prototype.refresh.apply(this,arguments)}});d.exports=f},{}],69:[function(b,f,a){var d=wp.media.view.Toolbar,c=wp.media.view.l10n,g;g=d.extend({initialize:function(){var h=this.options;_.bindAll(this,"clickSelect");_.defaults(h,{event:"select",state:false,reset:true,close:true,text:c.select,requires:{selection:true}});h.items=_.defaults(h.items||{},{select:{style:"primary",text:h.text,priority:80,click:this.clickSelect,requires:h.requires}});d.prototype.initialize.apply(this,arguments)},clickSelect:function(){var i=this.options,h=this.controller;if(i.close){h.close()}if(i.event){h.state().trigger(i.event)}if(i.state){h.setState(i.state)}if(i.reset){h.reset()}}});f.exports=g},{}],70:[function(b,d,a){var h=wp.media.View,c=wp.media.view.l10n,g=jQuery,f;f=h.extend({tagName:"div",className:"uploader-editor",template:wp.template("uploader-editor"),localDrag:false,overContainer:false,overDropzone:false,draggingFile:null,initialize:function(){this.initialized=false;if(!window.tinyMCEPreInit||!window.tinyMCEPreInit.dragDropUpload||!this.browserSupport()){return this}this.$document=g(document);this.dropzones=[];this.files=[];this.$document.on("drop",".uploader-editor",_.bind(this.drop,this));this.$document.on("dragover",".uploader-editor",_.bind(this.dropzoneDragover,this));this.$document.on("dragleave",".uploader-editor",_.bind(this.dropzoneDragleave,this));this.$document.on("click",".uploader-editor",_.bind(this.click,this));this.$document.on("dragover",_.bind(this.containerDragover,this));this.$document.on("dragleave",_.bind(this.containerDragleave,this));this.$document.on("dragstart dragend drop",_.bind(function(i){this.localDrag=i.type==="dragstart";if(i.type==="drop"){this.containerDragleave()}},this));this.initialized=true;return this},browserSupport:function(){var i=false,j=document.createElement("div");i=("draggable" in j)||("ondragstart" in j&&"ondrop" in j);i=i&&!!(window.File&&window.FileList&&window.FileReader);return i},isDraggingFile:function(i){if(this.draggingFile!==null){return this.draggingFile}if(_.isUndefined(i.originalEvent)||_.isUndefined(i.originalEvent.dataTransfer)){return false}this.draggingFile=_.indexOf(i.originalEvent.dataTransfer.types,"Files")>-1&&_.indexOf(i.originalEvent.dataTransfer.types,"text/plain")===-1;return this.draggingFile},refresh:function(j){var i;for(i in this.dropzones){this.dropzones[i].toggle(this.overContainer||this.overDropzone)}if(!_.isUndefined(j)){g(j.target).closest(".uploader-editor").toggleClass("droppable",this.overDropzone)}if(!this.overContainer&&!this.overDropzone){this.draggingFile=null}return this},render:function(){if(!this.initialized){return this}h.prototype.render.apply(this,arguments);g(".wp-editor-wrap").each(_.bind(this.attach,this));return this},attach:function(j,k){var i=this.$el.clone();this.dropzones.push(i);g(k).append(i);return this},drop:function(k){var i,j;this.containerDragleave(k);this.dropzoneDragleave(k);this.files=k.originalEvent.dataTransfer.files;if(this.files.length<1){return}i=g(k.target).parents(".wp-editor-wrap");if(i.length>0&&i[0].id){window.wpActiveEditor=i[0].id.slice(3,-5)}if(!this.workflow){this.workflow=wp.media.editor.open(window.wpActiveEditor,{frame:"post",state:"insert",title:c.addMedia,multiple:true});j=this.workflow.uploader;if(j.uploader&&j.uploader.ready){this.addFiles.apply(this)}else{this.workflow.on("uploader:ready",this.addFiles,this)}}else{this.workflow.state().reset();this.addFiles.apply(this);this.workflow.open()}return false},addFiles:function(){if(this.files.length){this.workflow.uploader.uploader.uploader.addFile(_.toArray(this.files));this.files=[]}return this},containerDragover:function(i){if(this.localDrag||!this.isDraggingFile(i)){return}this.overContainer=true;this.refresh()},containerDragleave:function(){this.overContainer=false;_.delay(_.bind(this.refresh,this),50)},dropzoneDragover:function(i){if(this.localDrag||!this.isDraggingFile(i)){return}this.overDropzone=true;this.refresh(i);return false},dropzoneDragleave:function(i){this.overDropzone=false;_.delay(_.bind(this.refresh,this,i),50)},click:function(i){this.containerDragleave(i);this.dropzoneDragleave(i);this.localDrag=false}});d.exports=f},{}],71:[function(c,d,a){var f=wp.media.View,b;b=f.extend({tagName:"div",className:"uploader-inline",template:wp.template("uploader-inline"),events:{"click .close":"hide"},initialize:function(){_.defaults(this.options,{message:"",status:true,canClose:false});if(!this.options.$browser&&this.controller.uploader){this.options.$browser=this.controller.uploader.$browser}if(_.isUndefined(this.options.postId)){this.options.postId=wp.media.view.settings.post.id}if(this.options.status){this.views.set(".upload-inline-status",new wp.media.view.UploaderStatus({controller:this.controller}))}},prepare:function(){var i=this.controller.state().get("suggestedWidth"),h=this.controller.state().get("suggestedHeight"),g={};g.message=this.options.message;g.canClose=this.options.canClose;if(i&&h){g.suggestedWidth=i;g.suggestedHeight=h}return g},dispose:function(){if(this.disposing){return f.prototype.dispose.apply(this,arguments)}this.disposing=true;return this.remove()},remove:function(){var g=f.prototype.remove.apply(this,arguments);_.defer(_.bind(this.refresh,this));return g},refresh:function(){var g=this.controller.uploader;if(g){g.refresh()}},ready:function(){var g=this.options.$browser,h;if(this.controller.uploader){h=this.$(".browser");if(h[0]===g[0]){return}g.detach().text(h.text());g[0].className=h[0].className;h.replaceWith(g.show())}this.refresh();return this},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}});d.exports=b},{}],72:[function(b,c,a){var d=wp.media.View.extend({className:"upload-error",template:wp.template("uploader-status-error")});c.exports=d},{}],73:[function(b,c,a){var f=wp.media.View,d;d=f.extend({className:"media-uploader-status",template:wp.template("uploader-status"),events:{"click .upload-dismiss-errors":"dismiss"},initialize:function(){this.queue=wp.Uploader.queue;this.queue.on("add remove reset",this.visibility,this);this.queue.on("add remove reset change:percent",this.progress,this);this.queue.on("add remove reset change:uploading",this.info,this);this.errors=wp.Uploader.errors;this.errors.reset();this.errors.on("add remove reset",this.visibility,this);this.errors.on("add",this.error,this)},dispose:function(){wp.Uploader.queue.off(null,null,this);f.prototype.dispose.apply(this,arguments);return this},visibility:function(){this.$el.toggleClass("uploading",!!this.queue.length);this.$el.toggleClass("errors",!!this.errors.length);this.$el.toggle(!!this.queue.length||!!this.errors.length)},ready:function(){_.each({"$bar":".media-progress-bar div","$index":".upload-index","$total":".upload-total","$filename":".upload-filename"},function(g,h){this[h]=this.$(g)},this);this.visibility();this.progress();this.info()},progress:function(){var g=this.queue,h=this.$bar;if(!h||!g.length){return}h.width((g.reduce(function(i,k){if(!k.get("uploading")){return i+100}var j=k.get("percent");return i+(_.isNumber(j)?j:100)},0)/g.length)+"%")},info:function(){var g=this.queue,h=0,i;if(!g.length){return}i=this.queue.find(function(k,j){h=j;return k.get("uploading")});this.$index.text(h+1);this.$total.text(g.length);this.$filename.html(i?this.filename(i.get("filename")):"")},filename:function(g){return _.escape(g)},error:function(g){this.views.add(".upload-errors",new wp.media.view.UploaderStatusError({filename:this.filename(g.get("file").name),message:g.get("message")}),{at:0})},dismiss:function(g){var h=this.views.get(".upload-errors");g.preventDefault();if(h){_.invoke(h,"remove")}wp.Uploader.errors.reset()}});c.exports=d},{}],74:[function(c,d,b){var f=jQuery,a;a=wp.media.View.extend({tagName:"div",className:"uploader-window",template:wp.template("uploader-window"),initialize:function(){var g;this.$browser=f('<a href="#" class="browser" />').hide().appendTo("body");g=this.options.uploader=_.defaults(this.options.uploader||{},{dropzone:this.$el,browser:this.$browser,params:{}});if(g.dropzone&&!(g.dropzone instanceof f)){g.dropzone=f(g.dropzone)}this.controller.on("activate",this.refresh,this);this.controller.on("detach",function(){this.$browser.remove()},this)},refresh:function(){if(this.uploader){this.uploader.refresh()}},ready:function(){var h=wp.media.view.settings.post.id,g;if(this.uploader){return}if(h){this.options.uploader.params.post_id=h}this.uploader=new wp.Uploader(this.options.uploader);g=this.uploader.dropzone;g.on("dropzone:enter",_.bind(this.show,this));g.on("dropzone:leave",_.bind(this.hide,this));f(this.uploader).on("uploader:ready",_.bind(this._ready,this))},_ready:function(){this.controller.trigger("uploader:ready")},show:function(){var g=this.$el.show();_.defer(function(){g.css({opacity:1})})},hide:function(){var g=this.$el.css({opacity:0});wp.media.transition(g).done(function(){if("0"===g.css("opacity")){g.hide()}});_.delay(function(){if("0"===g.css("opacity")&&g.is(":visible")){g.hide()}},500)}});d.exports=a},{}],75:[function(b,c,a){var d=wp.Backbone.View.extend({constructor:function(f){if(f&&f.controller){this.controller=f.controller}wp.Backbone.View.apply(this,arguments)},dispose:function(){this.undelegateEvents();if(this.model&&this.model.off){this.model.off(null,null,this)}if(this.collection&&this.collection.off){this.collection.off(null,null,this)}if(this.controller&&this.controller.off){this.controller.off(null,null,this)}return this},remove:function(){this.dispose();return wp.Backbone.View.prototype.remove.apply(this,arguments)}});c.exports=d},{}]},{},[19]);