(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0)}if(a){return a(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l)},h,h.exports,e,b,g,d)}return g[m].exports}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f])}return c})({1:[function(b,d,a){var f=wp.media,g=window._wpmejsSettings||{},c=window._wpMediaViewsL10n||{};wp.media.mixin={mejsSettings:g,removeAllPlayers:function(){var h;if(window.mejs&&window.mejs.players){for(h in window.mejs.players){window.mejs.players[h].pause();this.removePlayer(window.mejs.players[h])}}},removePlayer:function(i){var k,h;if(!i.options){return}for(k in i.options.features){h=i.options.features[k];if(i["clean"+h]){try{i["clean"+h](i)}catch(j){}}}if(!i.isDynamic){i.$node.remove()}if("native"!==i.media.pluginType){i.$media.remove()}delete window.mejs.players[i.id];i.container.remove();i.globalUnbind();delete i.node.player},unsetPlayers:function(){if(this.players&&this.players.length){_.each(this.players,function(h){h.pause();wp.media.mixin.removePlayer(h)});this.players=[]}}};wp.media.playlist=new wp.media.collection({tag:"playlist",editTitle:c.editPlaylistTitle,defaults:{id:wp.media.view.settings.post.id,style:"light",tracklist:true,tracknumbers:true,images:true,artists:true,type:"audio"}});wp.media.audio={coerce:wp.media.coerce,defaults:{id:wp.media.view.settings.post.id,src:"",loop:false,autoplay:false,preload:"none",width:400},edit:function(i){var j,h=wp.shortcode.next("audio",i).shortcode;j=wp.media({frame:"audio",state:"audio-details",metadata:_.defaults(h.attrs.named,this.defaults)});return j},shortcode:function(h){var i;_.each(this.defaults,function(k,j){h[j]=this.coerce(h,j);if(k===h[j]){delete h[j]}},this);i=h.content;delete h.content;return new wp.shortcode({tag:"audio",attrs:h,content:i})}};wp.media.video={coerce:wp.media.coerce,defaults:{id:wp.media.view.settings.post.id,src:"",poster:"",loop:false,autoplay:false,preload:"metadata",content:"",width:640,height:360},edit:function(j){var k,i=wp.shortcode.next("video",j).shortcode,h;h=i.attrs.named;h.content=i.content;k=wp.media({frame:"video",state:"video-details",metadata:_.defaults(h,this.defaults)});return k},shortcode:function(h){var i;_.each(this.defaults,function(k,j){h[j]=this.coerce(h,j);if(k===h[j]){delete h[j]}},this);i=h.content;delete h.content;return new wp.shortcode({tag:"video",attrs:h,content:i})}};f.model.PostMedia=b("./models/post-media.js");f.controller.AudioDetails=b("./controllers/audio-details.js");f.controller.VideoDetails=b("./controllers/video-details.js");f.view.MediaFrame.MediaDetails=b("./views/frame/media-details.js");f.view.MediaFrame.AudioDetails=b("./views/frame/audio-details.js");f.view.MediaFrame.VideoDetails=b("./views/frame/video-details.js");f.view.MediaDetails=b("./views/media-details.js");f.view.AudioDetails=b("./views/audio-details.js");f.view.VideoDetails=b("./views/video-details.js")},{"./controllers/audio-details.js":2,"./controllers/video-details.js":3,"./models/post-media.js":4,"./views/audio-details.js":5,"./views/frame/audio-details.js":6,"./views/frame/media-details.js":7,"./views/frame/video-details.js":8,"./views/media-details.js":9,"./views/video-details.js":10}],2:[function(d,g,c){var b=wp.media.controller.State,f=wp.media.view.l10n,a;a=b.extend({defaults:{id:"audio-details",toolbar:"audio-details",title:f.audioDetailsTitle,content:"audio-details",menu:"audio-details",router:false,priority:60},initialize:function(h){this.media=h.media;b.prototype.initialize.apply(this,arguments)}});g.exports=a},{}],3:[function(c,f,b){var a=wp.media.controller.State,d=wp.media.view.l10n,g;g=a.extend({defaults:{id:"video-details",toolbar:"video-details",title:d.videoDetailsTitle,content:"video-details",menu:"video-details",router:false,priority:60},initialize:function(h){this.media=h.media;a.prototype.initialize.apply(this,arguments)}});f.exports=g},{}],4:[function(b,c,a){var d=Backbone.Model.extend({initialize:function(){this.attachment=false},setSource:function(f){this.attachment=f;this.extension=f.get("filename").split(".").pop();if(this.get("src")&&this.extension===this.get("src").split(".").pop()){this.unset("src")}if(_.contains(wp.media.view.settings.embedExts,this.extension)){this.set(this.extension,this.attachment.get("url"))}else{this.unset(this.extension)}},changeAttachment:function(f){this.setSource(f);this.unset("src");_.each(_.without(wp.media.view.settings.embedExts,this.extension),function(g){this.unset(g)},this)}});c.exports=d},{}],5:[function(d,f,c){var b=wp.media.view.MediaDetails,a;a=b.extend({className:"audio-details",template:wp.template("audio-details"),setMedia:function(){var g=this.$(".wp-audio-shortcode");if(g.find("source").length){if(g.is(":hidden")){g.show()}this.media=b.prepareSrc(g.get(0))}else{g.hide();this.media=false}return this}});f.exports=a},{}],6:[function(d,g,c){var b=wp.media.view.MediaFrame.MediaDetails,h=wp.media.controller.MediaLibrary,f=wp.media.view.l10n,a;a=b.extend({defaults:{id:"audio",url:"",menu:"audio-details",content:"audio-details",toolbar:"audio-details",type:"link",title:f.audioDetailsTitle,priority:120},initialize:function(i){i.DetailsView=wp.media.view.AudioDetails;i.cancelText=f.audioDetailsCancel;i.addText=f.audioAddSourceTitle;b.prototype.initialize.call(this,i)},bindHandlers:function(){b.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:render:replace-audio",this.renderReplaceToolbar,this);this.on("toolbar:render:add-audio-source",this.renderAddSourceToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.AudioDetails({media:this.media}),new h({type:"audio",id:"replace-audio",title:f.audioReplaceTitle,toolbar:"replace-audio",media:this.media,menu:"audio-details"}),new h({type:"audio",id:"add-audio-source",title:f.audioAddSourceTitle,toolbar:"add-audio-source",media:this.media,menu:false})])}});g.exports=a},{}],7:[function(c,f,b){var g=wp.media.view.MediaFrame.Select,d=wp.media.view.l10n,a;a=g.extend({defaults:{id:"media",url:"",menu:"media-details",content:"media-details",toolbar:"media-details",type:"link",priority:120},initialize:function(h){this.DetailsView=h.DetailsView;this.cancelText=h.cancelText;this.addText=h.addText;this.media=new wp.media.model.PostMedia(h.metadata);this.options.selection=new wp.media.model.Selection(this.media.attachment,{multiple:false});g.prototype.initialize.apply(this,arguments)},bindHandlers:function(){var h=this.defaults.menu;g.prototype.bindHandlers.apply(this,arguments);this.on("menu:create:"+h,this.createMenu,this);this.on("content:render:"+h,this.renderDetailsContent,this);this.on("menu:render:"+h,this.renderMenu,this);this.on("toolbar:render:"+h,this.renderDetailsToolbar,this)},renderDetailsContent:function(){var h=new this.DetailsView({controller:this,model:this.state().media,attachment:this.state().media.attachment}).render();this.content.set(h)},renderMenu:function(h){var i=this.lastState(),j=i&&i.id,k=this;h.set({cancel:{text:this.cancelText,priority:20,click:function(){if(j){k.setState(j)}else{k.close()}}},separateCancel:new wp.media.View({className:"separator",priority:40})})},setPrimaryButton:function(i,h){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{button:{style:"primary",text:i,priority:80,click:function(){var j=this.controller;h.call(this,j,j.state());j.setState(j.options.state);j.reset()}}}}))},renderDetailsToolbar:function(){this.setPrimaryButton(d.update,function(h,i){h.close();i.trigger("update",h.media.toJSON())})},renderReplaceToolbar:function(){this.setPrimaryButton(d.replace,function(h,i){var j=i.get("selection").single();h.media.changeAttachment(j);i.trigger("replace",h.media.toJSON())})},renderAddSourceToolbar:function(){this.setPrimaryButton(this.addText,function(h,i){var j=i.get("selection").single();h.media.setSource(j);i.trigger("add-source",h.media.toJSON())})}});f.exports=a},{}],8:[function(c,f,b){var a=wp.media.view.MediaFrame.MediaDetails,h=wp.media.controller.MediaLibrary,d=wp.media.view.l10n,g;g=a.extend({defaults:{id:"video",url:"",menu:"video-details",content:"video-details",toolbar:"video-details",type:"link",title:d.videoDetailsTitle,priority:120},initialize:function(i){i.DetailsView=wp.media.view.VideoDetails;i.cancelText=d.videoDetailsCancel;i.addText=d.videoAddSourceTitle;a.prototype.initialize.call(this,i)},bindHandlers:function(){a.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:render:replace-video",this.renderReplaceToolbar,this);this.on("toolbar:render:add-video-source",this.renderAddSourceToolbar,this);this.on("toolbar:render:select-poster-image",this.renderSelectPosterImageToolbar,this);this.on("toolbar:render:add-track",this.renderAddTrackToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.VideoDetails({media:this.media}),new h({type:"video",id:"replace-video",title:d.videoReplaceTitle,toolbar:"replace-video",media:this.media,menu:"video-details"}),new h({type:"video",id:"add-video-source",title:d.videoAddSourceTitle,toolbar:"add-video-source",media:this.media,menu:false}),new h({type:"image",id:"select-poster-image",title:d.videoSelectPosterImageTitle,toolbar:"select-poster-image",media:this.media,menu:"video-details"}),new h({type:"text",id:"add-track",title:d.videoAddTrackTitle,toolbar:"add-track",media:this.media,menu:"video-details"})])},renderSelectPosterImageToolbar:function(){this.setPrimaryButton(d.videoSelectPosterImageTitle,function(i,j){var k=[],l=j.get("selection").single();i.media.set("poster",l.get("url"));j.trigger("set-poster-image",i.media.toJSON());_.each(wp.media.view.settings.embedExts,function(m){if(i.media.get(m)){k.push(i.media.get(m))}});wp.ajax.send("set-attachment-thumbnail",{data:{urls:k,thumbnail_id:l.get("id")}})})},renderAddTrackToolbar:function(){this.setPrimaryButton(d.videoAddTrackTitle,function(i,k){var l=k.get("selection").single(),j=i.media.get("content");if(-1===j.indexOf(l.get("url"))){j+=['<track srclang="en" label="English" kind="subtitles" src="',l.get("url"),'" />'].join("");i.media.set("content",j)}k.trigger("add-track",i.media.toJSON())})}});f.exports=g},{}],9:[function(c,d,b){var g=wp.media.view.Settings.AttachmentDisplay,f=jQuery,a;a=g.extend({initialize:function(){_.bindAll(this,"success");this.players=[];this.listenTo(this.controller,"close",wp.media.mixin.unsetPlayers);this.on("ready",this.setPlayer);this.on("media:setting:remove",wp.media.mixin.unsetPlayers,this);this.on("media:setting:remove",this.render);this.on("media:setting:remove",this.setPlayer);g.prototype.initialize.apply(this,arguments)},events:function(){return _.extend({"click .remove-setting":"removeSetting","change .content-track":"setTracks","click .remove-track":"setTracks","click .add-media-source":"addSource"},g.prototype.events)},prepare:function(){return _.defaults({model:this.model.toJSON()},this.options)},removeSetting:function(j){var i=f(j.currentTarget).parent(),h;h=i.find("input").data("setting");if(h){this.model.unset(h);this.trigger("media:setting:remove",this)}i.remove()},setTracks:function(){var h="";_.each(this.$(".content-track"),function(i){h+=f(i).val()});this.model.set("content",h);this.trigger("media:setting:remove",this)},addSource:function(h){this.controller.lastMime=f(h.currentTarget).data("mime");this.controller.setState("add-"+this.controller.defaults.id+"-source")},loadPlayer:function(){this.players.push(new MediaElementPlayer(this.media,this.settings));this.scriptXhr=false},setPlayer:function(){var i,h;if(this.players.length||!this.media||this.scriptXhr){return}h=this.model.get("src");if(h&&h.indexOf("vimeo")>-1&&!("Froogaloop" in window)){i=wp.media.mixin.mejsSettings;this.scriptXhr=f.getScript(i.pluginPath+"froogaloop.min.js",_.bind(this.loadPlayer,this))}else{this.loadPlayer()}},setMedia:function(){return this},success:function(h){var i=h.attributes.autoplay&&"false"!==h.attributes.autoplay;if("flash"===h.pluginType&&i){h.addEventListener("canplay",function(){h.play()},false)}this.mejs=h},render:function(){g.prototype.render.apply(this,arguments);setTimeout(_.bind(function(){this.resetFocus()},this),10);this.settings=_.defaults({success:this.success},wp.media.mixin.mejsSettings);return this.setMedia()},resetFocus:function(){this.$(".embed-media-settings").scrollTop(0)}},{instances:0,prepareSrc:function(j){var h=a.instances++;_.each(f(j).find("source"),function(i){i.src=[i.src,i.src.indexOf("?")>-1?"&":"?","_=",h].join("")});return j}});d.exports=a},{}],10:[function(c,d,b){var a=wp.media.view.MediaDetails,f;f=a.extend({className:"video-details",template:wp.template("video-details"),setMedia:function(){var g=this.$(".wp-video-shortcode");if(g.find("source").length){if(g.is(":hidden")){g.show()}if(!g.hasClass("youtube-video")&&!g.hasClass("vimeo-video")){this.media=a.prepareSrc(g.get(0))}else{this.media=g.get(0)}}else{g.hide();this.media=false}return this}});d.exports=f},{}]},{},[1]);