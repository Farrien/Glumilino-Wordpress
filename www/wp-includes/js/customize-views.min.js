(function(d,b,a){if(!b||!b.customize){return}var c=b.customize;c.HeaderTool.CurrentView=b.Backbone.View.extend({template:b.template("header-current"),initialize:function(){this.listenTo(this.model,"change",this.render);this.render()},render:function(){this.$el.html(this.template(this.model.toJSON()));this.setButtons();return this},setButtons:function(){var e=d("#customize-control-header_image .actions .remove");if(this.model.get("choice")){e.show()}else{e.hide()}}});c.HeaderTool.ChoiceView=b.Backbone.View.extend({template:b.template("header-choice"),className:"header-view",events:{"click .choice,.random":"select","click .close":"removeImage"},initialize:function(){var e=[this.model.get("header").url,this.model.get("choice")];this.listenTo(this.model,"change:selected",this.toggleSelected);if(a.contains(e,c.get().header_image)){c.HeaderTool.currentHeader.set(this.extendedModel())}},render:function(){this.$el.html(this.template(this.extendedModel()));this.toggleSelected();return this},toggleSelected:function(){this.$el.toggleClass("selected",this.model.get("selected"))},extendedModel:function(){var e=this.model.get("collection");return a.extend(this.model.toJSON(),{type:e.type})},select:function(){this.preventJump();this.model.save();c.HeaderTool.currentHeader.set(this.extendedModel())},preventJump:function(){var f=d(".wp-full-overlay-sidebar-content"),e=f.scrollTop();a.defer(function(){f.scrollTop(e)})},removeImage:function(f){f.stopPropagation();this.model.destroy();this.remove()}});c.HeaderTool.ChoiceListView=b.Backbone.View.extend({initialize:function(){this.listenTo(this.collection,"add",this.addOne);this.listenTo(this.collection,"remove",this.render);this.listenTo(this.collection,"sort",this.render);this.listenTo(this.collection,"change",this.toggleList);this.render()},render:function(){this.$el.empty();this.collection.each(this.addOne,this);this.toggleList()},addOne:function(f){var e;f.set({collection:this.collection});e=new c.HeaderTool.ChoiceView({model:f});this.$el.append(e.render().el)},toggleList:function(){var f=this.$el.parents().prev(".customize-control-title"),e=this.$el.find(".random").parent();if(this.collection.shouldHideTitle()){f.add(e).hide()}else{f.add(e).show()}}});c.HeaderTool.CombinedList=b.Backbone.View.extend({initialize:function(e){this.collections=e;this.on("all",this.propagate,this)},propagate:function(f,e){a.each(this.collections,function(g){g.trigger(f,e)})}})})(jQuery,window.wp,_);