wp.customize.navMenusPreview=wp.customize.MenusCustomizerPreview=function(g,f,j,i){var h={data:{navMenuInstanceArgs:{}}};return"undefined"!=typeof _wpCustomizePreviewNavMenusExports&&f.extend(h.data,_wpCustomizePreviewNavMenusExports),h.init=function(){var b=this,d=!1;i.preview.bind("sync",function(){d=!0}),i.selectiveRefresh&&(i.each(function(a){b.bindSettingListener(a)}),i.bind("add",function(a){a.get()&&!a.get()._invalid&&b.bindSettingListener(a,{fire:d})}),i.bind("remove",function(a){b.unbindSettingListener(a)}),i.selectiveRefresh.bind("render-partials-response",function(a){a.nav_menu_instance_args&&f.extend(b.data.navMenuInstanceArgs,a.nav_menu_instance_args)})),i.preview.bind("active",function(){b.highlightControls()})},i.selectiveRefresh&&(h.NavMenuInstancePartial=i.selectiveRefresh.Partial.extend({initialize:function(b,m){var l,k,d=this;if(l=b.match(/^nav_menu_instance\[([0-9a-f]{32})]$/),!l){throw new Error("Illegal id for nav_menu_instance partial. The key corresponds with the args HMAC.")}if(k=l[1],m=m||{},m.params=f.extend({selector:'[data-customize-partial-id="'+b+'"]',navMenuArgs:m.constructingContainerContext||{},containerInclusive:!0},m.params||{}),i.selectiveRefresh.Partial.prototype.initialize.call(d,b,m),!f.isObject(d.params.navMenuArgs)){throw new Error("Missing navMenuArgs")}if(d.params.navMenuArgs.args_hmac!==k){throw new Error("args_hmac mismatch with id")}},isRelatedSetting:function(t,s,r){var q,p,o,n,m,d,b=this;if(f.isString(t)&&(t=i(t)),o=/^nav_menu_item\[/.test(t.id),o&&f.isObject(s)&&f.isObject(r)&&(n=f.clone(s),m=f.clone(r),delete n.type_label,delete m.type_label,"https"===i.preview.scheme.get()&&(d=document.createElement("a"),d.href=n.url,d.protocol="https:",n.url=d.href,d.href=m.url,d.protocol="https:",m.url=d.href),s.title&&(delete m.original_title,delete n.original_title),f.isEqual(m,n))){return !1}if(b.params.navMenuArgs.theme_location){if("nav_menu_locations["+b.params.navMenuArgs.theme_location+"]"===t.id){return !0}q=i("nav_menu_locations["+b.params.navMenuArgs.theme_location+"]")}return p=b.params.navMenuArgs.menu,!p&&q&&(p=q()),!!p&&("nav_menu["+p+"]"===t.id||o&&(s&&s.nav_menu_term_id===p||r&&r.nav_menu_term_id===p))},refresh:function(){var d,b=this,a=g.Deferred();return f.isNumber(b.params.navMenuArgs.menu)?d=b.params.navMenuArgs.menu:b.params.navMenuArgs.theme_location&&i.has("nav_menu_locations["+b.params.navMenuArgs.theme_location+"]")&&(d=i("nav_menu_locations["+b.params.navMenuArgs.theme_location+"]").get()),d?i.selectiveRefresh.Partial.prototype.refresh.call(b):(b.fallback(),a.reject(),a.promise())},renderContent:function(a){var k=this,d=a.container;""===a.addedContent&&a.partial.fallback(),i.selectiveRefresh.Partial.prototype.renderContent.call(k,a)&&g(document).trigger("customize-preview-menu-refreshed",[{instanceNumber:null,wpNavArgs:a.context,wpNavMenuArgs:a.context,oldContainer:d,newContainer:a.container}])}}),i.selectiveRefresh.partialConstructor.nav_menu_instance=h.NavMenuInstancePartial,h.handleUnplacedNavMenuInstances=function(b){var d;return d=f.filter(f.values(h.data.navMenuInstanceArgs),function(c){return !i.selectiveRefresh.partial.has("nav_menu_instance["+c.args_hmac+"]")}),!!f.findWhere(d,b)&&(i.selectiveRefresh.requestFullRefresh(),!0)},h.bindSettingListener=function(e,d){var k;return d=d||{},(k=e.id.match(/^nav_menu\[(-?\d+)]$/))?(e._navMenuId=parseInt(k[1],10),e.bind(this.onChangeNavMenuSetting),d.fire&&this.onChangeNavMenuSetting.call(e,e(),!1),!0):(k=e.id.match(/^nav_menu_item\[(-?\d+)]$/))?(e._navMenuItemId=parseInt(k[1],10),e.bind(this.onChangeNavMenuItemSetting),d.fire&&this.onChangeNavMenuItemSetting.call(e,e(),!1),!0):(k=e.id.match(/^nav_menu_locations\[(.+?)]/),!!k&&(e._navMenuThemeLocation=k[1],e.bind(this.onChangeNavMenuLocationsSetting),d.fire&&this.onChangeNavMenuLocationsSetting.call(e,e(),!1),!0))},h.unbindSettingListener=function(b){b.unbind(this.onChangeNavMenuSetting),b.unbind(this.onChangeNavMenuItemSetting),b.unbind(this.onChangeNavMenuLocationsSetting)},h.onChangeNavMenuSetting=function(){var b=this;h.handleUnplacedNavMenuInstances({menu:b._navMenuId}),i.each(function(a){a._navMenuThemeLocation&&b._navMenuId===a()&&h.handleUnplacedNavMenuInstances({theme_location:a._navMenuThemeLocation})})},h.onChangeNavMenuItemSetting=function(e,d){var l,k=e||d;l=i("nav_menu["+String(k.nav_menu_term_id)+"]"),l&&h.onChangeNavMenuSetting.call(l)},h.onChangeNavMenuLocationsSetting=function(){var b,d=this;h.handleUnplacedNavMenuInstances({theme_location:d._navMenuThemeLocation}),b=!!f.findWhere(f.values(h.data.navMenuInstanceArgs),{theme_location:d._navMenuThemeLocation}),b||i.selectiveRefresh.requestFullRefresh()}),h.highlightControls=function(){var a=".menu-item";i.settings.channel&&g(document).on("click",a,function(d){var e;d.shiftKey&&(e=g(this).attr("class").match(/(?:^|\s)menu-item-(-?\d+)(?:\s|$)/),e&&(d.preventDefault(),d.stopPropagation(),i.preview.send("focus-nav-menu-item-control",parseInt(e[1],10))))})},i.bind("preview-ready",function(){h.init()}),h}(jQuery,_,wp,wp.customize);