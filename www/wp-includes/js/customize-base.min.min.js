window.wp=window.wp||{};(function(i,m){var h={},n,j,k=Array.prototype.slice;n=function(){};j=function(c,d,b){var a;if(d&&d.hasOwnProperty("constructor")){a=d.constructor}else{a=function(){var e=c.apply(this,arguments);return e}}m.extend(a,c);n.prototype=c.prototype;a.prototype=new n();if(d){m.extend(a.prototype,d)}if(b){m.extend(a,b)}a.prototype.constructor=a;a.__super__=c.prototype;return a};h.Class=function(a,b,d){var c,e=arguments;if(a&&b&&h.Class.applicator===a){e=b;m.extend(this,d||{})}c=this;if(this.instance){c=function(){return c.instance.apply(c,arguments)};m.extend(c,this)}c.initialize.apply(c,e);return c};h.Class.extend=function(c,b){var a=j(this,c,b);a.extend=this.extend;return a};h.Class.applicator={};h.Class.prototype.initialize=function(){};h.Class.prototype.extended=function(b){var a=this;while(typeof a.constructor!=="undefined"){if(a.constructor===b){return true}if(typeof a.constructor.__super__==="undefined"){return false}a=a.constructor.__super__}return false};h.Events={trigger:function(a){if(this.topics&&this.topics[a]){this.topics[a].fireWith(this,k.call(arguments,1))}return this},bind:function(a){this.topics=this.topics||{};this.topics[a]=this.topics[a]||m.Callbacks();this.topics[a].add.apply(this.topics[a],k.call(arguments,1));return this},unbind:function(a){if(this.topics&&this.topics[a]){this.topics[a].remove.apply(this.topics[a],k.call(arguments,1))}return this}};h.Value=h.Class.extend({initialize:function(a,b){this._value=a;this.callbacks=m.Callbacks();this._dirty=false;m.extend(this,b||{});this.set=m.proxy(this.set,this)},instance:function(){return arguments.length?this.set.apply(this,arguments):this.get()},get:function(){return this._value},set:function(a){var b=this._value;a=this._setter.apply(this,arguments);a=this.validate(a);if(null===a||_.isEqual(b,a)){return this}this._value=a;this._dirty=true;this.callbacks.fireWith(this,[a,b]);return this},_setter:function(a){return a},setter:function(a){var b=this.get();this._setter=a;this._value=null;this.set(b);return this},resetSetter:function(){this._setter=this.constructor.prototype._setter;this.set(this.get());return this},validate:function(a){return a},bind:function(){this.callbacks.add.apply(this.callbacks,arguments);return this},unbind:function(){this.callbacks.remove.apply(this.callbacks,arguments);return this},link:function(){var a=this.set;m.each(arguments,function(){this.bind(a)});return this},unlink:function(){var a=this.set;m.each(arguments,function(){this.unbind(a)});return this},sync:function(){var a=this;m.each(arguments,function(){a.link(this);this.link(a)});return this},unsync:function(){var a=this;m.each(arguments,function(){a.unlink(this);this.unlink(a)});return this}});h.Values=h.Class.extend({defaultConstructor:h.Value,initialize:function(a){m.extend(this,a||{});this._value={};this._deferreds={}},instance:function(a){if(arguments.length===1){return this.value(a)}return this.when.apply(this,arguments)},value:function(a){return this._value[a]},has:function(a){return typeof this._value[a]!=="undefined"},add:function(a,b){if(this.has(a)){return this.value(a)}this._value[a]=b;b.parent=this;if(b.extended(h.Value)){b.bind(this._change)}this.trigger("add",b);if(this._deferreds[a]){this._deferreds[a].resolve()}return this._value[a]},create:function(a){return this.add(a,new this.defaultConstructor(h.Class.applicator,k.call(arguments,1)))},each:function(a,b){b=typeof b==="undefined"?this:b;m.each(this._value,function(d,c){a.call(b,c,d)})},remove:function(a){var b;if(this.has(a)){b=this.value(a);this.trigger("remove",b);if(b.extended(h.Value)){b.unbind(this._change)}delete b.parent}delete this._value[a];delete this._deferreds[a]},when:function(){var b=this,a=k.call(arguments),c=m.Deferred();if(m.isFunction(a[a.length-1])){c.done(a.pop())}m.when.apply(m,m.map(a,function(d){if(b.has(d)){return}return b._deferreds[d]=b._deferreds[d]||m.Deferred()})).done(function(){var d=m.map(a,function(e){return b(e)});if(d.length!==a.length){b.when.apply(b,a).done(function(){c.resolveWith(b,d)});return}c.resolveWith(b,d)});return c.promise()},_change:function(){this.parent.trigger("change",this)}});m.extend(h.Values.prototype,h.Events);h.ensure=function(a){return typeof a=="string"?m(a):a};h.Element=h.Value.extend({initialize:function(d,e){var f=this,a=h.Element.synchronizer.html,b,g,c;this.element=h.ensure(d);this.events="";if(this.element.is("input, select, textarea")){this.events+="change";a=h.Element.synchronizer.val;if(this.element.is("input")){b=this.element.prop("type");if(h.Element.synchronizer[b]){a=h.Element.synchronizer[b]}if("text"===b||"password"===b){this.events+=" keyup"}else{if("range"===b){this.events+=" input propertychange"}}}else{if(this.element.is("textarea")){this.events+=" keyup"}}}h.Value.prototype.initialize.call(this,null,m.extend(e||{},a));this._value=this.get();g=this.update;c=this.refresh;this.update=function(p){if(p!==c.call(f)){g.apply(this,arguments)}};this.refresh=function(){f.set(c.call(f))};this.bind(this.update);this.element.bind(this.events,this.refresh)},find:function(a){return m(a,this.element)},refresh:function(){},update:function(){}});h.Element.synchronizer={};m.each(["html","val"],function(b,a){h.Element.synchronizer[a]={update:function(c){this.element[a](c)},refresh:function(){return this.element[a]()}}});h.Element.synchronizer.checkbox={update:function(a){this.element.prop("checked",a)},refresh:function(){return this.element.prop("checked")}};h.Element.synchronizer.radio={update:function(a){this.element.filter(function(){return this.value===a}).prop("checked",true)},refresh:function(){return this.element.filter(":checked").val()}};m.support.postMessage=!!window.postMessage;h.Messenger=h.Class.extend({add:function(a,b,c){return this[a]=new h.Value(b,c)},initialize:function(a,c){var b=window.parent===window?null:window.parent;m.extend(this,c||{});this.add("channel",a.channel);this.add("url",a.url||"");this.add("origin",this.url()).link(this.url).setter(function(d){var e=document.createElement("a");e.href=d;return e.protocol+"//"+e.host.replace(/:(80|443)$/,"")});this.add("targetWindow",null);this.targetWindow.set=function(d){var e=this._value;d=this._setter.apply(this,arguments);d=this.validate(d);if(null===d||e===d){return this}this._value=d;this._dirty=true;this.callbacks.fireWith(this,[d,e]);return this};this.targetWindow(a.targetWindow||b);this.receive=m.proxy(this.receive,this);this.receive.guid=m.guid++;m(window).on("message",this.receive)},destroy:function(){m(window).off("message",this.receive)},receive:function(a){var b;a=a.originalEvent;if(!this.targetWindow||!this.targetWindow()){return}if(this.origin()&&a.origin!==this.origin()){return}if(typeof a.data!=="string"||a.data[0]!=="{"){return}b=JSON.parse(a.data);if(!b||!b.id||typeof b.data==="undefined"){return}if((b.channel||this.channel())&&this.channel()!==b.channel){return}this.trigger(b.id,b.data)},send:function(a,b){var c;b=typeof b==="undefined"?null:b;if(!this.url()||!this.targetWindow()){return}c={id:a,data:b};if(this.channel()){c.channel=this.channel()}this.targetWindow().postMessage(JSON.stringify(c),this.origin())}});m.extend(h.Messenger.prototype,h.Events);h.Notification=h.Class.extend({initialize:function(b,a){var c;this.code=b;c=_.extend({message:null,type:"error",fromServer:false,data:null,setting:null},a);delete c.code;_.extend(this,c)}});h=m.extend(new h.Values(),h);h.get=function(){var a={};this.each(function(b,c){a[c]=b.get()});return a};h.utils={};h.utils.parseQueryString=function l(a){var b={};_.each(a.split("&"),function(c){var d,f,e;d=c.split("=",2);if(!d[0]){return}f=decodeURIComponent(d[0].replace(/\+/g," "));f=f.replace(/ /g,"_");if(_.isUndefined(d[1])){e=null}else{e=decodeURIComponent(d[1].replace(/\+/g," "))}b[f]=e});return b};i.customize=h})(wp,jQuery);