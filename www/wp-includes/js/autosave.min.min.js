window.autosave=function(){return true};(function(f,d){function e(){var o,b=0,r=f(document);function n(j){var k,h,i,g=(new Date()).getTime(),m=[],l=s();if(l&&l.isDirty()&&!l.isHidden()&&g-3000>b){l.save();b=g}i={post_id:f("#post_ID").val()||0,post_type:f("#post_type").val()||"",post_author:f("#post_author").val()||"",post_title:f("#title").val()||"",content:f("#content").val()||"",excerpt:f("#excerpt").val()||""};if(j==="local"){return i}f('input[id^="in-category-"]:checked').each(function(){m.push(this.value)});i.catslist=m.join(",");if(k=f("#post_name").val()){i.post_name=k}if(h=f("#parent_id").val()){i.parent_id=h}if(f("#comment_status").prop("checked")){i.comment_status="open"}if(f("#ping_status").prop("checked")){i.ping_status="open"}if(f("#auto_draft").val()==="1"){i.auto_draft="1"}return i}function t(g){if(typeof g==="object"){return(g.post_title||"")+"::"+(g.content||"")+"::"+(g.excerpt||"")}return(f("#title").val()||"")+"::"+(f("#content").val()||"")+"::"+(f("#excerpt").val()||"")}function a(){r.trigger("autosave-disable-buttons");setTimeout(c,5000)}function c(){r.trigger("autosave-enable-buttons")}function s(){return typeof tinymce!=="undefined"&&tinymce.get("content")}function q(){var I,g,P,H,K,j=false;function M(){var u=Math.random().toString(),w=false;try{d.sessionStorage.setItem("wp-test",u);w=d.sessionStorage.getItem("wp-test")===u;d.sessionStorage.removeItem("wp-test")}catch(v){}P=w;return w}function O(){var u=false;if(P&&I){u=sessionStorage.getItem("wp-autosave-"+I);if(u){u=JSON.parse(u)}else{u={}}}return u}function F(v){var u;if(P&&I){u="wp-autosave-"+I;sessionStorage.setItem(u,JSON.stringify(v));return sessionStorage.getItem(u)!==null}return false}function J(){var u=O();if(!u||!g){return false}return u["post_"+g]||false}function G(v){var u=O();if(!u||!g){return false}if(v){u["post_"+g]=v}else{if(u.hasOwnProperty("post_"+g)){delete u["post_"+g]}else{return false}}return F(u)}function i(){j=true}function N(){j=false}function h(u){var w,v,x=false;if(j||!P){return false}if(u){w=J()||{};f.extend(w,u)}else{w=n("local")}v=t(w);if(typeof K==="undefined"){K=o}if(v===K){return false}w.save_time=(new Date()).getTime();w.status=f("#post_status").val()||"";x=G(w);if(x){K=v}return x}function k(){g=f("#post_ID").val()||0;if(f("#wp-content-wrap").hasClass("tmce-active")){r.on("tinymce-editor-init.autosave",function(){d.setTimeout(function(){L()},1500)})}else{L()}H=d.setInterval(h,15000);f("form#post").on("submit.autosave-local",function(){var v=s(),w=f("#post_ID").val()||0;if(v&&!v.isHidden()){v.on("submit",function(){h({post_title:f("#title").val()||"",content:f("#content").val()||"",excerpt:f("#excerpt").val()||""})})}else{h({post_title:f("#title").val()||"",content:f("#content").val()||"",excerpt:f("#excerpt").val()||""})}var u=("https:"===d.location.protocol);wpCookies.set("wp-saving-post",w+"-check",24*60*60,false,false,u)})}function m(u,v){function w(x){return x.toString().replace(/[\x20\t\r\n\f]+/g,"")}return(w(u||"")===w(v||""))}function L(){var v,w,A,B,z=J(),y=wpCookies.get("wp-saving-post"),u=f("#has-newer-autosave").parent(".notice"),x=f(".wp-header-end");if(y===g+"-saved"){wpCookies.remove("wp-saving-post");G(false);return}if(!z){return}v=f("#content").val()||"";w=f("#title").val()||"";A=f("#excerpt").val()||"";if(m(v,z.content)&&m(w,z.post_title)&&m(A,z.excerpt)){return}if(!x.length){x=f(".wrap h1, .wrap h2").first()}B=f("#local-storage-notice").insertAfter(x).addClass("notice-warning");if(u.length){u.slideUp(150,function(){B.slideDown(150)})}else{B.slideDown(200)}B.find(".restore-backup").on("click.autosave-local",function(){l(z);B.fadeTo(250,0,function(){B.slideUp(150)})})}function l(v){var u;if(v){K=t(v);if(f("#title").val()!==v.post_title){f("#title").focus().val(v.post_title||"")}f("#excerpt").val(v.excerpt||"");u=s();if(u&&!u.isHidden()&&typeof switchEditors!=="undefined"){if(u.settings.wpautop&&v.content){v.content=switchEditors.wpautop(v.content)}u.undoManager.transact(function(){u.setContent(v.content||"");u.nodeChanged()})}else{f("#content-html").click();f("#content").focus();document.execCommand("selectAll");document.execCommand("insertText",false,v.content||"")}return true}return false}I=typeof d.autosaveL10n!=="undefined"&&d.autosaveL10n.blog_id;if(M()&&I&&(f("#content").length||f("#excerpt").length)){r.ready(k)}return{hasStorage:P,getSavedPostData:J,save:h,suspend:i,resume:N}}function p(){var h,k,F,m,i=0,l=false;function B(){h=true;d.clearTimeout(k);k=d.setTimeout(function(){h=false},10000)}function E(){l=true}function H(){l=false}function G(u){D();h=false;m=F;F="";r.trigger("after-autosave",[u]);c();if(u.success){f("#auto_draft").val("")}}function g(){i=0;wp.heartbeat.connectNow()}function j(){return t()!==o}function C(){var v,u;if(l||h||!d.autosave()){return false}if((new Date()).getTime()<i){return false}v=n();u=t(v);if(typeof m==="undefined"){m=o}if(u===m){return false}F=u;B();a();r.trigger("wpcountwords",[v.content]).trigger("before-autosave",[v]);v._wpnonce=f("#_wpnonce").val()||"";return v}function D(){i=(new Date()).getTime()+(autosaveL10n.autosaveInterval*1000)||60000}r.on("heartbeat-send.autosave",function(v,u){var w=C();if(w){u.wp_autosave=w}}).on("heartbeat-tick.autosave",function(v,u){if(u.wp_autosave){G(u.wp_autosave)}}).on("heartbeat-connection-lost.autosave",function(v,w,x){if("timeout"===w||603===x){var u=f("#lost-connection-notice");if(!wp.autosave.local.hasStorage){u.find(".hide-if-no-sessionstorage").hide()}u.show();a()}}).on("heartbeat-connection-restored.autosave",function(){f("#lost-connection-notice").hide();c()}).ready(function(){D()});return{tempBlockSave:B,triggerSave:g,postChanged:j,suspend:E,resume:H}}r.on("tinymce-editor-init.autosave",function(g,h){if(h.id==="content"){d.setTimeout(function(){h.save();o=t()},1000)}}).ready(function(){o=t()});return{getPostData:n,getCompareString:t,disableButtons:a,enableButtons:c,local:q(),server:p()}}d.wp=d.wp||{};d.wp.autosave=e()}(jQuery,window));