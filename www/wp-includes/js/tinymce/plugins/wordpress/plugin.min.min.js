!function(b){b.ui.FloatPanel.zIndex=100100,b.PluginManager.add("wordpress",function(v){function u(l){var k,h,g,e=0;h="hide"===l,v.theme.panel&&(g=v.theme.panel.find(".toolbar:not(.menubar)")),!g||g.length<2||"hide"===l&&!g[1].visible()||(!l&&g[1].visible()&&(l="hide"),p(g,function(d,c){c>0&&("hide"===l?(d.hide(),e+=30):(d.show(),e-=30))}),e&&!h&&(b.Env.iOS||(k=v.getContentAreaContainer().firstChild,q.setStyle(k,"height",k.clientHeight+e)),"hide"===l?(setUserSetting("hidetb","0"),s&&s.active(!1)):(setUserSetting("hidetb","1"),s&&s.active(!0))),v.fire("wp-toolbar-toggle"))}function t(){}var s,r,q=b.DOM,p=b.each,o=v.editorManager.i18n.translate,n=window.jQuery,m=window.wp,a=m&&m.editor&&m.editor.autop&&v.getParam("wpautop",!0);return n&&n(document).triggerHandler("tinymce-editor-setup",[v]),v.addButton("wp_adv",{tooltip:"Toolbar Toggle",cmd:"WP_Adv",onPostRender:function(){s=this,s.active("1"===getUserSetting("hidetb"))}}),v.on("PostRender",function(){v.getParam("wordpress_adv_hidden",!0)&&"0"===getUserSetting("hidetb","0")&&u("hide")}),v.addCommand("WP_Adv",function(){u()}),v.on("focus",function(){window.wpActiveEditor=v.id}),v.on("BeforeSetContent",function(d){var e;d.content&&(d.content.indexOf("<!--more")!==-1&&(e=o("Read more..."),d.content=d.content.replace(/<!--more(.*?)-->/g,function(c,f){return'<img src="'+b.Env.transparentSrc+'" data-wp-more="more" data-wp-more-text="'+f+'" class="wp-more-tag mce-wp-more" alt="" title="'+e+'" data-mce-resize="false" data-mce-placeholder="1" />'})),d.content.indexOf("<!--nextpage-->")!==-1&&(e=o("Page break"),d.content=d.content.replace(/<!--nextpage-->/g,'<img src="'+b.Env.transparentSrc+'" data-wp-more="nextpage" class="wp-more-tag mce-wp-nextpage" alt="" title="'+e+'" data-mce-resize="false" data-mce-placeholder="1" />')),d.load&&"raw"!==d.format&&a&&(d.content=m.editor.autop(d.content)),d.content.indexOf("<script")===-1&&d.content.indexOf("<style")===-1||(d.content=d.content.replace(/<(script|style)[^>]*>[\s\S]*?<\/\1>/g,function(f,g){return'<img src="'+b.Env.transparentSrc+'" data-wp-preserve="'+encodeURIComponent(f)+'" data-mce-resize="false" data-mce-placeholder="1" class="mce-object" width="20" height="20" alt="&lt;'+g+'&gt;" title="&lt;'+g+'&gt;" />'})),d.content=d.content.replace(/<p>([^<>]+)<\/p>/gi,function(f,c){return"&nbsp;"!==c&&/\S/.test(c)?f:"<p><br /></p>"}))}),v.on("PostProcess",function(c){c.get&&(c.content=c.content.replace(/<img[^>]+>/g,function(f){var e,h,g="";return f.indexOf('data-wp-more="more"')!==-1?((e=f.match(/data-wp-more-text="([^"]+)"/))&&(g=e[1]),h="<!--more"+g+"-->"):f.indexOf('data-wp-more="nextpage"')!==-1?h="<!--nextpage-->":f.indexOf("data-wp-preserve")!==-1&&(e=f.match(/ data-wp-preserve="([^"]+)"/))&&(h=decodeURIComponent(e[1])),h||f}))}),v.on("ResolveName",function(d){var e;"IMG"===d.target.nodeName&&(e=v.dom.getAttrib(d.target,"data-wp-more"))&&(d.name=e)}),v.addCommand("WP_More",function(z){var y,x,w,l="wp-more-tag",k=v.dom,i=v.selection.getNode();return z=z||"more",l+=" mce-wp-"+z,w="more"===z?"Read more...":"Next page",w=o(w),x='<img src="'+b.Env.transparentSrc+'" alt="" title="'+w+'" class="'+l+'" data-wp-more="'+z+'" data-mce-resize="false" data-mce-placeholder="1" />',"BODY"===i.nodeName||"P"===i.nodeName&&"BODY"===i.parentNode.nodeName?void v.insertContent(x):(y=k.getParent(i,function(c){return !(!c.parentNode||"BODY"!==c.parentNode.nodeName)},v.getBody()),void (y&&("P"===y.nodeName?y.appendChild(k.create("p",null,x).firstChild):k.insertAfter(k.create("p",null,x),y),v.nodeChanged())))}),v.addCommand("WP_Code",function(){v.formatter.toggle("code")}),v.addCommand("WP_Page",function(){v.execCommand("WP_More","nextpage")}),v.addCommand("WP_Help",function(){function H(f,e){var j="<tr>",g=0;for(e=e||1,p(f,function(d,c){j+="<td><kbd>"+c+"</kbd></td><td>"+o(d)+"</td>",g++});g<e;){j+="<td></td><td></td>",g++}return j+"</tr>"}var G,F,E,D,C=o(b.Env.mac?"Ctrl + Alt + letter:":"Shift + Alt + letter:"),B=o(b.Env.mac?"Cmd + letter:":"Ctrl + letter:"),A=[],z=[],y={},x={},w=0,i=0,h=v.settings.wp_shortcut_labels;h&&(p(h,function(e,c){var f;e.indexOf("meta")!==-1?(w++,f=e.replace("meta","").toLowerCase(),f&&(y[f]=c,w%2===0&&(A.push(H(y,2)),y={}))):e.indexOf("access")!==-1&&(i++,f=e.replace("access","").toLowerCase(),f&&(x[f]=c,i%2===0&&(z.push(H(x,2)),x={})))}),w%2>0&&A.push(H(y,2)),i%2>0&&z.push(H(x,2)),G=[o("Letter"),o("Action"),o("Letter"),o("Action")],G="<tr><th>"+G.join("</th><th>")+"</th></tr>",F='<div class="wp-editor-help">',F=F+"<h2>"+o("Default shortcuts,")+" "+B+'</h2><table class="wp-help-th-center fixed">'+G+A.join("")+"</table><h2>"+o("Additional shortcuts,")+" "+C+'</h2><table class="wp-help-th-center fixed">'+G+z.join("")+"</table>",v.plugins.wptextpattern&&(!b.Env.ie||b.Env.ie>8)&&(F=F+"<h2>"+o("When starting a new paragraph with one of these formatting shortcuts followed by a space, the formatting will be applied automatically. Press Backspace or Escape to undo.")+'</h2><table class="wp-help-th-center fixed">'+H({"*":"Bullet list","1.":"Numbered list"})+H({"-":"Bullet list","1)":"Numbered list"})+"</table>",F=F+"<h2>"+o("The following formatting shortcuts are replaced when pressing Enter. Press Escape or the Undo button to undo.")+'</h2><table class="wp-help-single">'+H({">":"Blockquote"})+H({"##":"Heading 2"})+H({"###":"Heading 3"})+H({"####":"Heading 4"})+H({"#####":"Heading 5"})+H({"######":"Heading 6"})+H({"---":"Horizontal line"})+"</table>"),F=F+"<h2>"+o("Focus shortcuts:")+'</h2><table class="wp-help-single">'+H({"Alt + F8":"Inline toolbar (when an image, link or preview is selected)"})+H({"Alt + F9":"Editor menu (when enabled)"})+H({"Alt + F10":"Editor toolbar"})+H({"Alt + F11":"Elements path"})+"</table><p>"+o("To move focus to other buttons use Tab or the arrow keys. To return focus to the editor press Escape or use one of the buttons.")+"</p>",F+="</div>",E=v.windowManager.open({title:"Keyboard Shortcuts",items:{type:"container",classes:"wp-help",html:F},buttons:{text:"Close",onclick:"close"}}),E.$el&&(E.$el.find('div[role="application"]').attr("role","document"),D=E.$el.find(".mce-wp-help"),D[0]&&(D.attr("tabindex","0"),D[0].focus(),D.on("keydown",function(c){c.keyCode>=33&&c.keyCode<=40&&c.stopPropagation()}))))}),v.addCommand("WP_Medialib",function(){m&&m.media&&m.media.editor&&m.media.editor.open(v.id)}),v.addButton("wp_more",{tooltip:"Insert Read More tag",onclick:function(){v.execCommand("WP_More","more")}}),v.addButton("wp_page",{tooltip:"Page break",onclick:function(){v.execCommand("WP_More","nextpage")}}),v.addButton("wp_help",{tooltip:"Keyboard Shortcuts",cmd:"WP_Help"}),v.addButton("wp_code",{tooltip:"Code",cmd:"WP_Code",stateSelector:"code"}),m&&m.media&&m.media.editor&&v.addMenuItem("add_media",{text:"Add Media",icon:"wp-media-library",context:"insert",cmd:"WP_Medialib"}),v.addMenuItem("wp_more",{text:"Insert Read More tag",icon:"wp_more",context:"insert",onclick:function(){v.execCommand("WP_More","more")}}),v.addMenuItem("wp_page",{text:"Page break",icon:"wp_page",context:"insert",onclick:function(){v.execCommand("WP_More","nextpage")}}),v.on("BeforeExecCommand",function(d){!b.Env.webkit||"InsertUnorderedList"!==d.command&&"InsertOrderedList"!==d.command||(r||(r=v.dom.create("style",{type:"text/css"},"#tinymce,#tinymce span,#tinymce li,#tinymce li>span,#tinymce p,#tinymce p>span{font:medium sans-serif;color:#000;line-height:normal;}")),v.getDoc().head.appendChild(r))}),v.on("ExecCommand",function(d){b.Env.webkit&&r&&("InsertUnorderedList"===d.command||"InsertOrderedList"===d.command)&&v.dom.remove(r)}),v.on("init",function(){var z=b.Env,y=["mceContentBody"],x=v.getDoc(),w=v.dom;if(z.iOS&&w.addClass(x.documentElement,"ios"),"rtl"===v.getParam("directionality")&&(y.push("rtl"),w.setAttrib(x.documentElement,"dir","rtl")),w.setAttrib(x.documentElement,"lang",v.getParam("wp_lang_attr")),z.ie?9===parseInt(z.ie,10)?y.push("ie9"):8===parseInt(z.ie,10)?y.push("ie8"):z.ie<8&&y.push("ie7"):z.webkit&&y.push("webkit"),y.push("wp-editor"),p(y,function(c){c&&w.addClass(x.body,c)}),v.on("BeforeSetContent",function(c){c.content&&(c.content=c.content.replace(/<p>\s*<(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)( [^>]*)?>/gi,"<$1$2>").replace(/<\/(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)>\s*<\/p>/gi,"</$1>"))}),n&&n(document).triggerHandler("tinymce-editor-init",[v]),window.tinyMCEPreInit&&window.tinyMCEPreInit.dragDropUpload&&w.bind(x,"dragstart dragend dragover drop",function(c){n&&n(document).trigger(new n.Event(c))}),v.getParam("wp_paste_filters",!0)&&(v.on("PastePreProcess",function(c){c.content=c.content.replace(/<br class="?Apple-interchange-newline"?>/gi,""),b.Env.webkit||(c.content=c.content.replace(/(<[^>]+) style="[^"]*"([^>]*>)/gi,"$1$2"),c.content=c.content.replace(/(<[^>]+) data-mce-style=([^>]+>)/gi,"$1 style=$2"))}),v.on("PastePostProcess",function(c){p(w.select("p",c.node),function(d){w.isEmpty(d)&&w.remove(d)})})),v.settings.wp_shortcut_labels&&v.theme.panel){var l={},j="Shift+Alt+",h="Ctrl+";b.Env.mac&&(j="\u2303\u2325",h="\u2318"),p(v.settings.wp_shortcut_labels,function(d,c){l[c]=d.replace("access",j).replace("meta",h)}),p(v.theme.panel.find("button"),function(c){c&&c.settings.tooltip&&l.hasOwnProperty(c.settings.tooltip)&&(c.settings.tooltip=v.translate(c.settings.tooltip)+" ("+l[c.settings.tooltip]+")")}),p(v.theme.panel.find("listbox"),function(c){c&&"Paragraph"===c.settings.text&&p(c.settings.values,function(d){d.text&&l.hasOwnProperty(d.text)&&(d.shortcut="("+l[d.text]+")")})})}}),v.on("SaveContent",function(c){return !v.inline&&v.isHidden()?void (c.content=c.element.value):(c.content=c.content.replace(/<p>(?:<br ?\/?>|\u00a0|\uFEFF| )*<\/p>/g,"<p>&nbsp;</p>"),void (a&&(c.content=m.editor.removep(c.content))))}),v.on("preInit",function(){var d="@[id|accesskey|class|dir|lang|style|tabindex|title|contenteditable|draggable|dropzone|hidden|spellcheck|translate],i,b,script[src|async|defer|type|charset|crossorigin|integrity]";v.schema.addValidElements(d),b.Env.iOS&&(v.settings.height=300),p({c:"JustifyCenter",r:"JustifyRight",l:"JustifyLeft",j:"JustifyFull",q:"mceBlockQuote",u:"InsertUnorderedList",o:"InsertOrderedList",m:"WP_Medialib",z:"WP_Adv",t:"WP_More",d:"Strikethrough",h:"WP_Help",p:"WP_Page",x:"WP_Code"},function(e,f){v.shortcuts.add("access+"+f,"",e)}),v.addShortcut("meta+s","",function(){m&&m.autosave&&m.autosave.server.triggerSave()}),window.getUserSetting("editor_plain_text_paste_warning")>1&&(v.settings.paste_plaintext_inform=!1),b.Env.mac&&b.$(v.iframeElement).attr("title",o("Rich Text Area. Press Control-Option-H for help."))}),v.on("PastePlainTextToggle",function(d){if(d.state===!0){var c=parseInt(window.getUserSetting("editor_plain_text_paste_warning"),10)||0;c<2&&window.setUserSetting("editor_plain_text_paste_warning",++c)}}),v.on("preinit",function(){function G(I,H){function k(){if(!D){return this}var ai,ah,ag=window.pageXOffset||document.documentElement.scrollLeft,af=window.pageYOffset||document.documentElement.scrollTop,ae=window.innerWidth,ad=window.innerHeight,ac=g?g.getBoundingClientRect():{top:0,right:ae,bottom:ad,left:0,width:ae,height:ad},ab=this.getEl(),aa=ab.offsetWidth,X=ab.clientHeight,V=D.getBoundingClientRect(),T=(V.left+V.right)/2,R=5,P=X+R,N=h?h.getBoundingClientRect().bottom:0,L=B?B.getBoundingClientRect().bottom:0,K=A?ad-A.getBoundingClientRect().top:0,J=z?ad-z.getBoundingClientRect().top:0,Z=Math.max(0,N,L,ac.top),Y=Math.max(0,K,J,ad-ac.bottom),W=V.top+ac.top-Z,U=ad-ac.top-V.bottom-Y,S=ad-Z-Y,Q="",O=0,M=0;return W>=S||U>=S?(this.scrolling=!0,this.hide(),this.scrolling=!1,this):(b.Env.iOS&&"IMG"===D.nodeName&&(O=54,M=46),this.bottom?U>=P?(Q=" mce-arrow-up",ai=V.bottom+ac.top+af-M):W>=P&&(Q=" mce-arrow-down",ai=V.top+ac.top+af-X+O):W>=P?(Q=" mce-arrow-down",ai=V.top+ac.top+af-X+O):U>=P&&S/2>V.bottom+ac.top-Z&&(Q=" mce-arrow-up",ai=V.bottom+ac.top+af-M),"undefined"==typeof ai&&(ai=af+Z+R+M),ah=T-aa/2+ac.left+ag,V.left<0||V.right>ac.width?ah=ac.left+ag+(ac.width-aa)/2:aa>=ae?(Q+=" mce-arrow-full",ah=0):ah<0&&V.left+aa>ae||ah+aa>ae&&V.right-aa<0?ah=(ae-aa)/2:ah<ac.left+ag?(Q+=" mce-arrow-left",ah=V.left+ac.left+ag):ah+aa>ac.width+ac.left+ag&&(Q+=" mce-arrow-right",ah=V.right-aa+ac.left+ag),b.Env.iOS&&"IMG"===D.nodeName&&(Q=Q.replace(/ ?mce-arrow-(up|down)/g,"")),ab.className=ab.className.replace(/ ?mce-arrow-[\w]+/g,"")+Q,q.setStyles(ab,{left:ah,top:ai}),this)}var f,l,j=[];return p(I,function(e){function J(){var d=v.selection;"bullist"===i&&d.selectorChanged("ul > li",function(K,N){for(var M,L=N.parents.length;L--&&(M=N.parents[L].nodeName,"OL"!==M&&"UL"!=M);){}e.active(K&&"UL"===M)}),"numlist"===i&&d.selectorChanged("ol > li",function(K,N){for(var M,L=N.parents.length;L--&&(M=N.parents[L].nodeName,"OL"!==M&&"UL"!==M);){}e.active(K&&"OL"===M)}),e.settings.stateSelector&&d.selectorChanged(e.settings.stateSelector,function(c){e.active(c)},!0),e.settings.disabledStateSelector&&d.selectorChanged(e.settings.disabledStateSelector,function(c){e.disabled(c)})}var i;"|"===e?l=null:y.has(e)?(e={type:e},x.toolbar_items_size&&(e.size=x.toolbar_items_size),j.push(e),l=null):(l||(l={type:"buttongroup",items:[]},j.push(l)),v.buttons[e]&&(i=e,e=v.buttons[i],"function"==typeof e&&(e=e()),e.type=e.type||"button",x.toolbar_items_size&&(e.size=x.toolbar_items_size),e=y.create(e),l.items.push(e),v.initialized?J():v.on("init",J)))}),f=y.create({type:"panel",layout:"stack",classes:"toolbar-grp inline-toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:[{type:"toolbar",layout:"flow",items:j}]}),f.bottom=H,f.on("show",function(){this.reposition()}),f.on("keydown",function(c){27===c.keyCode&&(this.hide(),v.focus())}),v.on("remove",function(){f.remove()}),f.reposition=k,f.hide().renderTo(document.body),f}function F(c){E&&(E.tempHide||"hide"===c.type||"blur"===c.type?(E.hide(),E=!1):"resizewindow"!==c.type&&"scrollwindow"!==c.type&&"resize"!==c.type&&"scroll"!==c.type||E.blockHide||(clearTimeout(C),C=setTimeout(function(){E&&"function"==typeof E.show&&(E.scrolling=!1,E.show())},250),E.scrolling=!0,E.hide()))}var E,D,C,B,A,z,y=b.ui.Factory,x=v.settings,w=v.getContainer(),h=document.getElementById("wpadminbar"),g=document.getElementById(v.id+"_ifr");w&&(B=b.$(".mce-toolbar-grp",w)[0],A=b.$(".mce-statusbar",w)[0]),"content"===v.id&&(z=document.getElementById("post-status-info")),v.shortcuts.add("alt+119","",function(){var c;E&&(c=E.find("toolbar")[0],c&&c.focus(!0))}),v.on("nodechange",function(e){var i=v.selection.isCollapsed(),f={element:e.element,parents:e.parents,collapsed:i};v.fire("wptoolbar",f),D=f.selection||f.element,E&&E!==f.toolbar&&E.hide(),f.toolbar?E!==f.toolbar?(E=f.toolbar,E.show()):E.reposition():E=!1}),v.on("focus",function(){E&&E.show()}),v.on("resizewindow scrollwindow",F),v.dom.bind(v.getWin(),"resize scroll",F),v.on("remove",function(){v.off("resizewindow scrollwindow",F),v.dom.unbind(v.getWin(),"resize scroll",F)}),v.on("blur hide",F),v.wp=v.wp||{},v.wp._createToolbar=G},!0),{_showButtons:t,_hideButtons:t,_setEmbed:t,_getEmbed:t}})}(window.tinymce);