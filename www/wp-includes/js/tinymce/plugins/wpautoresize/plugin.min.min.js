tinymce.PluginManager.add("wpautoresize",function(t){function s(){return t.plugins.fullscreen&&t.plugins.fullscreen.isFullscreen()}function r(b){return parseInt(b,10)||0}function q(y){var x,w,v,j,i,h,d,c,b,a,B,A,z=tinymce.DOM;if(k&&(w=t.getDoc())){if(y=y||{},v=w.body,j=w.documentElement,i=m.autoresize_min_height,!v||y&&"setcontent"===y.type&&y.initial||s()){return void (v&&j&&(v.style.overflowY="auto",j.style.overflowY="auto"))}d=t.dom.getStyle(v,"margin-top",!0),c=t.dom.getStyle(v,"margin-bottom",!0),b=t.dom.getStyle(v,"padding-top",!0),a=t.dom.getStyle(v,"padding-bottom",!0),B=t.dom.getStyle(v,"border-top-width",!0),A=t.dom.getStyle(v,"border-bottom-width",!0),h=v.offsetHeight+r(d)+r(c)+r(b)+r(a)+r(B)+r(A),h&&h<j.offsetHeight&&(h=j.offsetHeight),(isNaN(h)||h<=0)&&(h=tinymce.Env.ie?v.scrollHeight:tinymce.Env.webkit&&0===v.clientHeight?0:v.offsetHeight),h>m.autoresize_min_height&&(i=h),m.autoresize_max_height&&h>m.autoresize_max_height?(i=m.autoresize_max_height,v.style.overflowY="auto",j.style.overflowY="auto"):(v.style.overflowY="hidden",j.style.overflowY="hidden",v.scrollTop=0),i!==l&&(x=i-l,z.setStyle(t.iframeElement,"height",i+"px"),l=i,tinymce.isWebKit&&x<0&&q(y),t.fire("wp-autoresize",{height:i,deltaHeight:"nodechange"===y.type?x:null}))}}function p(e,d,f){setTimeout(function(){q(),e--?p(e,d,f):f&&f()},d)}function o(){t.dom.hasClass(t.getBody(),"wp-autoresize")||(k=!0,t.dom.addClass(t.getBody(),"wp-autoresize"),t.on("nodechange setcontent keyup FullscreenStateChanged",q),q())}function n(){var a;m.wp_autoresize_on||(k=!1,a=t.getDoc(),t.dom.removeClass(t.getBody(),"wp-autoresize"),t.off("nodechange setcontent keyup FullscreenStateChanged",q),a.body.style.overflowY="auto",a.documentElement.style.overflowY="auto",l=0)}var m=t.settings,l=300,k=!1;t.settings.inline||tinymce.Env.iOS||(m.autoresize_min_height=parseInt(t.getParam("autoresize_min_height",t.getElement().offsetHeight),10),m.autoresize_max_height=parseInt(t.getParam("autoresize_max_height",0),10),m.wp_autoresize_on&&(k=!0,t.on("init",function(){t.dom.addClass(t.getBody(),"wp-autoresize")}),t.on("nodechange keyup FullscreenStateChanged",q),t.on("setcontent",function(){p(3,100)}),t.getParam("autoresize_on_init",!0)&&t.on("init",function(){p(10,200,function(){p(5,1000)})})),t.on("show",function(){l=0}),t.addCommand("wpAutoResize",q),t.addCommand("wpAutoResizeOn",o),t.addCommand("wpAutoResizeOff",n))});