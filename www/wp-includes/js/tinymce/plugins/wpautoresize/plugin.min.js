tinymce.PluginManager.add("wpautoresize",function(h){var e=h.settings,a=300,j=false;if(h.settings.inline||tinymce.Env.iOS){return}function g(){return h.plugins.fullscreen&&h.plugins.fullscreen.isFullscreen()}function b(k){return parseInt(k,10)||0}function c(s){var p,u,r,v,x=tinymce.DOM,n,l,k,q,w,m,o,t;if(!j){return}u=h.getDoc();if(!u){return}s=s||{};r=u.body;v=u.documentElement;n=e.autoresize_min_height;if(!r||(s&&s.type==="setcontent"&&s.initial)||g()){if(r&&v){r.style.overflowY="auto";v.style.overflowY="auto"}return}k=h.dom.getStyle(r,"margin-top",true);q=h.dom.getStyle(r,"margin-bottom",true);w=h.dom.getStyle(r,"padding-top",true);m=h.dom.getStyle(r,"padding-bottom",true);o=h.dom.getStyle(r,"border-top-width",true);t=h.dom.getStyle(r,"border-bottom-width",true);l=r.offsetHeight+b(k)+b(q)+b(w)+b(m)+b(o)+b(t);if(l&&l<v.offsetHeight){l=v.offsetHeight}if(isNaN(l)||l<=0){l=tinymce.Env.ie?r.scrollHeight:(tinymce.Env.webkit&&r.clientHeight===0?0:r.offsetHeight)}if(l>e.autoresize_min_height){n=l}if(e.autoresize_max_height&&l>e.autoresize_max_height){n=e.autoresize_max_height;r.style.overflowY="auto";v.style.overflowY="auto"}else{r.style.overflowY="hidden";v.style.overflowY="hidden";r.scrollTop=0}if(n!==a){p=n-a;x.setStyle(h.iframeElement,"height",n+"px");a=n;if(tinymce.isWebKit&&p<0){c(s)}h.fire("wp-autoresize",{height:n,deltaHeight:s.type==="nodechange"?p:null})}}function f(l,k,m){setTimeout(function(){c();if(l--){f(l,k,m)}else{if(m){m()}}},k)}e.autoresize_min_height=parseInt(h.getParam("autoresize_min_height",h.getElement().offsetHeight),10);e.autoresize_max_height=parseInt(h.getParam("autoresize_max_height",0),10);function i(){if(!h.dom.hasClass(h.getBody(),"wp-autoresize")){j=true;h.dom.addClass(h.getBody(),"wp-autoresize");h.on("nodechange setcontent keyup FullscreenStateChanged",c);c()}}function d(){var k;if(!e.wp_autoresize_on){j=false;k=h.getDoc();h.dom.removeClass(h.getBody(),"wp-autoresize");h.off("nodechange setcontent keyup FullscreenStateChanged",c);k.body.style.overflowY="auto";k.documentElement.style.overflowY="auto";a=0}}if(e.wp_autoresize_on){j=true;h.on("init",function(){h.dom.addClass(h.getBody(),"wp-autoresize")});h.on("nodechange keyup FullscreenStateChanged",c);h.on("setcontent",function(){f(3,100)});if(h.getParam("autoresize_on_init",true)){h.on("init",function(){f(10,200,function(){f(5,1000)})})}}h.on("show",function(){a=0});h.addCommand("wpAutoResize",c);h.addCommand("wpAutoResizeOn",i);h.addCommand("wpAutoResizeOff",d)});