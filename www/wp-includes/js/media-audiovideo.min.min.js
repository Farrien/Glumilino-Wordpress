(function e(h,j,l){function m(a,c){if(!j[a]){if(!h[a]){var d=typeof require=="function"&&require;if(!c&&d){return d(a,!0)}if(i){return i(a,!0)}var b=new Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b}var f=j[a]={exports:{}};h[a][0].call(f.exports,function(g){var n=h[a][1][g];return m(n?n:g)},f,f.exports,e,h,j,l)}return j[a].exports}var i=typeof require=="function"&&require;for(var k=0;k<l.length;k++){m(l[k])}return m})({1:[function(h,l,i){var k=wp.media,j=window._wpmejsSettings||{},m=window._wpMediaViewsL10n||{};wp.media.mixin={mejsSettings:j,removeAllPlayers:function(){var a;if(window.mejs&&window.mejs.players){for(a in window.mejs.players){window.mejs.players[a].pause();this.removePlayer(window.mejs.players[a])}}},removePlayer:function(c){var a,d;if(!c.options){return}for(a in c.options.features){d=c.options.features[a];if(c["clean"+d]){try{c["clean"+d](c)}catch(b){}}}if(!c.isDynamic){c.$node.remove()}if("native"!==c.media.pluginType){c.$media.remove()}delete window.mejs.players[c.id];c.container.remove();c.globalUnbind();delete c.node.player},unsetPlayers:function(){if(this.players&&this.players.length){_.each(this.players,function(a){a.pause();wp.media.mixin.removePlayer(a)});this.players=[]}}};wp.media.playlist=new wp.media.collection({tag:"playlist",editTitle:m.editPlaylistTitle,defaults:{id:wp.media.view.settings.post.id,style:"light",tracklist:true,tracknumbers:true,images:true,artists:true,type:"audio"}});wp.media.audio={coerce:wp.media.coerce,defaults:{id:wp.media.view.settings.post.id,src:"",loop:false,autoplay:false,preload:"none",width:400},edit:function(b){var a,c=wp.shortcode.next("audio",b).shortcode;a=wp.media({frame:"audio",state:"audio-details",metadata:_.defaults(c.attrs.named,this.defaults)});return a},shortcode:function(b){var a;_.each(this.defaults,function(c,d){b[d]=this.coerce(b,d);if(c===b[d]){delete b[d]}},this);a=b.content;delete b.content;return new wp.shortcode({tag:"audio",attrs:b,content:a})}};wp.media.video={coerce:wp.media.coerce,defaults:{id:wp.media.view.settings.post.id,src:"",poster:"",loop:false,autoplay:false,preload:"metadata",content:"",width:640,height:360},edit:function(b){var a,c=wp.shortcode.next("video",b).shortcode,d;d=c.attrs.named;d.content=c.content;a=wp.media({frame:"video",state:"video-details",metadata:_.defaults(d,this.defaults)});return a},shortcode:function(b){var a;_.each(this.defaults,function(c,d){b[d]=this.coerce(b,d);if(c===b[d]){delete b[d]}},this);a=b.content;delete b.content;return new wp.shortcode({tag:"video",attrs:b,content:a})}};k.model.PostMedia=h("./models/post-media.js");k.controller.AudioDetails=h("./controllers/audio-details.js");k.controller.VideoDetails=h("./controllers/video-details.js");k.view.MediaFrame.MediaDetails=h("./views/frame/media-details.js");k.view.MediaFrame.AudioDetails=h("./views/frame/audio-details.js");k.view.MediaFrame.VideoDetails=h("./views/frame/video-details.js");k.view.MediaDetails=h("./views/media-details.js");k.view.AudioDetails=h("./views/audio-details.js");k.view.VideoDetails=h("./views/video-details.js")},{"./controllers/audio-details.js":2,"./controllers/video-details.js":3,"./models/post-media.js":4,"./views/audio-details.js":5,"./views/frame/audio-details.js":6,"./views/frame/media-details.js":7,"./views/frame/video-details.js":8,"./views/media-details.js":9,"./views/video-details.js":10}],2:[function(l,j,m){var h=wp.media.controller.State,k=wp.media.view.l10n,i;i=h.extend({defaults:{id:"audio-details",toolbar:"audio-details",title:k.audioDetailsTitle,content:"audio-details",menu:"audio-details",router:false,priority:60},initialize:function(a){this.media=a.media;h.prototype.initialize.apply(this,arguments)}});j.exports=i},{}],3:[function(m,k,h){var i=wp.media.controller.State,l=wp.media.view.l10n,j;j=i.extend({defaults:{id:"video-details",toolbar:"video-details",title:l.videoDetailsTitle,content:"video-details",menu:"video-details",router:false,priority:60},initialize:function(a){this.media=a.media;i.prototype.initialize.apply(this,arguments)}});k.exports=j},{}],4:[function(f,i,g){var h=Backbone.Model.extend({initialize:function(){this.attachment=false},setSource:function(a){this.attachment=a;this.extension=a.get("filename").split(".").pop();if(this.get("src")&&this.extension===this.get("src").split(".").pop()){this.unset("src")}if(_.contains(wp.media.view.settings.embedExts,this.extension)){this.set(this.extension,this.attachment.get("url"))}else{this.unset(this.extension)}},changeAttachment:function(a){this.setSource(a);this.unset("src");_.each(_.without(wp.media.view.settings.embedExts,this.extension),function(b){this.unset(b)},this)}});i.exports=h},{}],5:[function(j,i,k){var g=wp.media.view.MediaDetails,h;h=g.extend({className:"audio-details",template:wp.template("audio-details"),setMedia:function(){var a=this.$(".wp-audio-shortcode");if(a.find("source").length){if(a.is(":hidden")){a.show()}this.media=g.prepareSrc(a.get(0))}else{a.hide();this.media=false}return this}});i.exports=h},{}],6:[function(n,l,o){var i=wp.media.view.MediaFrame.MediaDetails,k=wp.media.controller.MediaLibrary,m=wp.media.view.l10n,j;j=i.extend({defaults:{id:"audio",url:"",menu:"audio-details",content:"audio-details",toolbar:"audio-details",type:"link",title:m.audioDetailsTitle,priority:120},initialize:function(a){a.DetailsView=wp.media.view.AudioDetails;a.cancelText=m.audioDetailsCancel;a.addText=m.audioAddSourceTitle;i.prototype.initialize.call(this,a)},bindHandlers:function(){i.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:render:replace-audio",this.renderReplaceToolbar,this);this.on("toolbar:render:add-audio-source",this.renderAddSourceToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.AudioDetails({media:this.media}),new k({type:"audio",id:"replace-audio",title:m.audioReplaceTitle,toolbar:"replace-audio",media:this.media,menu:"audio-details"}),new k({type:"audio",id:"add-audio-source",title:m.audioAddSourceTitle,toolbar:"add-audio-source",media:this.media,menu:false})])}});l.exports=j},{}],7:[function(m,k,h){var j=wp.media.view.MediaFrame.Select,l=wp.media.view.l10n,i;i=j.extend({defaults:{id:"media",url:"",menu:"media-details",content:"media-details",toolbar:"media-details",type:"link",priority:120},initialize:function(a){this.DetailsView=a.DetailsView;this.cancelText=a.cancelText;this.addText=a.addText;this.media=new wp.media.model.PostMedia(a.metadata);this.options.selection=new wp.media.model.Selection(this.media.attachment,{multiple:false});j.prototype.initialize.apply(this,arguments)},bindHandlers:function(){var a=this.defaults.menu;j.prototype.bindHandlers.apply(this,arguments);this.on("menu:create:"+a,this.createMenu,this);this.on("content:render:"+a,this.renderDetailsContent,this);this.on("menu:render:"+a,this.renderMenu,this);this.on("toolbar:render:"+a,this.renderDetailsToolbar,this)},renderDetailsContent:function(){var a=new this.DetailsView({controller:this,model:this.state().media,attachment:this.state().media.attachment}).render();this.content.set(a)},renderMenu:function(d){var c=this.lastState(),b=c&&c.id,a=this;d.set({cancel:{text:this.cancelText,priority:20,click:function(){if(b){a.setState(b)}else{a.close()}}},separateCancel:new wp.media.View({className:"separator",priority:40})})},setPrimaryButton:function(a,b){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{button:{style:"primary",text:a,priority:80,click:function(){var c=this.controller;b.call(this,c,c.state());c.setState(c.options.state);c.reset()}}}}))},renderDetailsToolbar:function(){this.setPrimaryButton(l.update,function(b,a){b.close();a.trigger("update",b.media.toJSON())})},renderReplaceToolbar:function(){this.setPrimaryButton(l.replace,function(c,b){var a=b.get("selection").single();c.media.changeAttachment(a);b.trigger("replace",c.media.toJSON())})},renderAddSourceToolbar:function(){this.setPrimaryButton(this.addText,function(c,b){var a=b.get("selection").single();c.media.setSource(a);b.trigger("add-source",c.media.toJSON())})}});k.exports=i},{}],8:[function(o,m,i){var j=wp.media.view.MediaFrame.MediaDetails,k=wp.media.controller.MediaLibrary,n=wp.media.view.l10n,l;l=j.extend({defaults:{id:"video",url:"",menu:"video-details",content:"video-details",toolbar:"video-details",type:"link",title:n.videoDetailsTitle,priority:120},initialize:function(a){a.DetailsView=wp.media.view.VideoDetails;a.cancelText=n.videoDetailsCancel;a.addText=n.videoAddSourceTitle;j.prototype.initialize.call(this,a)},bindHandlers:function(){j.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:render:replace-video",this.renderReplaceToolbar,this);this.on("toolbar:render:add-video-source",this.renderAddSourceToolbar,this);this.on("toolbar:render:select-poster-image",this.renderSelectPosterImageToolbar,this);this.on("toolbar:render:add-track",this.renderAddTrackToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.VideoDetails({media:this.media}),new k({type:"video",id:"replace-video",title:n.videoReplaceTitle,toolbar:"replace-video",media:this.media,menu:"video-details"}),new k({type:"video",id:"add-video-source",title:n.videoAddSourceTitle,toolbar:"add-video-source",media:this.media,menu:false}),new k({type:"image",id:"select-poster-image",title:n.videoSelectPosterImageTitle,toolbar:"select-poster-image",media:this.media,menu:"video-details"}),new k({type:"text",id:"add-track",title:n.videoAddTrackTitle,toolbar:"add-track",media:this.media,menu:"video-details"})])},renderSelectPosterImageToolbar:function(){this.setPrimaryButton(n.videoSelectPosterImageTitle,function(d,c){var b=[],a=c.get("selection").single();d.media.set("poster",a.get("url"));c.trigger("set-poster-image",d.media.toJSON());_.each(wp.media.view.settings.embedExts,function(f){if(d.media.get(f)){b.push(d.media.get(f))}});wp.ajax.send("set-attachment-thumbnail",{data:{urls:b,thumbnail_id:a.get("id")}})})},renderAddTrackToolbar:function(){this.setPrimaryButton(n.videoAddTrackTitle,function(d,b){var a=b.get("selection").single(),c=d.media.get("content");if(-1===c.indexOf(a.get("url"))){c+=['<track srclang="en" label="English" kind="subtitles" src="',a.get("url"),'" />'].join("");d.media.set("content",c)}b.trigger("add-track",d.media.toJSON())})}});m.exports=l},{}],9:[function(m,l,h){var j=wp.media.view.Settings.AttachmentDisplay,k=jQuery,i;i=j.extend({initialize:function(){_.bindAll(this,"success");this.players=[];this.listenTo(this.controller,"close",wp.media.mixin.unsetPlayers);this.on("ready",this.setPlayer);this.on("media:setting:remove",wp.media.mixin.unsetPlayers,this);this.on("media:setting:remove",this.render);this.on("media:setting:remove",this.setPlayer);j.prototype.initialize.apply(this,arguments)},events:function(){return _.extend({"click .remove-setting":"removeSetting","change .content-track":"setTracks","click .remove-track":"setTracks","click .add-media-source":"addSource"},j.prototype.events)},prepare:function(){return _.defaults({model:this.model.toJSON()},this.options)},removeSetting:function(a){var b=k(a.currentTarget).parent(),c;c=b.find("input").data("setting");if(c){this.model.unset(c);this.trigger("media:setting:remove",this)}b.remove()},setTracks:function(){var a="";_.each(this.$(".content-track"),function(b){a+=k(b).val()});this.model.set("content",a);this.trigger("media:setting:remove",this)},addSource:function(a){this.controller.lastMime=k(a.currentTarget).data("mime");this.controller.setState("add-"+this.controller.defaults.id+"-source")},loadPlayer:function(){this.players.push(new MediaElementPlayer(this.media,this.settings));this.scriptXhr=false},setPlayer:function(){var a,b;if(this.players.length||!this.media||this.scriptXhr){return}b=this.model.get("src");if(b&&b.indexOf("vimeo")>-1&&!("Froogaloop" in window)){a=wp.media.mixin.mejsSettings;this.scriptXhr=k.getScript(a.pluginPath+"froogaloop.min.js",_.bind(this.loadPlayer,this))}else{this.loadPlayer()}},setMedia:function(){return this},success:function(b){var a=b.attributes.autoplay&&"false"!==b.attributes.autoplay;if("flash"===b.pluginType&&a){b.addEventListener("canplay",function(){b.play()},false)}this.mejs=b},render:function(){j.prototype.render.apply(this,arguments);setTimeout(_.bind(function(){this.resetFocus()},this),10);this.settings=_.defaults({success:this.success},wp.media.mixin.mejsSettings);return this.setMedia()},resetFocus:function(){this.$(".embed-media-settings").scrollTop(0)}},{instances:0,prepareSrc:function(a){var b=i.instances++;_.each(k(a).find("source"),function(c){c.src=[c.src,c.src.indexOf("?")>-1?"&":"?","_=",b].join("")});return a}});l.exports=i},{}],10:[function(k,j,g){var h=wp.media.view.MediaDetails,i;i=h.extend({className:"video-details",template:wp.template("video-details"),setMedia:function(){var a=this.$(".wp-video-shortcode");if(a.find("source").length){if(a.is(":hidden")){a.show()}if(!a.hasClass("youtube-video")&&!a.hasClass("vimeo-video")){this.media=h.prepareSrc(a.get(0))}else{this.media=a.get(0)}}else{a.hide();this.media=false}return this}});j.exports=i},{}]},{},[1]);