!function(b){b.suggest=function(L,K){function J(){var c=y.offset();x.css({top:c.top+L.offsetHeight+"px",left:c.left+"px"})}function I(c){if(/27$|38$|40$/.test(c.keyCode)&&x.is(":visible")||/^13$|^9$/.test(c.keyCode)&&C()){switch(c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation(),c.cancelBubble=!0,c.returnValue=!1,c.keyCode){case 38:z();break;case 40:A();break;case 9:case 13:B();break;case 27:x.hide()}}else{y.val().length!=v&&(w&&clearTimeout(w),w=setTimeout(H,K.delay),v=y.val().length)}}function H(){var c,g,f=b.trim(y.val());K.multiple&&(c=f.lastIndexOf(K.multipleSep),-1!=c&&(f=b.trim(f.substr(c+K.multipleSep.length)))),f.length>=K.minchars?(cached=G(f),cached?E(cached.items):b.get(K.source,{q:f},function(d){x.hide(),g=D(d,f),E(g),F(f,g,d.length)})):x.hide()}function G(d){var c;for(c=0;c<u.length;c++){if(u[c].q==d){return u.unshift(u.splice(c,1)[0]),u[0]}}return !1}function F(f,c,h){for(var g;u.length&&a+h>K.maxCacheSize;){g=u.pop(),a-=g.size}u.push({q:f,size:h,items:c}),a+=h}function E(c){var g,d="";if(c){if(!c.length){return void x.hide()}for(J(),g=0;g<c.length;g++){d+="<li>"+c[g]+"</li>"}x.html(d).show(),x.children("li").mouseover(function(){x.children("li").removeClass(K.selectClass),b(this).addClass(K.selectClass)}).click(function(e){e.preventDefault(),e.stopPropagation(),B()})}}function D(c,m){var l,k,j=[],i=c.split(K.delimiter);for(l=0;l<i.length;l++){k=b.trim(i[l]),k&&(k=k.replace(new RegExp(m,"ig"),function(d){return'<span class="'+K.matchClass+'">'+d+"</span>"}),j[j.length]=k)}return j}function C(){var c;return x.is(":visible")?(c=x.children("li."+K.selectClass),c.length||(c=!1),c):!1}function B(){$currentResult=C(),$currentResult&&(K.multiple?(-1!=y.val().indexOf(K.multipleSep)?$currentVal=y.val().substr(0,y.val().lastIndexOf(K.multipleSep)+K.multipleSep.length)+" ":$currentVal="",y.val($currentVal+$currentResult.text()+K.multipleSep+" "),y.focus()):y.val($currentResult.text()),x.hide(),y.trigger("change"),K.onSelect&&K.onSelect.apply(y[0]))}function A(){$currentResult=C(),$currentResult?$currentResult.removeClass(K.selectClass).next().addClass(K.selectClass):x.children("li:first-child").addClass(K.selectClass)}function z(){var c=C();c?c.removeClass(K.selectClass).prev().addClass(K.selectClass):x.children("li:last-child").addClass(K.selectClass)}var y,x,w,v,u,a;y=b(L).attr("autocomplete","off"),x=b("<ul/>"),w=!1,v=0,u=[],a=0,x.addClass(K.resultsClass).appendTo("body"),J(),b(window).on("load",J).on("resize",J),y.blur(function(){setTimeout(function(){x.hide()},200)}),y.keydown(I)},b.fn.suggest=function(a,d){return a?(d=d||{},d.multiple=d.multiple||!1,d.multipleSep=d.multipleSep||",",d.source=a,d.delay=d.delay||100,d.resultsClass=d.resultsClass||"ac_results",d.selectClass=d.selectClass||"ac_over",d.matchClass=d.matchClass||"ac_match",d.minchars=d.minchars||2,d.delimiter=d.delimiter||"\n",d.onSelect=d.onSelect||!1,d.maxCacheSize=d.maxCacheSize||65536,this.each(function(){new b.suggest(this,d)}),this):void 0}}(jQuery);