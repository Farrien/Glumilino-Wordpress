var topWin=window.dialogArguments||opener||parent||top;function fileDialogStart(){jQuery("#media-upload-error").empty()}function fileQueued(b){jQuery(".media-blank").remove();if(jQuery("form.type-form #media-items").children().length==1&&jQuery(".hidden","#media-items").length>0){jQuery(".describe-toggle-on").show();jQuery(".describe-toggle-off").hide();jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")}jQuery('<div class="media-item">').attr("id","media-item-"+b.id).addClass("child-of-"+post_id).append('<div class="progress"><div class="bar"></div></div>',jQuery('<div class="filename original"><span class="percent"></span>').text(" "+b.name)).appendTo(jQuery("#media-items"));jQuery(".progress","#media-item-"+b.id).show();jQuery("#insert-gallery").prop("disabled",true);jQuery("#cancel-upload").prop("disabled",false)}function uploadStart(d){try{if(typeof topWin.tb_remove!="undefined"){topWin.jQuery("#TB_overlay").unbind("click",topWin.tb_remove)}}catch(c){}return true}function uploadProgress(h,f,i){var g=jQuery("#media-items").width()-2,j=jQuery("#media-item-"+h.id);jQuery(".bar",j).width(g*f/i);jQuery(".percent",j).html(Math.ceil(f/i*100)+"%");if(f==i){jQuery(".bar",j).html('<strong class="crunching">'+swfuploadL10n.crunching+"</strong>")}}function prepareMediaItem(j,f){var i=(typeof shortform=="undefined")?1:2,e=jQuery("#media-item-"+j.id);jQuery(".bar",e).remove();jQuery(".progress",e).hide();try{if(typeof topWin.tb_remove!="undefined"){topWin.jQuery("#TB_overlay").click(topWin.tb_remove)}}catch(h){}if(isNaN(f)||!f){e.append(f);prepareMediaItemInit(j)}else{e.load("async-upload.php",{attachment_id:f,fetch:i},function(){prepareMediaItemInit(j);updateMediaForm()})}}function prepareMediaItemInit(c){var d=jQuery("#media-item-"+c.id);jQuery(".thumbnail",d).clone().attr("class","pinkynail toggle").prependTo(d);jQuery(".filename.original",d).replaceWith(jQuery(".filename.new",d));jQuery("a.toggle",d).click(function(){jQuery(this).siblings(".slidetoggle").slideToggle(350,function(){var g=jQuery(window).height(),b=jQuery(this).offset().top,a=jQuery(this).height(),h;if(g&&b&&a){h=b+a;if(h>g&&(a+48)<g){window.scrollBy(0,h-g+13)}else{if(h>g){window.scrollTo(0,b-36)}}}});jQuery(this).siblings(".toggle").andSelf().toggle();jQuery(this).siblings("a.toggle").focus();return false});jQuery("a.delete",d).click(function(){jQuery.ajax({url:ajaxurl,type:"post",success:deleteSuccess,error:deleteError,id:c.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"trash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")}});return false});jQuery("a.undo",d).click(function(){jQuery.ajax({url:ajaxurl,type:"post",id:c.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"untrash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")},success:function(b,a){var f=jQuery("#media-item-"+c.id);if(type=jQuery("#type-of-"+c.id).val()){jQuery("#"+type+"-counter").text(jQuery("#"+type+"-counter").text()-0+1)}if(f.hasClass("child-of-"+post_id)){jQuery("#attachments-count").text(jQuery("#attachments-count").text()-0+1)}jQuery(".filename .trashnotice",f).remove();jQuery(".filename .title",f).css("font-weight","normal");jQuery("a.undo",f).addClass("hidden");jQuery("a.describe-toggle-on, .menu_order_input",f).show();f.css({backgroundColor:"#ceb"}).animate({backgroundColor:"#fff"},{queue:false,duration:500,complete:function(){jQuery(this).css({backgroundColor:""})}}).removeClass("undo")}});return false});jQuery("#media-item-"+c.id+".startopen").removeClass("startopen").slideToggle(500).siblings(".toggle").toggle()}function itemAjaxError(g,e){var h=jQuery("#media-item-"+g);var f=jQuery(".filename",h).text();h.html('<div class="error-div"><a class="dismiss" href="#">'+swfuploadL10n.dismiss+"</a><strong>"+swfuploadL10n.error_uploading.replace("%s",f)+"</strong><br />"+e+"</div>");h.find("a.dismiss").click(function(){jQuery(this).parents(".media-item").slideUp(200,function(){jQuery(this).remove()})})}function deleteSuccess(e,g){if(e=="-1"){return itemAjaxError(this.id,"You do not have permission. Has your session expired?")}if(e=="0"){return itemAjaxError(this.id,"Could not be deleted. Has it been deleted already?")}var h=this.id,f=jQuery("#media-item-"+h);if(type=jQuery("#type-of-"+h).val()){jQuery("#"+type+"-counter").text(jQuery("#"+type+"-counter").text()-1)}if(f.hasClass("child-of-"+post_id)){jQuery("#attachments-count").text(jQuery("#attachments-count").text()-1)}if(jQuery("form.type-form #media-items").children().length==1&&jQuery(".hidden","#media-items").length>0){jQuery(".toggle").toggle();jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")}jQuery(".toggle",f).toggle();jQuery(".slidetoggle",f).slideUp(200).siblings().removeClass("hidden");f.css({backgroundColor:"#faa"}).animate({backgroundColor:"#f4f4f4"},{queue:false,duration:500}).addClass("undo");jQuery(".filename:empty",f).remove();jQuery(".filename .title",f).css("font-weight","bold");jQuery(".filename",f).append('<span class="trashnotice"> '+swfuploadL10n.deleted+" </span>").siblings("a.toggle").hide();jQuery(".filename",f).append(jQuery("a.undo",f).removeClass("hidden"));jQuery(".menu_order_input",f).hide();return}function deleteError(f,d,e){}function updateMediaForm(){var c=jQuery("form.type-form #media-items").children(),d=jQuery("#media-items").children();if(c.length==1){jQuery(".slidetoggle",c).slideDown(500).siblings().addClass("hidden").filter(".toggle").toggle()}if(d.not(".media-blank").length>0){jQuery(".savebutton").show()}else{jQuery(".savebutton").hide()}if(d.length>1){jQuery(".insert-gallery").show()}else{jQuery(".insert-gallery").hide()}}function uploadSuccess(c,d){if(d.match("media-upload-error")){jQuery("#media-item-"+c.id).html(d);return}prepareMediaItem(c,d);updateMediaForm();if(jQuery("#media-item-"+c.id).hasClass("child-of-"+post_id)){jQuery("#attachments-count").text(1*jQuery("#attachments-count").text()+1)}}function uploadComplete(b){if(swfu.getStats().files_queued==0){jQuery("#cancel-upload").prop("disabled",true);jQuery("#insert-gallery").prop("disabled",false)}}function wpQueueError(b){jQuery("#media-upload-error").show().text(b)}function wpFileError(g,h){var e=jQuery("#media-item-"+g.id);var f=jQuery(".filename",e).text();e.html('<div class="error-div"><a class="dismiss" href="#">'+swfuploadL10n.dismiss+"</a><strong>"+swfuploadL10n.error_uploading.replace("%s",f)+"</strong><br />"+h+"</div>");e.find("a.dismiss").click(function(){jQuery(this).parents(".media-item").slideUp(200,function(){jQuery(this).remove()})})}function fileQueueError(f,e,d){if(e==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){wpQueueError(swfuploadL10n.queue_limit_exceeded)}else{if(e==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT){fileQueued(f);wpFileError(f,swfuploadL10n.file_exceeds_size_limit)}else{if(e==SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE){fileQueued(f);wpFileError(f,swfuploadL10n.zero_byte_file)}else{if(e==SWFUpload.QUEUE_ERROR.INVALID_FILETYPE){fileQueued(f);wpFileError(f,swfuploadL10n.invalid_filetype)}else{wpQueueError(swfuploadL10n.default_error)}}}}}function fileDialogComplete(c){try{if(c>0){this.startUpload()}}catch(d){this.debug(d)}}function switchUploader(d){var f=document.getElementById(swfu.customSettings.swfupload_element_id),e=document.getElementById(swfu.customSettings.degraded_element_id);if(d){f.style.display="block";e.style.display="none"}else{f.style.display="none";e.style.display="block"}}function swfuploadPreLoad(){if(!uploaderMode){switchUploader(1)}else{switchUploader(0)}}function swfuploadLoadFailed(){switchUploader(0);jQuery(".upload-html-bypass").hide()}function uploadError(d,f,e){switch(f){case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:wpFileError(d,swfuploadL10n.missing_upload_url);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:wpFileError(d,swfuploadL10n.upload_limit_exceeded);break;case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:wpQueueError(swfuploadL10n.http_error);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:wpQueueError(swfuploadL10n.upload_failed);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:wpQueueError(swfuploadL10n.io_error);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:wpQueueError(swfuploadL10n.security_error);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:jQuery("#media-item-"+d.id).remove();break;default:wpFileError(d,swfuploadL10n.default_error)}}function cancelUpload(){swfu.cancelQueue()}jQuery(document).ready(function(b){b('input[type="radio"]',"#media-items").live("click",function(){var a=b(this).closest("tr");if(b(a).hasClass("align")){setUserSetting("align",b(this).val())}else{if(b(a).hasClass("image-size")){setUserSetting("imgsize",b(this).val())}}});b("button.button","#media-items").live("click",function(){var a=this.className||"";a=a.match(/url([^ '"]+)/);if(a&&a[1]){setUserSetting("urlbutton",a[1]);b(this).siblings(".urlfield").val(b(this).attr("title"))}})});