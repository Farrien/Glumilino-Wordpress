window.autosave=function(){return true};(function(c,b){function a(){var i,l=0,f=c(document);function j(q){var p,s,r,t=(new Date()).getTime(),n=[],o=e();if(o&&o.isDirty()&&!o.isHidden()&&t-3000>l){o.save();l=t}r={post_id:c("#post_ID").val()||0,post_type:c("#post_type").val()||"",post_author:c("#post_author").val()||"",post_title:c("#title").val()||"",content:c("#content").val()||"",excerpt:c("#excerpt").val()||""};if(q==="local"){return r}c('input[id^="in-category-"]:checked').each(function(){n.push(this.value)});r.catslist=n.join(",");if(p=c("#post_name").val()){r.post_name=p}if(s=c("#parent_id").val()){r.parent_id=s}if(c("#comment_status").prop("checked")){r.comment_status="open"}if(c("#ping_status").prop("checked")){r.ping_status="open"}if(c("#auto_draft").val()==="1"){r.auto_draft="1"}return r}function d(n){if(typeof n==="object"){return(n.post_title||"")+"::"+(n.content||"")+"::"+(n.excerpt||"")}return(c("#title").val()||"")+"::"+(c("#content").val()||"")+"::"+(c("#excerpt").val()||"")}function m(){f.trigger("autosave-disable-buttons");setTimeout(k,5000)}function k(){f.trigger("autosave-enable-buttons")}function e(){return typeof tinymce!=="undefined"&&tinymce.get("content")}function g(){var C,z,n,D,B,w=false;function A(){var H=Math.random().toString(),F=false;try{b.sessionStorage.setItem("wp-test",H);F=b.sessionStorage.getItem("wp-test")===H;b.sessionStorage.removeItem("wp-test")}catch(G){}n=F;return F}function o(){var F=false;if(n&&C){F=sessionStorage.getItem("wp-autosave-"+C);if(F){F=JSON.parse(F)}else{F={}}}return F}function t(F){var G;if(n&&C){G="wp-autosave-"+C;sessionStorage.setItem(G,JSON.stringify(F));return sessionStorage.getItem(G)!==null}return false}function r(){var F=o();if(!F||!z){return false}return F["post_"+z]||false}function s(F){var G=o();if(!G||!z){return false}if(F){G["post_"+z]=F}else{if(G.hasOwnProperty("post_"+z)){delete G["post_"+z]}else{return false}}return t(G)}function x(){w=true}function p(){w=false}function y(I){var G,H,F=false;if(w||!n){return false}if(I){G=r()||{};c.extend(G,I)}else{G=j("local")}H=d(G);if(typeof B==="undefined"){B=i}if(H===B){return false}G.save_time=(new Date()).getTime();G.status=c("#post_status").val()||"";F=s(G);if(F){B=H}return F}function v(){z=c("#post_ID").val()||0;if(c("#wp-content-wrap").hasClass("tmce-active")){f.on("tinymce-editor-init.autosave",function(){b.setTimeout(function(){q()},1500)})}else{q()}D=b.setInterval(y,15000);c("form#post").on("submit.autosave-local",function(){var G=e(),F=c("#post_ID").val()||0;if(G&&!G.isHidden()){G.on("submit",function(){y({post_title:c("#title").val()||"",content:c("#content").val()||"",excerpt:c("#excerpt").val()||""})})}else{y({post_title:c("#title").val()||"",content:c("#content").val()||"",excerpt:c("#excerpt").val()||""})}var H=("https:"===b.location.protocol);wpCookies.set("wp-saving-post",F+"-check",24*60*60,false,false,H)})}function E(H,G){function F(I){return I.toString().replace(/[\x20\t\r\n\f]+/g,"")}return(F(H||"")===F(G||""))}function q(){var K,J,F,M,G=r(),H=wpCookies.get("wp-saving-post"),L=c("#has-newer-autosave").parent(".notice"),I=c(".wp-header-end");if(H===z+"-saved"){wpCookies.remove("wp-saving-post");s(false);return}if(!G){return}K=c("#content").val()||"";J=c("#title").val()||"";F=c("#excerpt").val()||"";if(E(K,G.content)&&E(J,G.post_title)&&E(F,G.excerpt)){return}if(!I.length){I=c(".wrap h1, .wrap h2").first()}M=c("#local-storage-notice").insertAfter(I).addClass("notice-warning");if(L.length){L.slideUp(150,function(){M.slideDown(150)})}else{M.slideDown(200)}M.find(".restore-backup").on("click.autosave-local",function(){u(G);M.fadeTo(250,0,function(){M.slideUp(150)})})}function u(F){var G;if(F){B=d(F);if(c("#title").val()!==F.post_title){c("#title").focus().val(F.post_title||"")}c("#excerpt").val(F.excerpt||"");G=e();if(G&&!G.isHidden()&&typeof switchEditors!=="undefined"){if(G.settings.wpautop&&F.content){F.content=switchEditors.wpautop(F.content)}G.undoManager.transact(function(){G.setContent(F.content||"");G.nodeChanged()})}else{c("#content-html").click();c("#content").focus();document.execCommand("selectAll");document.execCommand("insertText",false,F.content||"")}return true}return false}C=typeof b.autosaveL10n!=="undefined"&&b.autosaveL10n.blog_id;if(A()&&C&&(c("#content").length||c("#excerpt").length)){f.ready(v)}return{hasStorage:n,getSavedPostData:r,save:y,suspend:x,resume:p}}function h(){var q,A,u,z,p=0,n=false;function y(){q=true;b.clearTimeout(A);A=b.setTimeout(function(){q=false},10000)}function v(){n=true}function s(){n=false}function t(B){w();q=false;z=u;u="";f.trigger("after-autosave",[B]);k();if(B.success){c("#auto_draft").val("")}}function r(){p=0;wp.heartbeat.connectNow()}function o(){return d()!==i}function x(){var B,C;if(n||q||!b.autosave()){return false}if((new Date()).getTime()<p){return false}B=j();C=d(B);if(typeof z==="undefined"){z=i}if(C===z){return false}u=C;y();m();f.trigger("wpcountwords",[B.content]).trigger("before-autosave",[B]);B._wpnonce=c("#_wpnonce").val()||"";return B}function w(){p=(new Date()).getTime()+(autosaveL10n.autosaveInterval*1000)||60000}f.on("heartbeat-send.autosave",function(C,D){var B=x();if(B){D.wp_autosave=B}}).on("heartbeat-tick.autosave",function(B,C){if(C.wp_autosave){t(C.wp_autosave)}}).on("heartbeat-connection-lost.autosave",function(D,C,B){if("timeout"===C||603===B){var E=c("#lost-connection-notice");if(!wp.autosave.local.hasStorage){E.find(".hide-if-no-sessionstorage").hide()}E.show();m()}}).on("heartbeat-connection-restored.autosave",function(){c("#lost-connection-notice").hide();k()}).ready(function(){w()});return{tempBlockSave:y,triggerSave:r,postChanged:o,suspend:v,resume:s}}f.on("tinymce-editor-init.autosave",function(o,n){if(n.id==="content"){b.setTimeout(function(){n.save();i=d()},1000)}}).ready(function(){i=d()});return{getPostData:j,getCompareString:d,disableButtons:m,enableButtons:k,local:g(),server:h()}}b.wp=b.wp||{};b.wp.autosave=a()}(jQuery,window));