window.wp=window.wp||{};(function(a,c){var b=wp.customize,d;c.extend(c.support,{history:!!(window.history&&history.pushState),hashchange:("onhashchange" in window)&&(document.documentMode===undefined||document.documentMode>7)});d=c.extend({},b.Events,{initialize:function(){this.body=c(document.body);if(!d.settings||!c.support.postMessage||(!c.support.cors&&d.settings.isCrossDomain)){return}this.window=c(window);this.element=c('<div id="customize-container" />').appendTo(this.body);this.bind("open",this.overlay.show);this.bind("close",this.overlay.hide);c("#wpbody").on("click",".load-customize",function(e){e.preventDefault();d.link=c(this);d.open(d.link.attr("href"))});if(c.support.history){this.window.on("popstate",d.popstate)}if(c.support.hashchange){this.window.on("hashchange",d.hashchange);this.window.triggerHandler("hashchange")}},popstate:function(g){var f=g.originalEvent.state;if(f&&f.customize){d.open(f.customize)}else{if(d.active){d.close()}}},hashchange:function(){var e=window.location.toString().split("#")[1];if(e&&0===e.indexOf("wp_customize=on")){d.open(d.settings.url+"?"+e)}if(!e&&!c.support.history){d.close()}},beforeunload:function(){if(!d.saved()){return d.settings.l10n.saveAlert}},open:function(e){if(this.active){return}if(d.settings.browser.mobile){return window.location=e}this.originalDocumentTitle=document.title;this.active=true;this.body.addClass("customize-loading");this.saved=new b.Value(true);this.iframe=c("<iframe />",{src:e,title:d.settings.l10n.mainIframeTitle}).appendTo(this.element);this.iframe.one("load",this.loaded);this.messenger=new b.Messenger({url:e,channel:"loader",targetWindow:this.iframe[0].contentWindow});if(history.replaceState){this.messenger.bind("changeset-uuid",function(f){var g=document.createElement("a");g.href=location.href;g.search=c.param(_.extend(b.utils.parseQueryString(g.search.substr(1)),{changeset_uuid:f}));history.replaceState({customize:g.href},"",g.href)})}this.messenger.bind("ready",function(){d.messenger.send("back")});this.messenger.bind("close",function(){if(c.support.history){history.back()}else{if(c.support.hashchange){window.location.hash=""}else{d.close()}}});c(window).on("beforeunload",this.beforeunload);this.messenger.bind("saved",function(){d.saved(true)});this.messenger.bind("change",function(){d.saved(false)});this.messenger.bind("title",function(f){window.document.title=f});this.pushState(e);this.trigger("open")},pushState:function(f){var e=f.split("?")[1];if(c.support.history&&window.location.href!==f){history.pushState({customize:f},"",f)}else{if(!c.support.history&&c.support.hashchange&&e){window.location.hash="wp_customize=on&"+e}}this.trigger("open")},opened:function(){d.body.addClass("customize-active full-overlay-active").attr("aria-busy","true")},close:function(){if(!this.active){return}if(!this.saved()&&!confirm(d.settings.l10n.saveAlert)){history.forward();return}this.active=false;this.trigger("close");if(this.originalDocumentTitle){document.title=this.originalDocumentTitle}},closed:function(){d.iframe.remove();d.messenger.destroy();d.iframe=null;d.messenger=null;d.saved=null;d.body.removeClass("customize-active full-overlay-active").removeClass("customize-loading");c(window).off("beforeunload",d.beforeunload);if(d.link){d.link.focus()}},loaded:function(){d.body.removeClass("customize-loading").attr("aria-busy","false")},overlay:{show:function(){this.element.fadeIn(200,d.opened)},hide:function(){this.element.fadeOut(200,d.closed)}}});c(function(){d.settings=_wpCustomizeLoaderSettings;d.initialize()});b.Loader=d})(wp,jQuery);