(function e(h,j,l){function m(a,c){if(!j[a]){if(!h[a]){var d=typeof require=="function"&&require;if(!c&&d){return d(a,!0)}if(i){return i(a,!0)}var b=new Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b}var f=j[a]={exports:{}};h[a][0].call(f.exports,function(g){var n=h[a][1][g];return m(n?n:g)},f,f.exports,e,h,j,l)}return j[a].exports}var i=typeof require=="function"&&require;for(var k=0;k<l.length;k++){m(l[k])}return m})({1:[function(h,m,i){var l=wp.media.model.Selection,j=wp.media.controller.Library,k;k=j.extend({defaults:_.defaults({multiple:"add",filterable:"uploaded",priority:100,syncSelection:false},j.prototype.defaults),initialize:function(){var a=this.get("collectionType");if("video"===this.get("type")){a="video-"+a}this.set("id",a+"-library");this.set("toolbar",a+"-add");this.set("menu",a);if(!this.get("library")){this.set("library",wp.media.query({type:this.get("type")}))}j.prototype.initialize.apply(this,arguments)},activate:function(){var c=this.get("library"),b=this.get("editLibrary"),a=this.frame.state(this.get("collectionType")+"-edit").get("library");if(b&&b!==a){c.unobserve(b)}c.validator=function(d){return !!this.mirroring.get(d.cid)&&!a.get(d.cid)&&l.prototype.validator.apply(this,arguments)};c.reset(c.mirroring.models,{silent:true});c.observe(a);this.set("editLibrary",a);j.prototype.activate.apply(this,arguments)}});m.exports=k},{}],2:[function(i,n,j){var k=wp.media.controller.Library,o=wp.media.view.l10n,m=jQuery,l;l=k.extend({defaults:{multiple:false,sortable:true,date:false,searchable:false,content:"browse",describe:true,dragInfo:true,idealColumnWidth:170,editing:false,priority:60,SettingsView:false,syncSelection:false},initialize:function(){var a=this.get("collectionType");if("video"===this.get("type")){a="video-"+a}this.set("id",a+"-edit");this.set("toolbar",a+"-edit");if(!this.get("library")){this.set("library",new wp.media.model.Selection())}if(!this.get("AttachmentView")){this.set("AttachmentView",wp.media.view.Attachment.EditLibrary)}k.prototype.initialize.apply(this,arguments)},activate:function(){var a=this.get("library");a.props.set("type",this.get("type"));this.get("library").observe(wp.Uploader.queue);this.frame.on("content:render:browse",this.renderSettings,this);k.prototype.activate.apply(this,arguments)},deactivate:function(){this.get("library").unobserve(wp.Uploader.queue);this.frame.off("content:render:browse",this.renderSettings,this);k.prototype.deactivate.apply(this,arguments)},renderSettings:function(g){var d=this.get("library"),c=this.get("collectionType"),b=this.get("dragInfoText"),f=this.get("SettingsView"),a={};if(!d||!g){return}d[c]=d[c]||new Backbone.Model();a[c]=new f({controller:this,model:d[c],priority:40});g.sidebar.set(a);if(b){g.toolbar.set("dragInfo",new wp.media.View({el:m('<div class="instructions">'+b+"</div>")[0],priority:-40}))}g.toolbar.set("reverse",{text:o.reverseOrder,priority:80,click:function(){d.reset(d.toArray().reverse())}})}});n.exports=l},{}],3:[function(k,i,h){var j=wp.media.view.l10n,g;g=wp.media.controller.State.extend({defaults:{id:"cropper",title:j.cropImage,toolbar:"crop",content:"crop",router:false,canSkipCrop:false,doCropArgs:{}},activate:function(){this.frame.on("content:create:crop",this.createCropContent,this);this.frame.on("close",this.removeCropper,this);this.set("selection",new Backbone.Collection(this.frame._selection.single))},deactivate:function(){this.frame.toolbar.mode("browse")},createCropContent:function(){this.cropperView=new wp.media.view.Cropper({controller:this,attachment:this.get("selection").first()});this.cropperView.on("image-loaded",this.createCropToolbar,this);this.frame.content.set(this.cropperView)},removeCropper:function(){this.imgSelect.cancelSelection();this.imgSelect.setOptions({remove:true});this.imgSelect.update();this.cropperView.remove()},createCropToolbar:function(){var a,b;a=this.get("canSkipCrop")||false;b={controller:this.frame,items:{insert:{style:"primary",text:j.cropImage,priority:80,requires:{library:false,selection:false},click:function(){var d=this.controller,c;c=d.state().get("selection").first();c.set({cropDetails:d.state().imgSelect.getSelection()});this.$el.text(j.cropping);this.$el.attr("disabled",true);d.state().doCrop(c).done(function(f){d.trigger("cropped",f);d.close()}).fail(function(){d.trigger("content:error:crop")})}}}};if(a){_.extend(b.items,{skip:{style:"secondary",text:j.skipCropping,priority:70,requires:{library:false,selection:false},click:function(){var c=this.controller.state().get("selection").first();this.controller.state().cropperView.remove();this.controller.trigger("skippedcrop",c);this.controller.close()}}})}this.frame.toolbar.set(new wp.media.view.Toolbar(b))},doCrop:function(a){return wp.ajax.post("custom-header-crop",_.extend({},this.defaults.doCropArgs,{nonce:a.get("nonces").edit,id:a.get("id"),cropDetails:a.get("cropDetails")}))}});i.exports=g},{}],4:[function(g,k,h){var i=wp.media.controller,j;j=i.Cropper.extend({doCrop:function(a){var b=a.get("cropDetails"),c=this.get("control"),d=b.width/b.height;if(c.params.flex_width&&c.params.flex_height){b.dst_width=b.width;b.dst_height=b.height}else{b.dst_width=c.params.flex_width?c.params.height*d:c.params.width;b.dst_height=c.params.flex_height?c.params.width/d:c.params.height}return wp.ajax.post("crop-image",{wp_customize:"on",nonce:a.get("nonces").edit,id:a.get("id"),context:c.id,cropDetails:b})}});k.exports=j},{}],5:[function(k,i,h){var j=wp.media.view.l10n,g;g=wp.media.controller.State.extend({defaults:{id:"edit-image",title:j.editImage,menu:false,toolbar:"edit-image",content:"edit-image",url:""},activate:function(){this.frame.on("toolbar:render:edit-image",_.bind(this.toolbar,this))},deactivate:function(){this.frame.off("toolbar:render:edit-image")},toolbar:function(){var a=this.frame,c=a.lastState(),b=c&&c.id;a.toolbar.set(new wp.media.view.Toolbar({controller:a,items:{back:{style:"primary",text:j.back,priority:20,click:function(){if(b){a.setState(b)}else{a.close()}}}}}))}});i.exports=g},{}],6:[function(h,l,i){var m=wp.media.view.l10n,j=Backbone.$,k;k=wp.media.controller.State.extend({defaults:{id:"embed",title:m.insertFromUrlTitle,content:"embed",menu:"default",toolbar:"main-embed",priority:120,type:"link",url:"",metadata:{}},sensitivity:400,initialize:function(a){this.metadata=a.metadata;this.debouncedScan=_.debounce(_.bind(this.scan,this),this.sensitivity);this.props=new Backbone.Model(this.metadata||{url:""});this.props.on("change:url",this.debouncedScan,this);this.props.on("change:url",this.refresh,this);this.on("scan",this.scanImage,this)},scan:function(){var b,a=this,c={type:"link",scanners:[]};if(this.props.get("url")){this.trigger("scan",c)}if(c.scanners.length){b=c.scanners=j.when.apply(j,c.scanners);b.always(function(){if(a.get("scanners")===b){a.set("loading",false)}})}else{c.scanners=null}c.loading=!!c.scanners;this.set(c)},scanImage:function(f){var a=this.frame,c=this,d=this.props.get("url"),b=new Image(),g=j.Deferred();f.scanners.push(g.promise());b.onload=function(){g.resolve();if(c!==a.state()||d!==c.props.get("url")){return}c.set({type:"image"});c.props.set({width:b.width,height:b.height})};b.onerror=g.reject;b.src=d},refresh:function(){this.frame.toolbar.get().refresh()},reset:function(){this.props.clear().set({url:""});if(this.active){this.refresh()}}});l.exports=k},{}],7:[function(i,n,j){var m=wp.media.model.Attachment,k=wp.media.controller.Library,o=wp.media.view.l10n,l;l=k.extend({defaults:_.defaults({id:"featured-image",title:o.setFeaturedImageTitle,multiple:false,filterable:"uploaded",toolbar:"featured-image",priority:60,syncSelection:true},k.prototype.defaults),initialize:function(){var a,b;if(!this.get("library")){this.set("library",wp.media.query({type:"image"}))}k.prototype.initialize.apply(this,arguments);a=this.get("library");b=a.comparator;a.comparator=function(d,f){var g=!!this.mirroring.get(d.cid),c=!!this.mirroring.get(f.cid);if(!g&&c){return -1}else{if(g&&!c){return 1}else{return b.apply(this,arguments)}}};a.observe(this.get("selection"))},activate:function(){this.updateSelection();this.frame.on("open",this.updateSelection,this);k.prototype.activate.apply(this,arguments)},deactivate:function(){this.frame.off("open",this.updateSelection,this);k.prototype.deactivate.apply(this,arguments)},updateSelection:function(){var c=this.get("selection"),a=wp.media.view.settings.post.featuredImageId,b;if(""!==a&&-1!==a){b=m.get(a);b.fetch()}c.reset(b?[b]:[])}});n.exports=l},{}],8:[function(i,n,j){var m=wp.media.model.Selection,k=wp.media.controller.Library,o=wp.media.view.l10n,l;l=k.extend({defaults:_.defaults({id:"gallery-library",title:o.addToGalleryTitle,multiple:"add",filterable:"uploaded",menu:"gallery",toolbar:"gallery-add",priority:100,syncSelection:false},k.prototype.defaults),initialize:function(){if(!this.get("library")){this.set("library",wp.media.query({type:"image"}))}k.prototype.initialize.apply(this,arguments)},activate:function(){var b=this.get("library"),a=this.frame.state("gallery-edit").get("library");if(this.editLibrary&&this.editLibrary!==a){b.unobserve(this.editLibrary)}b.validator=function(c){return !!this.mirroring.get(c.cid)&&!a.get(c.cid)&&m.prototype.validator.apply(this,arguments)};b.reset(b.mirroring.models,{silent:true});b.observe(a);this.editLibrary=a;k.prototype.activate.apply(this,arguments)}});n.exports=l},{}],9:[function(m,k,i){var j=wp.media.controller.Library,l=wp.media.view.l10n,h;h=j.extend({defaults:{id:"gallery-edit",title:l.editGalleryTitle,multiple:false,searchable:false,sortable:true,date:false,display:false,content:"browse",toolbar:"gallery-edit",describe:true,displaySettings:true,dragInfo:true,idealColumnWidth:170,editing:false,priority:60,syncSelection:false},initialize:function(){if(!this.get("library")){this.set("library",new wp.media.model.Selection())}if(!this.get("AttachmentView")){this.set("AttachmentView",wp.media.view.Attachment.EditLibrary)}j.prototype.initialize.apply(this,arguments)},activate:function(){var a=this.get("library");a.props.set("type","image");this.get("library").observe(wp.Uploader.queue);this.frame.on("content:render:browse",this.gallerySettings,this);j.prototype.activate.apply(this,arguments)},deactivate:function(){this.get("library").unobserve(wp.Uploader.queue);this.frame.off("content:render:browse",this.gallerySettings,this);j.prototype.deactivate.apply(this,arguments)},gallerySettings:function(a){if(!this.get("displaySettings")){return}var b=this.get("library");if(!b||!a){return}b.gallery=b.gallery||new Backbone.Model();a.sidebar.set({gallery:new wp.media.view.Settings.Gallery({controller:this,model:b.gallery,priority:40})});a.toolbar.set("reverse",{text:l.reverseOrder,priority:80,click:function(){b.reset(b.toArray().reverse())}})}});k.exports=h},{}],10:[function(o,m,i){var j=wp.media.controller.State,l=wp.media.controller.Library,n=wp.media.view.l10n,k;k=j.extend({defaults:_.defaults({id:"image-details",title:n.imageDetailsTitle,content:"image-details",menu:false,router:false,toolbar:"image-details",editing:false,priority:60},l.prototype.defaults),initialize:function(a){this.image=a.image;j.prototype.initialize.apply(this,arguments)},activate:function(){this.frame.modal.$el.addClass("image-details")}});m.exports=k},{}],11:[function(o,m,i){var n=wp.media.view.l10n,j=window.getUserSetting,l=window.setUserSetting,k;k=wp.media.controller.State.extend({defaults:{id:"library",title:n.mediaLibraryTitle,multiple:false,content:"upload",menu:"default",router:"browse",toolbar:"select",searchable:true,filterable:false,sortable:true,autoSelect:true,describe:false,contentUserSetting:true,syncSelection:true},initialize:function(){var a=this.get("selection"),b;if(!this.get("library")){this.set("library",wp.media.query())}if(!(a instanceof wp.media.model.Selection)){b=a;if(!b){b=this.get("library").props.toJSON();b=_.omit(b,"orderby","query")}this.set("selection",new wp.media.model.Selection(null,{multiple:this.get("multiple"),props:b}))}this.resetDisplays()},activate:function(){this.syncSelection();wp.Uploader.queue.on("add",this.uploading,this);this.get("selection").on("add remove reset",this.refreshContent,this);if(this.get("router")&&this.get("contentUserSetting")){this.frame.on("content:activate",this.saveContentMode,this);this.set("content",j("libraryContent",this.get("content")))}},deactivate:function(){this.recordSelection();this.frame.off("content:activate",this.saveContentMode,this);this.get("selection").off(null,null,this);wp.Uploader.queue.off(null,null,this)},reset:function(){this.get("selection").reset();this.resetDisplays();this.refreshContent()},resetDisplays:function(){var a=wp.media.view.settings.defaultProps;this._displays=[];this._defaultDisplaySettings={align:j("align",a.align)||"none",size:j("imgsize",a.size)||"medium",link:j("urlbutton",a.link)||"none"}},display:function(a){var b=this._displays;if(!b[a.cid]){b[a.cid]=new Backbone.Model(this.defaultDisplaySettings(a))}return b[a.cid]},defaultDisplaySettings:function(a){var b=_.clone(this._defaultDisplaySettings);if(b.canEmbed=this.canEmbed(a)){b.link="embed"}else{if(!this.isImageAttachment(a)&&b.link==="none"){b.link="file"}}return b},isImageAttachment:function(a){if(a.get("uploading")){return/\.(jpe?g|png|gif)$/i.test(a.get("filename"))}return a.get("type")==="image"},canEmbed:function(a){if(!a.get("uploading")){var b=a.get("type");if(b!=="audio"&&b!=="video"){return false}}return _.contains(wp.media.view.settings.embedExts,a.get("filename").split(".").pop())},refreshContent:function(){var c=this.get("selection"),a=this.frame,d=a.router.get(),b=a.content.mode();if(this.active&&!c.length&&d&&!d.get(b)){this.frame.content.render(this.get("content"))}},uploading:function(a){var b=this.frame.content;if("upload"===b.mode()){this.frame.content.mode("browse")}if(this.get("autoSelect")){this.get("selection").add(a);this.frame.trigger("library:selection:add")}},saveContentMode:function(){if("browse"!==this.get("router")){return}var a=this.frame.content.mode(),b=this.frame.router.get();if(b&&b.get(a)){l("libraryContent",a)}}});_.extend(k.prototype,wp.media.selectionSync);m.exports=k},{}],12:[function(g,k,h){var j=wp.media.controller.Library,i;i=j.extend({defaults:_.defaults({filterable:"uploaded",displaySettings:false,priority:80,syncSelection:false},j.prototype.defaults),initialize:function(a){this.media=a.media;this.type=a.type;this.set("library",wp.media.query({type:this.type}));j.prototype.initialize.apply(this,arguments)},activate:function(){if(wp.media.frame.lastMime){this.set("library",wp.media.query({type:wp.media.frame.lastMime}));delete wp.media.frame.lastMime}j.prototype.activate.apply(this,arguments)}});k.exports=i},{}],13:[function(f,i,g){var h=function(a){_.extend(this,_.pick(a||{},"id","view","selector"))};h.extend=Backbone.Model.extend;_.extend(h.prototype,{mode:function(a){if(!a){return this._mode}if(a===this._mode){return this}this.trigger("deactivate");this._mode=a;this.render(a);this.trigger("activate");return this},render:function(b){if(b&&b!==this._mode){return this.mode(b)}var a={view:null},c;this.trigger("create",a);c=a.view;this.trigger("render",c);if(c){this.set(c)}return this},get:function(){return this.view.views.first(this.selector)},set:function(b,a){if(a){a.add=false}return this.view.views.set(this.selector,b,a)},trigger:function(b){var a,c;if(!this._mode){return}c=_.toArray(arguments);a=this.id+":"+b;c[0]=a+":"+this._mode;this.view.trigger.apply(this.view,c);c[0]=a;this.view.trigger.apply(this.view,c);return this}});i.exports=h},{}],14:[function(m,k,i){var j=wp.media.controller.Library,l=wp.media.view.l10n,h;h=j.extend({defaults:_.defaults({id:"replace-image",title:l.replaceImageTitle,multiple:false,filterable:"uploaded",toolbar:"replace",menu:false,priority:60,syncSelection:true},j.prototype.defaults),initialize:function(a){var b,c;this.image=a.image;if(!this.get("library")){this.set("library",wp.media.query({type:"image"}))}j.prototype.initialize.apply(this,arguments);b=this.get("library");c=b.comparator;b.comparator=function(f,g){var o=!!this.mirroring.get(f.cid),d=!!this.mirroring.get(g.cid);if(!o&&d){return -1}else{if(o&&!d){return 1}else{return c.apply(this,arguments)}}};b.observe(this.get("selection"))},activate:function(){this.updateSelection();j.prototype.activate.apply(this,arguments)},updateSelection:function(){var b=this.get("selection"),a=this.image.attachment;b.reset(a?[a]:[])}});k.exports=h},{}],15:[function(k,j,g){var i=wp.media.controller,h;h=i.Cropper.extend({activate:function(){this.frame.on("content:create:crop",this.createCropContent,this);this.frame.on("close",this.removeCropper,this);this.set("selection",new Backbone.Collection(this.frame._selection.single))},createCropContent:function(){this.cropperView=new wp.media.view.SiteIconCropper({controller:this,attachment:this.get("selection").first()});this.cropperView.on("image-loaded",this.createCropToolbar,this);this.frame.content.set(this.cropperView)},doCrop:function(a){var b=a.get("cropDetails"),c=this.get("control");b.dst_width=c.params.width;b.dst_height=c.params.height;return wp.ajax.post("crop-image",{nonce:a.get("nonces").edit,id:a.get("id"),context:"site-icon",cropDetails:b})}});j.exports=h},{}],16:[function(i,h,f){var g=function(a){this.states=new Backbone.Collection(a)};g.extend=Backbone.Model.extend;_.extend(g.prototype,Backbone.Events,{state:function(a){this.states=this.states||new Backbone.Collection();a=a||this._state;if(a&&!this.states.get(a)){this.states.add({id:a})}return this.states.get(a)},setState:function(a){var b=this.state();if((b&&a===b.id)||!this.states||!this.states.get(a)){return this}if(b){b.trigger("deactivate");this._lastState=b.id}this._state=a;this.state().trigger("activate");return this},lastState:function(){if(this._lastState){return this.state(this._lastState)}}});_.each(["on","off","trigger"],function(a){g.prototype[a]=function(){this.states=this.states||new Backbone.Collection();this.states[a].apply(this.states,arguments);return this}});h.exports=g},{}],17:[function(i,h,f){var g=Backbone.Model.extend({constructor:function(){this.on("activate",this._preActivate,this);this.on("activate",this.activate,this);this.on("activate",this._postActivate,this);this.on("deactivate",this._deactivate,this);this.on("deactivate",this.deactivate,this);this.on("reset",this.reset,this);this.on("ready",this._ready,this);this.on("ready",this.ready,this);Backbone.Model.apply(this,arguments);this.on("change:menu",this._updateMenu,this)},ready:function(){},activate:function(){},deactivate:function(){},reset:function(){},_ready:function(){this._updateMenu()},_preActivate:function(){this.active=true},_postActivate:function(){this.on("change:menu",this._menu,this);this.on("change:titleMode",this._title,this);this.on("change:content",this._content,this);this.on("change:toolbar",this._toolbar,this);this.frame.on("title:render:default",this._renderTitle,this);this._title();this._menu();this._toolbar();this._content();this._router()},_deactivate:function(){this.active=false;this.frame.off("title:render:default",this._renderTitle,this);this.off("change:menu",this._menu,this);this.off("change:titleMode",this._title,this);this.off("change:content",this._content,this);this.off("change:toolbar",this._toolbar,this)},_title:function(){this.frame.title.render(this.get("titleMode")||"default")},_renderTitle:function(a){a.$el.text(this.get("title")||"")},_router:function(){var b=this.frame.router,a=this.get("router"),c;this.frame.$el.toggleClass("hide-router",!a);if(!a){return}this.frame.router.render(a);c=b.get();if(c&&c.select){c.select(this.frame.content.mode())}},_menu:function(){var a=this.frame.menu,b=this.get("menu"),c;this.frame.$el.toggleClass("hide-menu",!b);if(!b){return}a.mode(b);c=a.get();if(c&&c.select){c.select(this.id)}},_updateMenu:function(){var b=this.previous("menu"),a=this.get("menu");if(b){this.frame.off("menu:render:"+b,this._renderMenu,this)}if(a){this.frame.on("menu:render:"+a,this._renderMenu,this)}},_renderMenu:function(d){var b=this.get("menuItem"),a=this.get("title"),c=this.get("priority");if(!b&&a){b={text:a};if(c){b.priority=c}}if(!b){return}d.set(this.id,b)}});_.each(["toolbar","content"],function(a){g.prototype["_"+a]=function(){var b=this.get(a);if(b){this.frame[a].render(b)}}});h.exports=g},{}],18:[function(f,i,g){var h={syncSelection:function(){var a=this.get("selection"),b=this.frame._selection;if(!this.get("syncSelection")||!b||!a){return}if(a.multiple){a.reset([],{silent:true});a.validateAll(b.attachments);b.difference=_.difference(b.attachments.models,a.models)}a.single(b.single)},recordSelection:function(){var a=this.get("selection"),b=this.frame._selection;if(!this.get("syncSelection")||!b||!a){return}if(a.multiple){b.attachments.reset(a.toArray().concat(b.difference));b.difference=[]}else{b.attachments.add(a.toArray())}b.single=a._single}};i.exports=h},{}],19:[function(h,l,i){var j=wp.media,k=jQuery,m;j.isTouchDevice=("ontouchend" in document);m=j.view.l10n=window._wpMediaViewsL10n||{};j.view.settings=m.settings||{};delete m.settings;j.model.settings.post=j.view.settings.post;k.support.transition=(function(){var c=document.documentElement.style,b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},a;a=_.find(_.keys(b),function(d){return !_.isUndefined(c[d])});return a&&{end:b[a]}}());j.events=_.extend({},Backbone.Events);j.transition=function(c,b){var a=k.Deferred();b=b||2000;if(k.support.transition){if(!(c instanceof k)){c=k(c)}c.first().one(k.support.transition.end,a.resolve);_.delay(a.resolve,b)}else{a.resolve()}return a.promise()};j.controller.Region=h("./controllers/region.js");j.controller.StateMachine=h("./controllers/state-machine.js");j.controller.State=h("./controllers/state.js");j.selectionSync=h("./utils/selection-sync.js");j.controller.Library=h("./controllers/library.js");j.controller.ImageDetails=h("./controllers/image-details.js");j.controller.GalleryEdit=h("./controllers/gallery-edit.js");j.controller.GalleryAdd=h("./controllers/gallery-add.js");j.controller.CollectionEdit=h("./controllers/collection-edit.js");j.controller.CollectionAdd=h("./controllers/collection-add.js");j.controller.FeaturedImage=h("./controllers/featured-image.js");j.controller.ReplaceImage=h("./controllers/replace-image.js");j.controller.EditImage=h("./controllers/edit-image.js");j.controller.MediaLibrary=h("./controllers/media-library.js");j.controller.Embed=h("./controllers/embed.js");j.controller.Cropper=h("./controllers/cropper.js");j.controller.CustomizeImageCropper=h("./controllers/customize-image-cropper.js");j.controller.SiteIconCropper=h("./controllers/site-icon-cropper.js");j.View=h("./views/view.js");j.view.Frame=h("./views/frame.js");j.view.MediaFrame=h("./views/media-frame.js");j.view.MediaFrame.Select=h("./views/frame/select.js");j.view.MediaFrame.Post=h("./views/frame/post.js");j.view.MediaFrame.ImageDetails=h("./views/frame/image-details.js");j.view.Modal=h("./views/modal.js");j.view.FocusManager=h("./views/focus-manager.js");j.view.UploaderWindow=h("./views/uploader/window.js");j.view.EditorUploader=h("./views/uploader/editor.js");j.view.UploaderInline=h("./views/uploader/inline.js");j.view.UploaderStatus=h("./views/uploader/status.js");j.view.UploaderStatusError=h("./views/uploader/status-error.js");j.view.Toolbar=h("./views/toolbar.js");j.view.Toolbar.Select=h("./views/toolbar/select.js");j.view.Toolbar.Embed=h("./views/toolbar/embed.js");j.view.Button=h("./views/button.js");j.view.ButtonGroup=h("./views/button-group.js");j.view.PriorityList=h("./views/priority-list.js");j.view.MenuItem=h("./views/menu-item.js");j.view.Menu=h("./views/menu.js");j.view.RouterItem=h("./views/router-item.js");j.view.Router=h("./views/router.js");j.view.Sidebar=h("./views/sidebar.js");j.view.Attachment=h("./views/attachment.js");j.view.Attachment.Library=h("./views/attachment/library.js");j.view.Attachment.EditLibrary=h("./views/attachment/edit-library.js");j.view.Attachments=h("./views/attachments.js");j.view.Search=h("./views/search.js");j.view.AttachmentFilters=h("./views/attachment-filters.js");j.view.DateFilter=h("./views/attachment-filters/date.js");j.view.AttachmentFilters.Uploaded=h("./views/attachment-filters/uploaded.js");j.view.AttachmentFilters.All=h("./views/attachment-filters/all.js");j.view.AttachmentsBrowser=h("./views/attachments/browser.js");j.view.Selection=h("./views/selection.js");j.view.Attachment.Selection=h("./views/attachment/selection.js");j.view.Attachments.Selection=h("./views/attachments/selection.js");j.view.Attachment.EditSelection=h("./views/attachment/edit-selection.js");j.view.Settings=h("./views/settings.js");j.view.Settings.AttachmentDisplay=h("./views/settings/attachment-display.js");j.view.Settings.Gallery=h("./views/settings/gallery.js");j.view.Settings.Playlist=h("./views/settings/playlist.js");j.view.Attachment.Details=h("./views/attachment/details.js");j.view.AttachmentCompat=h("./views/attachment-compat.js");j.view.Iframe=h("./views/iframe.js");j.view.Embed=h("./views/embed.js");j.view.Label=h("./views/label.js");j.view.EmbedUrl=h("./views/embed/url.js");j.view.EmbedLink=h("./views/embed/link.js");j.view.EmbedImage=h("./views/embed/image.js");j.view.ImageDetails=h("./views/image-details.js");j.view.Cropper=h("./views/cropper.js");j.view.SiteIconCropper=h("./views/site-icon-cropper.js");j.view.SiteIconPreview=h("./views/site-icon-preview.js");j.view.EditImage=h("./views/edit-image.js");j.view.Spinner=h("./views/spinner.js")},{"./controllers/collection-add.js":1,"./controllers/collection-edit.js":2,"./controllers/cropper.js":3,"./controllers/customize-image-cropper.js":4,"./controllers/edit-image.js":5,"./controllers/embed.js":6,"./controllers/featured-image.js":7,"./controllers/gallery-add.js":8,"./controllers/gallery-edit.js":9,"./controllers/image-details.js":10,"./controllers/library.js":11,"./controllers/media-library.js":12,"./controllers/region.js":13,"./controllers/replace-image.js":14,"./controllers/site-icon-cropper.js":15,"./controllers/state-machine.js":16,"./controllers/state.js":17,"./utils/selection-sync.js":18,"./views/attachment-compat.js":20,"./views/attachment-filters.js":21,"./views/attachment-filters/all.js":22,"./views/attachment-filters/date.js":23,"./views/attachment-filters/uploaded.js":24,"./views/attachment.js":25,"./views/attachment/details.js":26,"./views/attachment/edit-library.js":27,"./views/attachment/edit-selection.js":28,"./views/attachment/library.js":29,"./views/attachment/selection.js":30,"./views/attachments.js":31,"./views/attachments/browser.js":32,"./views/attachments/selection.js":33,"./views/button-group.js":34,"./views/button.js":35,"./views/cropper.js":36,"./views/edit-image.js":37,"./views/embed.js":38,"./views/embed/image.js":39,"./views/embed/link.js":40,"./views/embed/url.js":41,"./views/focus-manager.js":42,"./views/frame.js":43,"./views/frame/image-details.js":44,"./views/frame/post.js":45,"./views/frame/select.js":46,"./views/iframe.js":47,"./views/image-details.js":48,"./views/label.js":49,"./views/media-frame.js":50,"./views/menu-item.js":51,"./views/menu.js":52,"./views/modal.js":53,"./views/priority-list.js":54,"./views/router-item.js":55,"./views/router.js":56,"./views/search.js":57,"./views/selection.js":58,"./views/settings.js":59,"./views/settings/attachment-display.js":60,"./views/settings/gallery.js":61,"./views/settings/playlist.js":62,"./views/sidebar.js":63,"./views/site-icon-cropper.js":64,"./views/site-icon-preview.js":65,"./views/spinner.js":66,"./views/toolbar.js":67,"./views/toolbar/embed.js":68,"./views/toolbar/select.js":69,"./views/uploader/editor.js":70,"./views/uploader/inline.js":71,"./views/uploader/status-error.js":72,"./views/uploader/status.js":73,"./views/uploader/window.js":74,"./views/view.js":75}],20:[function(k,j,g){var i=wp.media.View,h;h=i.extend({tagName:"form",className:"compat-item",events:{submit:"preventDefault","change input":"save","change select":"save","change textarea":"save"},initialize:function(){this.listenTo(this.model,"change:compat",this.render)},dispose:function(){if(this.$(":focus").length){this.save()}return i.prototype.dispose.apply(this,arguments)},render:function(){var a=this.model.get("compat");if(!a||!a.item){return}this.views.detach();this.$el.html(a.item);this.views.render();return this},preventDefault:function(a){a.preventDefault()},save:function(b){var a={};if(b){b.preventDefault()}_.each(this.$el.serializeArray(),function(c){a[c.name]=c.value});this.controller.trigger("attachment:compat:waiting",["waiting"]);this.model.saveCompat(a).always(_.bind(this.postSave,this))},postSave:function(){this.controller.trigger("attachment:compat:ready",["ready"])}});j.exports=h},{}],21:[function(g,k,h){var i=jQuery,j;j=wp.media.View.extend({tagName:"select",className:"attachment-filters",id:"media-attachment-filters",events:{change:"change"},keys:[],initialize:function(){this.createFilters();_.extend(this.filters,this.options.filters);this.$el.html(_.chain(this.filters).map(function(b,a){return{el:i("<option></option>").val(a).html(b.text)[0],priority:b.priority||50}},this).sortBy("priority").pluck("el").value());this.listenTo(this.model,"change",this.select);this.select()},createFilters:function(){this.filters={}},change:function(){var a=this.filters[this.el.value];if(a){this.model.set(a.props)}},select:function(){var c=this.model,a="all",b=c.toJSON();_.find(this.filters,function(f,d){var m=_.all(f.props,function(o,l){return o===(_.isUndefined(b[l])?null:b[l])});if(m){return a=d}});this.$el.val(a)}});k.exports=j},{}],22:[function(k,i,g){var j=wp.media.view.l10n,h;h=wp.media.view.AttachmentFilters.extend({createFilters:function(){var a={};_.each(wp.media.view.settings.mimeTypes||{},function(b,c){a[c]={text:b,props:{status:null,type:c,uploadedTo:null,orderby:"date",order:"DESC"}}});a.all={text:j.allMediaItems,props:{status:null,type:null,uploadedTo:null,orderby:"date",order:"DESC"},priority:10};if(wp.media.view.settings.post.id){a.uploaded={text:j.uploadedToThisPost,props:{status:null,type:null,uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20}}a.unattached={text:j.unattached,props:{status:null,uploadedTo:0,type:null,orderby:"menuOrder",order:"ASC"},priority:50};if(wp.media.view.settings.mediaTrash&&this.controller.isModeActive("grid")){a.trash={text:j.trash,props:{uploadedTo:null,status:"trash",type:null,orderby:"date",order:"DESC"},priority:50}}this.filters=a}});i.exports=h},{}],23:[function(k,i,g){var j=wp.media.view.l10n,h;h=wp.media.view.AttachmentFilters.extend({id:"media-attachment-date-filters",createFilters:function(){var a={};_.each(wp.media.view.settings.months||{},function(b,c){a[c]={text:b.text,props:{year:b.year,monthnum:b.month}}});a.all={text:j.allDates,props:{monthnum:false,year:false},priority:10};this.filters=a}});i.exports=h},{}],24:[function(k,i,g){var j=wp.media.view.l10n,h;h=wp.media.view.AttachmentFilters.extend({createFilters:function(){var b=this.model.get("type"),c=wp.media.view.settings.mimeTypes,a;if(c&&b){a=c[b]}this.filters={all:{text:a||j.allMediaItems,props:{uploadedTo:null,orderby:"date",order:"DESC"},priority:10},uploaded:{text:j.uploadedToThisPost,props:{uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20},unattached:{text:j.unattached,props:{uploadedTo:0,orderby:"menuOrder",order:"ASC"},priority:50}}}});i.exports=h},{}],25:[function(h,m,i){var j=wp.media.View,k=jQuery,l;l=j.extend({tagName:"li",className:"attachment",template:wp.template("attachment"),attributes:function(){return{tabIndex:0,role:"checkbox","aria-label":this.model.get("title"),"aria-checked":false,"data-id":this.model.get("id")}},events:{"click .js--select-attachment":"toggleSelectionHandler","change [data-setting]":"updateSetting","change [data-setting] input":"updateSetting","change [data-setting] select":"updateSetting","change [data-setting] textarea":"updateSetting","click .attachment-close":"removeFromLibrary","click .check":"checkClickHandler",keydown:"toggleSelectionHandler"},buttons:{},initialize:function(){var a=this.options.selection,b=_.defaults(this.options,{rerenderOnModelChange:true});if(b.rerenderOnModelChange){this.listenTo(this.model,"change",this.render)}else{this.listenTo(this.model,"change:percent",this.progress)}this.listenTo(this.model,"change:title",this._syncTitle);this.listenTo(this.model,"change:caption",this._syncCaption);this.listenTo(this.model,"change:artist",this._syncArtist);this.listenTo(this.model,"change:album",this._syncAlbum);this.listenTo(this.model,"add",this.select);this.listenTo(this.model,"remove",this.deselect);if(a){a.on("reset",this.updateSelect,this);this.listenTo(this.model,"selection:single selection:unsingle",this.details);this.details(this.model,this.controller.state().get("selection"))}this.listenTo(this.controller,"attachment:compat:waiting attachment:compat:ready",this.updateSave)},dispose:function(){var a=this.options.selection;this.updateAll();if(a){a.off(null,null,this)}j.prototype.dispose.apply(this,arguments);return this},render:function(){var a=_.defaults(this.model.toJSON(),{orientation:"landscape",uploading:false,type:"",subtype:"",icon:"",filename:"",caption:"",title:"",dateFormatted:"",width:"",height:"",compat:false,alt:"",description:""},this.options);a.buttons=this.buttons;a.describe=this.controller.state().get("describe");if("image"===a.type){a.size=this.imageSize()}a.can={};if(a.nonces){a.can.remove=!!a.nonces["delete"];a.can.save=!!a.nonces.update}if(this.controller.state().get("allowLocalEdits")){a.allowLocalEdits=true}if(a.uploading&&!a.percent){a.percent=0}this.views.detach();this.$el.html(this.template(a));this.$el.toggleClass("uploading",a.uploading);if(a.uploading){this.$bar=this.$(".media-progress-bar div")}else{delete this.$bar}this.updateSelect();this.updateSave();this.views.render();return this},progress:function(){if(this.$bar&&this.$bar.length){this.$bar.width(this.model.get("percent")+"%")}},toggleSelectionHandler:function(b){var a;if("INPUT"===b.target.nodeName||"BUTTON"===b.target.nodeName){return}if(37===b.keyCode||38===b.keyCode||39===b.keyCode||40===b.keyCode){this.controller.trigger("attachment:keydown:arrow",b);return}if("keydown"===b.type&&13!==b.keyCode&&32!==b.keyCode){return}b.preventDefault();if(this.controller.isModeActive("grid")){if(this.controller.isModeActive("edit")){this.controller.trigger("edit:attachment",this.model,b.currentTarget);return}if(this.controller.isModeActive("select")){a="toggle"}}if(b.shiftKey){a="between"}else{if(b.ctrlKey||b.metaKey){a="toggle"}}this.toggleSelection({method:a});this.controller.trigger("selection:toggle")},toggleSelection:function(a){var f=this.collection,d=this.options.selection,g=this.model,s=a&&a.method,c,r,q,b;if(!d){return}c=d.single();s=_.isUndefined(s)?d.multiple:s;if("between"===s&&c&&d.multiple){if(c===g){return}q=f.indexOf(c);b=f.indexOf(this.model);if(q<b){r=f.models.slice(q,b+1)}else{r=f.models.slice(b,q+1)}d.add(r);d.single(g);return}else{if("toggle"===s){d[this.selected()?"remove":"add"](g);d.single(g);return}else{if("add"===s){d.add(g);d.single(g);return}}}if(!s){s="add"}if(s!=="add"){s="reset"}if(this.selected()){d[c===g?"remove":"single"](g)}else{d[s](g);d.single(g)}},updateSelect:function(){this[this.selected()?"select":"deselect"]()},selected:function(){var a=this.options.selection;if(a){return !!a.get(this.model.cid)}},select:function(c,a){var b=this.options.selection,d=this.controller;if(!b||(a&&a!==b)){return}if(this.$el.hasClass("selected")){return}this.$el.addClass("selected").attr("aria-checked",true);if(!(d.isModeActive("grid")&&d.isModeActive("select"))){this.$(".check").attr("tabindex","0")}},deselect:function(c,a){var b=this.options.selection;if(!b||(a&&a!==b)){return}this.$el.removeClass("selected").attr("aria-checked",false).find(".check").attr("tabindex","-1")},details:function(d,a){var b=this.options.selection,c;if(b!==a){return}c=b.single();this.$el.toggleClass("details",c===this.model)},imageSize:function(b){var a=this.model.get("sizes"),c=false;b=b||"medium";if(a){if(a[b]){c=a[b]}else{if(a.large){c=a.large}else{if(a.thumbnail){c=a.thumbnail}else{if(a.full){c=a.full}}}}if(c){return _.clone(c)}}return{url:this.model.get("url"),width:this.model.get("width"),height:this.model.get("height"),orientation:this.model.get("orientation")}},updateSetting:function(b){var d=k(b.target).closest("[data-setting]"),c,a;if(!d.length){return}c=d.data("setting");a=b.target.value;if(this.model.get(c)!==a){this.save(c,a)}},save:function(){var d=this,b=this._save=this._save||{status:"ready"},c=this.model.save.apply(this.model,arguments),a=b.requests?k.when(c,b.requests):c;if(b.savedTimer){clearTimeout(b.savedTimer)}this.updateSave("waiting");b.requests=a;a.always(function(){if(b.requests!==a){return}d.updateSave(a.state()==="resolved"?"complete":"error");b.savedTimer=setTimeout(function(){d.updateSave("ready");delete b.savedTimer},2000)})},updateSave:function(b){var a=this._save=this._save||{status:"ready"};if(b&&b!==a.status){this.$el.removeClass("save-"+a.status);a.status=b}this.$el.addClass("save-"+a.status);return this},updateAll:function(){var b=this.$("[data-setting]"),c=this.model,a;a=_.chain(b).map(function(f){var o=k("input, textarea, select, [value]",f),g,d;if(!o.length){return}g=k(f).data("setting");d=o.val();if(c.get(g)!==d){return[g,d]}}).compact().object().value();if(!_.isEmpty(a)){c.save(a)}},removeFromLibrary:function(a){if("keydown"===a.type&&13!==a.keyCode&&32!==a.keyCode){return}a.stopPropagation();this.collection.remove(this.model)},checkClickHandler:function(a){var b=this.options.selection;if(!b){return}a.stopPropagation();if(b.where({id:this.model.get("id")}).length){b.remove(this.model);this.$el.focus()}else{b.add(this.model)}}});_.each({caption:"_syncCaption",title:"_syncTitle",artist:"_syncArtist",album:"_syncAlbum"},function(a,b){l.prototype[a]=function(f,c){var d=this.$('[data-setting="'+b+'"]');if(!d.length){return this}if(c===d.find("input, textarea, select, [value]").val()){return this}return this.render()}});m.exports=l},{}],26:[function(m,k,h){var j=wp.media.view.Attachment,l=wp.media.view.l10n,i;i=j.extend({tagName:"div",className:"attachment-details",template:wp.template("attachment-details"),attributes:function(){return{tabIndex:0,"data-id":this.model.get("id")}},events:{"change [data-setting]":"updateSetting","change [data-setting] input":"updateSetting","change [data-setting] select":"updateSetting","change [data-setting] textarea":"updateSetting","click .delete-attachment":"deleteAttachment","click .trash-attachment":"trashAttachment","click .untrash-attachment":"untrashAttachment","click .edit-attachment":"editAttachment",keydown:"toggleSelectionHandler"},initialize:function(){this.options=_.defaults(this.options,{rerenderOnModelChange:false});this.on("ready",this.initialFocus);j.prototype.initialize.apply(this,arguments)},initialFocus:function(){if(!wp.media.isTouchDevice){this.$('input[type="text"]').eq(0).focus()}},deleteAttachment:function(a){a.preventDefault();if(window.confirm(l.warnDelete)){this.model.destroy();this.controller.modal.focusManager.focus()}},trashAttachment:function(a){var b=this.controller.library;a.preventDefault();if(wp.media.view.settings.mediaTrash&&"edit-metadata"===this.controller.content.mode()){this.model.set("status","trash");this.model.save().done(function(){b._requery(true)})}else{this.model.destroy()}},untrashAttachment:function(a){var b=this.controller.library;a.preventDefault();this.model.set("status","inherit");this.model.save().done(function(){b._requery(true)})},editAttachment:function(a){var b=this.controller.states.get("edit-image");if(window.imageEdit&&b){a.preventDefault();b.set("image",this.model);this.controller.setState("edit-image")}else{this.$el.addClass("needs-refresh")}},toggleSelectionHandler:function(a){if("keydown"===a.type&&9===a.keyCode&&a.shiftKey&&a.target===this.$(":tabbable").get(0)){this.controller.trigger("attachment:details:shift-tab",a);return false}if(37===a.keyCode||38===a.keyCode||39===a.keyCode||40===a.keyCode){this.controller.trigger("attachment:keydown:arrow",a);return}}});k.exports=i},{}],27:[function(f,i,g){var h=wp.media.view.Attachment.extend({buttons:{close:true}});i.exports=h},{}],28:[function(f,i,g){var h=wp.media.view.Attachment.Selection.extend({buttons:{close:true}});i.exports=h},{}],29:[function(f,i,g){var h=wp.media.view.Attachment.extend({buttons:{check:true}});i.exports=h},{}],30:[function(f,i,g){var h=wp.media.view.Attachment.extend({className:"attachment selection",toggleSelection:function(){this.options.selection.single(this.model)}});i.exports=h},{}],31:[function(h,l,i){var j=wp.media.View,k=jQuery,m;m=j.extend({tagName:"ul",className:"attachments",attributes:{tabIndex:-1},initialize:function(){this.el.id=_.uniqueId("__attachments-view-");_.defaults(this.options,{refreshSensitivity:wp.media.isTouchDevice?300:200,refreshThreshold:3,AttachmentView:wp.media.view.Attachment,sortable:false,resize:true,idealColumnWidth:k(window).width()<640?135:150});this._viewsByCid={};this.$window=k(window);this.resizeEvent="resize.media-modal-columns";this.collection.on("add",function(a){this.views.add(this.createAttachmentView(a),{at:this.collection.indexOf(a)})},this);this.collection.on("remove",function(a){var b=this._viewsByCid[a.cid];delete this._viewsByCid[a.cid];if(b){b.remove()}},this);this.collection.on("reset",this.render,this);this.listenTo(this.controller,"library:selection:add",this.attachmentFocus);this.scroll=_.chain(this.scroll).bind(this).throttle(this.options.refreshSensitivity).value();this.options.scrollElement=this.options.scrollElement||this.el;k(this.options.scrollElement).on("scroll",this.scroll);this.initSortable();_.bindAll(this,"setColumns");if(this.options.resize){this.on("ready",this.bindEvents);this.controller.on("open",this.setColumns);_.defer(this.setColumns,this)}},bindEvents:function(){this.$window.off(this.resizeEvent).on(this.resizeEvent,_.debounce(this.setColumns,50))},attachmentFocus:function(){this.$("li:first").focus()},restoreFocus:function(){this.$("li.selected:first").focus()},arrowEvent:function(b){var f=this.$el.children("li"),c=this.columns,d=f.filter(":focus").index(),a=(d+1)<=c?1:Math.ceil((d+1)/c);if(d===-1){return}if(37===b.keyCode){if(0===d){return}f.eq(d-1).focus()}if(38===b.keyCode){if(1===a){return}f.eq(d-c).focus()}if(39===b.keyCode){if(f.length===d){return}f.eq(d+1).focus()}if(40===b.keyCode){if(Math.ceil(f.length/c)===a){return}f.eq(d+c).focus()}},dispose:function(){this.collection.props.off(null,null,this);if(this.options.resize){this.$window.off(this.resizeEvent)}j.prototype.dispose.apply(this,arguments)},setColumns:function(){var a=this.columns,b=this.$el.width();if(b){this.columns=Math.min(Math.round(b/this.options.idealColumnWidth),12)||1;if(!a||a!==this.columns){this.$el.closest(".media-frame-content").attr("data-columns",this.columns)}}},initSortable:function(){var a=this.collection;if(!this.options.sortable||!k.fn.sortable){return}this.$el.sortable(_.extend({disabled:!!a.comparator,tolerance:"pointer",start:function(c,b){b.item.data("sortableIndexStart",b.item.index())},update:function(c,b){var d=a.at(b.item.data("sortableIndexStart")),f=a.comparator;delete a.comparator;a.remove(d,{silent:true});a.add(d,{silent:true,at:b.item.index()});a.comparator=f;a.trigger("reset",a);a.saveMenuOrder()}},this.options.sortable));a.props.on("change:orderby",function(){this.$el.sortable("option","disabled",!!a.comparator)},this);this.collection.props.on("change:orderby",this.refreshSortable,this);this.refreshSortable()},refreshSortable:function(){if(!this.options.sortable||!k.fn.sortable){return}var a=this.collection,b=a.props.get("orderby"),c="menuOrder"===b||!a.comparator;this.$el.sortable("option","disabled",!c)},createAttachmentView:function(a){var b=new this.options.AttachmentView({controller:this.controller,model:a,collection:this.collection,selection:this.options.selection});return this._viewsByCid[a.cid]=b},prepare:function(){if(this.collection.length){this.views.set(this.collection.map(this.createAttachmentView,this))}else{this.views.unset();this.collection.more().done(this.scroll)}},ready:function(){this.scroll()},scroll:function(){var d=this,c=this.options.scrollElement,a=c.scrollTop,b;if(c===document){c=document.body;a=k(document).scrollTop()}if(!k(c).is(":visible")||!this.collection.hasMore()){return}b=this.views.parent.toolbar;if(c.scrollHeight-(a+c.clientHeight)<c.clientHeight/3){b.get("spinner").show()}if(c.scrollHeight<a+(c.clientHeight*this.options.refreshThreshold)){this.collection.more().done(function(){d.scroll();b.get("spinner").hide()})}}});l.exports=m},{}],32:[function(j,p,k){var l=wp.media.View,n=wp.media.view.settings.mediaTrash,q=wp.media.view.l10n,m=jQuery,o;o=l.extend({tagName:"div",className:"attachments-browser",initialize:function(){_.defaults(this.options,{filters:false,search:true,date:true,display:false,sidebar:true,AttachmentView:wp.media.view.Attachment.Library});this.controller.on("toggle:upload:attachment",this.toggleUploader,this);this.controller.on("edit:selection",this.editSelection);this.createToolbar();if(this.options.sidebar&&"errors"===this.options.sidebar){this.createSidebar()}this.createUploader();this.createAttachments();if(this.options.sidebar&&"errors"!==this.options.sidebar){this.createSidebar()}this.updateContent();if(!this.options.sidebar||"errors"===this.options.sidebar){this.$el.addClass("hide-sidebar");if("errors"===this.options.sidebar){this.$el.addClass("sidebar-for-errors")}}this.collection.on("add remove reset",this.updateContent,this)},editSelection:function(a){a.$(".media-button-backToLibrary").focus()},dispose:function(){this.options.selection.off(null,null,this);l.prototype.dispose.apply(this,arguments);return this},createToolbar:function(){var c,b,a;a={controller:this.controller};if(this.controller.isModeActive("grid")){a.className="media-toolbar wp-filter"}this.toolbar=new wp.media.view.Toolbar(a);this.views.add(this.toolbar);this.toolbar.set("spinner",new wp.media.view.Spinner({priority:-60}));if(-1!==m.inArray(this.options.filters,["uploaded","all"])){this.toolbar.set("filtersLabel",new wp.media.view.Label({value:q.filterByType,attributes:{"for":"media-attachment-filters"},priority:-80}).render());if("uploaded"===this.options.filters){this.toolbar.set("filters",new wp.media.view.AttachmentFilters.Uploaded({controller:this.controller,model:this.collection.props,priority:-80}).render())}else{b=new wp.media.view.AttachmentFilters.All({controller:this.controller,model:this.collection.props,priority:-80});this.toolbar.set("filters",b.render())}}if(this.controller.isModeActive("grid")){c=l.extend({className:"view-switch media-grid-view-switch",template:wp.template("media-library-view-switcher")});this.toolbar.set("libraryViewSwitcher",new c({controller:this.controller,priority:-90}).render());this.toolbar.set("dateFilterLabel",new wp.media.view.Label({value:q.filterByDate,attributes:{"for":"media-attachment-date-filters"},priority:-75}).render());this.toolbar.set("dateFilter",new wp.media.view.DateFilter({controller:this.controller,model:this.collection.props,priority:-75}).render());this.toolbar.set("selectModeToggleButton",new wp.media.view.SelectModeToggleButton({text:q.bulkSelect,controller:this.controller,priority:-70}).render());this.toolbar.set("deleteSelectedButton",new wp.media.view.DeleteSelectedButton({filters:b,style:"primary",disabled:true,text:n?q.trashSelected:q.deleteSelected,controller:this.controller,priority:-60,click:function(){var f=[],g=[],h=this.controller.state().get("selection"),d=this.controller.state().get("library");if(!h.length){return}if(!n&&!window.confirm(q.warnBulkDelete)){return}if(n&&"trash"!==h.at(0).get("status")&&!window.confirm(q.warnBulkTrash)){return}h.each(function(i){if(!i.get("nonces")["delete"]){g.push(i);return}if(n&&"trash"===i.get("status")){i.set("status","inherit");f.push(i.save());g.push(i)}else{if(n){i.set("status","trash");f.push(i.save());g.push(i)}else{i.destroy({wait:true})}}});if(f.length){h.remove(g);m.when.apply(null,f).then(_.bind(function(){d._requery(true);this.controller.trigger("selection:action:done")},this))}else{this.controller.trigger("selection:action:done")}}}).render());if(n){this.toolbar.set("deleteSelectedPermanentlyButton",new wp.media.view.DeleteSelectedPermanentlyButton({filters:b,style:"primary",disabled:true,text:q.deleteSelected,controller:this.controller,priority:-55,click:function(){var f=[],d=this.controller.state().get("selection");if(!d.length||!window.confirm(q.warnBulkDelete)){return}d.each(function(g){if(!g.get("nonces")["delete"]){f.push(g);return}g.destroy()});d.remove(f);this.controller.trigger("selection:action:done")}}).render())}}else{if(this.options.date){this.toolbar.set("dateFilterLabel",new wp.media.view.Label({value:q.filterByDate,attributes:{"for":"media-attachment-date-filters"},priority:-75}).render());this.toolbar.set("dateFilter",new wp.media.view.DateFilter({controller:this.controller,model:this.collection.props,priority:-75}).render())}}if(this.options.search){this.toolbar.set("searchLabel",new wp.media.view.Label({value:q.searchMediaLabel,attributes:{"for":"media-search-input"},priority:60}).render());this.toolbar.set("search",new wp.media.view.Search({controller:this.controller,model:this.collection.props,priority:60}).render())}if(this.options.dragInfo){this.toolbar.set("dragInfo",new l({el:m('<div class="instructions">'+q.dragInfo+"</div>")[0],priority:-40}))}if(this.options.suggestedWidth&&this.options.suggestedHeight){this.toolbar.set("suggestedDimensions",new l({el:m('<div class="instructions">'+q.suggestedDimensions+" "+this.options.suggestedWidth+" &times; "+this.options.suggestedHeight+"</div>")[0],priority:-40}))}},updateContent:function(){var b=this,a;if(this.controller.isModeActive("grid")){a=b.attachmentsNoResults}else{a=b.uploader}if(!this.collection.length){this.toolbar.get("spinner").show();this.dfd=this.collection.more().done(function(){if(!b.collection.length){a.$el.removeClass("hidden")}else{a.$el.addClass("hidden")}b.toolbar.get("spinner").hide()})}else{a.$el.addClass("hidden");b.toolbar.get("spinner").hide()}},createUploader:function(){this.uploader=new wp.media.view.UploaderInline({controller:this.controller,status:false,message:this.controller.isModeActive("grid")?"":q.noItemsFound,canClose:this.controller.isModeActive("grid")});this.uploader.hide();this.views.add(this.uploader)},toggleUploader:function(){if(this.uploader.$el.hasClass("hidden")){this.uploader.show()}else{this.uploader.hide()}},createAttachments:function(){this.attachments=new wp.media.view.Attachments({controller:this.controller,collection:this.collection,selection:this.options.selection,model:this.model,sortable:this.options.sortable,scrollElement:this.options.scrollElement,idealColumnWidth:this.options.idealColumnWidth,AttachmentView:this.options.AttachmentView});this.controller.on("attachment:keydown:arrow",_.bind(this.attachments.arrowEvent,this.attachments));this.controller.on("attachment:details:shift-tab",_.bind(this.attachments.restoreFocus,this.attachments));this.views.add(this.attachments);if(this.controller.isModeActive("grid")){this.attachmentsNoResults=new l({controller:this.controller,tagName:"p"});this.attachmentsNoResults.$el.addClass("hidden no-media");this.attachmentsNoResults.$el.html(q.noMedia);this.views.add(this.attachmentsNoResults)}},createSidebar:function(){var c=this.options,b=c.selection,a=this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.views.add(a);if(this.controller.uploader){a.set("uploads",new wp.media.view.UploaderStatus({controller:this.controller,priority:40}))}b.on("selection:single",this.createSingle,this);b.on("selection:unsingle",this.disposeSingle,this);if(b.single()){this.createSingle()}},createSingle:function(){var b=this.sidebar,a=this.options.selection.single();b.set("details",new wp.media.view.Attachment.Details({controller:this.controller,model:a,priority:80}));b.set("compat",new wp.media.view.AttachmentCompat({controller:this.controller,model:a,priority:120}));if(this.options.display){b.set("display",new wp.media.view.Settings.AttachmentDisplay({controller:this.controller,model:this.model.display(a),attachment:a,priority:160,userSettings:this.model.get("displayUserSettings")}))}if(this.model.id==="insert"){b.$el.addClass("visible")}},disposeSingle:function(){var a=this.sidebar;a.unset("details");a.unset("compat");a.unset("display");a.$el.removeClass("visible")}});p.exports=o},{}],33:[function(g,j,h){var k=wp.media.view.Attachments,i;i=k.extend({events:{},initialize:function(){_.defaults(this.options,{sortable:false,resize:false,AttachmentView:wp.media.view.Attachment.Selection});return k.prototype.initialize.apply(this,arguments)}});j.exports=i},{}],34:[function(g,j,h){var i=Backbone.$,k;k=wp.media.View.extend({tagName:"div",className:"button-group button-large media-button-group",initialize:function(){this.buttons=_.map(this.options.buttons||[],function(a){if(a instanceof Backbone.View){return a}else{return new wp.media.view.Button(a).render()}});delete this.options.buttons;if(this.options.classes){this.$el.addClass(this.options.classes)}},render:function(){this.$el.html(i(_.pluck(this.buttons,"el")).detach());return this}});j.exports=k},{}],35:[function(i,h,f){var g=wp.media.View.extend({tagName:"button",className:"media-button",attributes:{type:"button"},events:{click:"click"},defaults:{text:"",style:"",size:"large",disabled:false},initialize:function(){this.model=new Backbone.Model(this.defaults);_.each(this.defaults,function(a,c){var b=this.options[c];if(_.isUndefined(b)){return}this.model.set(c,b);delete this.options[c]},this);this.listenTo(this.model,"change",this.render)},render:function(){var a=["button",this.className],b=this.model.toJSON();if(b.style){a.push("button-"+b.style)}if(b.size){a.push("button-"+b.size)}a=_.uniq(a.concat(this.options.classes));this.el.className=a.join(" ");this.$el.attr("disabled",b.disabled);this.$el.text(this.model.get("text"));return this},click:function(a){if("#"===this.attributes.href){a.preventDefault()}if(this.options.click&&!this.model.get("disabled")){this.options.click.apply(this,arguments)}}});h.exports=g},{}],36:[function(q,o,k){var l=wp.media.View,m=wp.media.view.UploaderStatus,p=wp.media.view.l10n,n=jQuery,j;j=l.extend({className:"crop-content",template:wp.template("crop-content"),initialize:function(){_.bindAll(this,"onImageLoad")},ready:function(){this.controller.frame.on("content:error:crop",this.onError,this);this.$image=this.$el.find(".crop-image");this.$image.on("load",this.onImageLoad);n(window).on("resize.cropper",_.debounce(this.onImageLoad,250))},remove:function(){n(window).off("resize.cropper");this.$el.remove();this.$el.off();l.prototype.remove.apply(this,arguments)},prepare:function(){return{title:p.cropYourImage,url:this.options.attachment.get("url")}},onImageLoad:function(){var a=this.controller.get("imgSelectOptions");if(typeof a==="function"){a=a(this.options.attachment,this.controller)}a=_.extend(a,{parent:this.$el});this.trigger("image-loaded");this.controller.imgSelect=this.$image.imgAreaSelect(a)},onError:function(){var a=this.options.attachment.get("filename");this.views.add(".upload-errors",new wp.media.view.UploaderStatusError({filename:m.prototype.filename(a),message:window._wpMediaViewsL10n.cropError}),{at:0})}});o.exports=j},{}],37:[function(k,j,h){var i=wp.media.View,g;g=i.extend({className:"image-editor",template:wp.template("image-editor"),initialize:function(a){this.editor=window.imageEdit;this.controller=a.controller;i.prototype.initialize.apply(this,arguments)},prepare:function(){return this.model.toJSON()},loadEditor:function(){var a=this.editor.open(this.model.get("id"),this.model.get("nonces").edit,this);a.done(_.bind(this.focus,this))},focus:function(){this.$(".imgedit-submit .button").eq(0).focus()},back:function(){var a=this.controller.lastState();this.controller.setState(a)},refresh:function(){this.model.fetch()},save:function(){var a=this.controller.lastState();this.model.fetch().done(_.bind(function(){this.controller.setState(a)},this))}});j.exports=g},{}],38:[function(f,i,g){var h=wp.media.View.extend({className:"media-embed",initialize:function(){this.url=new wp.media.view.EmbedUrl({controller:this.controller,model:this.model.props}).render();this.views.set([this.url]);this.refresh();this.listenTo(this.model,"change:type",this.refresh);this.listenTo(this.model,"change:loading",this.loading)},settings:function(a){if(this._settings){this._settings.remove()}this._settings=a;this.views.add(a)},refresh:function(){var a=this.model.get("type"),b;if("image"===a){b=wp.media.view.EmbedImage}else{if("link"===a){b=wp.media.view.EmbedLink}else{return}}this.settings(new b({controller:this.controller,model:this.model.props,priority:40}))},loading:function(){this.$el.toggleClass("embed-loading",this.model.get("loading"))}});i.exports=h},{}],39:[function(k,j,h){var i=wp.media.view.Settings.AttachmentDisplay,g;g=i.extend({className:"embed-media-settings",template:wp.template("embed-image-settings"),initialize:function(){i.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"change:url",this.updateImage)},updateImage:function(){this.$("img").attr("src",this.model.get("url"))}});j.exports=g},{}],40:[function(k,j,g){var i=jQuery,h;h=wp.media.view.Settings.extend({className:"embed-link-settings",template:wp.template("embed-link-settings"),initialize:function(){this.listenTo(this.model,"change:url",this.updateoEmbed)},updateoEmbed:_.debounce(function(){var a=this.model.get("url");this.$(".embed-container").hide().find(".embed-preview").empty();this.$(".setting").hide();if(a&&(a.length<11||!a.match(/^http(s)?:\/\//))){return}this.fetch()},wp.media.controller.Embed.sensitivity),fetch:function(){var a;if(i("#embed-url-field").val()!==this.model.get("url")){return}if(this.dfd&&"pending"===this.dfd.state()){this.dfd.abort()}a=new wp.shortcode({tag:"embed",attrs:_.pick(this.model.attributes,["width","height","src"]),content:this.model.get("url")});this.dfd=i.ajax({type:"POST",url:wp.ajax.settings.url,context:this,data:{action:"parse-embed",post_ID:wp.media.view.settings.post.id,shortcode:a.string()}}).done(this.renderoEmbed).fail(this.renderFail)},renderFail:function(a,b){if("abort"===b){return}this.$(".link-text").show()},renderoEmbed:function(b){var a=(b&&b.data&&b.data.body)||"";if(a){this.$(".embed-container").show().find(".embed-preview").html(a)}else{this.renderFail()}}});j.exports=h},{}],41:[function(h,m,i){var j=wp.media.View,k=jQuery,l;l=j.extend({tagName:"label",className:"embed-url",events:{input:"url",keyup:"url",change:"url"},initialize:function(){this.$input=k('<input id="embed-url-field" type="url" />').val(this.model.get("url"));this.input=this.$input[0];this.spinner=k('<span class="spinner" />')[0];this.$el.append([this.input,this.spinner]);this.listenTo(this.model,"change:url",this.render);if(this.model.get("url")){_.delay(_.bind(function(){this.model.trigger("change:url")},this),500)}},render:function(){var a=this.$input;if(a.is(":focus")){return}this.input.value=this.model.get("url")||"http://";j.prototype.render.apply(this,arguments);return this},ready:function(){if(!wp.media.isTouchDevice){this.focus()}},url:function(a){this.model.set("url",a.target.value)},focus:function(){var a=this.$input;if(a.is(":visible")){a.focus()[0].select()}}});m.exports=l},{}],42:[function(i,h,f){var g=wp.media.View.extend({events:{keydown:"constrainTabbing"},focus:function(){this.$(".media-menu-item").first().focus()},constrainTabbing:function(a){var b;if(9!==a.keyCode){return}b=this.$(":tabbable").not('.moxie-shim input[type="file"]');if(b.last()[0]===a.target&&!a.shiftKey){b.first().focus();return false}else{if(b.first()[0]===a.target&&a.shiftKey){b.last().focus();return false}}}});h.exports=g},{}],43:[function(f,h,g){var i=wp.media.View.extend({initialize:function(){_.defaults(this.options,{mode:["select"]});this._createRegions();this._createStates();this._createModes()},_createRegions:function(){this.regions=this.regions?this.regions.slice():[];_.each(this.regions,function(a){this[a]=new wp.media.controller.Region({view:this,id:a,selector:".media-frame-"+a})},this)},_createStates:function(){this.states=new Backbone.Collection(null,{model:wp.media.controller.State});this.states.on("add",function(a){a.frame=this;a.trigger("ready")},this);if(this.options.states){this.states.add(this.options.states)}},_createModes:function(){this.activeModes=new Backbone.Collection();this.activeModes.on("add remove reset",_.bind(this.triggerModeEvents,this));_.each(this.options.mode,function(a){this.activateMode(a)},this)},reset:function(){this.states.invoke("trigger","reset");return this},triggerModeEvents:function(c,a,d){var l,m={add:"activate",remove:"deactivate"},b;_.each(d,function(j,k){if(j){l=k}});if(!_.has(m,l)){return}b=c.get("id")+":"+m[l];this.trigger(b)},activateMode:function(a){if(this.isModeActive(a)){return}this.activeModes.add([{id:a}]);this.$el.addClass("mode-"+a);return this},deactivateMode:function(a){if(!this.isModeActive(a)){return this}this.activeModes.remove(this.activeModes.where({id:a}));this.$el.removeClass("mode-"+a);this.trigger(a+":deactivate");return this},isModeActive:function(a){return Boolean(this.activeModes.where({id:a}).length)}});_.extend(i.prototype,wp.media.controller.StateMachine.prototype);h.exports=i},{}],44:[function(h,l,i){var j=wp.media.view.MediaFrame.Select,m=wp.media.view.l10n,k;k=j.extend({defaults:{id:"image",url:"",menu:"image-details",content:"image-details",toolbar:"image-details",type:"link",title:m.imageDetailsTitle,priority:120},initialize:function(a){this.image=new wp.media.model.PostImage(a.metadata);this.options.selection=new wp.media.model.Selection(this.image.attachment,{multiple:false});j.prototype.initialize.apply(this,arguments)},bindHandlers:function(){j.prototype.bindHandlers.apply(this,arguments);this.on("menu:create:image-details",this.createMenu,this);this.on("content:create:image-details",this.imageDetailsContent,this);this.on("content:render:edit-image",this.editImageContent,this);this.on("toolbar:render:image-details",this.renderImageDetailsToolbar,this);this.on("toolbar:render:replace",this.renderReplaceImageToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.ImageDetails({image:this.image,editable:false}),new wp.media.controller.ReplaceImage({id:"replace-image",library:wp.media.query({type:"image"}),image:this.image,multiple:false,title:m.imageReplaceTitle,toolbar:"replace",priority:80,displaySettings:true}),new wp.media.controller.EditImage({image:this.image,selection:this.options.selection})])},imageDetailsContent:function(a){a.view=new wp.media.view.ImageDetails({controller:this,model:this.state().image,attachment:this.state().image.attachment})},editImageContent:function(){var a=this.state(),b=a.get("image"),c;if(!b){return}c=new wp.media.view.EditImage({model:b,controller:this}).render();this.content.set(c);c.loadEditor()},renderImageDetailsToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{select:{style:"primary",text:m.update,priority:80,click:function(){var b=this.controller,a=b.state();b.close();a.trigger("update",b.image.toJSON());b.setState(b.options.state);b.reset()}}}}))},renderReplaceImageToolbar:function(){var a=this,c=a.lastState(),b=c&&c.id;this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{back:{text:m.back,priority:20,click:function(){if(b){a.setState(b)}else{a.close()}}},replace:{style:"primary",text:m.replace,priority:80,click:function(){var g=this.controller,d=g.state(),f=d.get("selection"),o=f.single();g.close();g.image.changeAttachment(o,d.display(o));d.trigger("replace",g.image.toJSON());g.setState(g.options.state);g.reset()}}}}))}});l.exports=k},{}],45:[function(o,m,i){var k=wp.media.view.MediaFrame.Select,l=wp.media.controller.Library,n=wp.media.view.l10n,j;j=k.extend({initialize:function(){this.counts={audio:{count:wp.media.view.settings.attachmentCounts.audio,state:"playlist"},video:{count:wp.media.view.settings.attachmentCounts.video,state:"video-playlist"}};_.defaults(this.options,{multiple:true,editing:false,state:"insert",metadata:{}});k.prototype.initialize.apply(this,arguments);this.createIframeStates()},createStates:function(){var a=this.options;this.states.add([new l({id:"insert",title:n.insertMediaTitle,priority:20,toolbar:"main-insert",filterable:"all",library:wp.media.query(a.library),multiple:a.multiple?"reset":false,editable:true,allowLocalEdits:true,displaySettings:true,displayUserSettings:true}),new l({id:"gallery",title:n.createGalleryTitle,priority:40,toolbar:"main-gallery",filterable:"uploaded",multiple:"add",editable:false,library:wp.media.query(_.defaults({type:"image"},a.library))}),new wp.media.controller.Embed({metadata:a.metadata}),new wp.media.controller.EditImage({model:a.editImage}),new wp.media.controller.GalleryEdit({library:a.selection,editing:a.editing,menu:"gallery"}),new wp.media.controller.GalleryAdd(),new l({id:"playlist",title:n.createPlaylistTitle,priority:60,toolbar:"main-playlist",filterable:"uploaded",multiple:"add",editable:false,library:wp.media.query(_.defaults({type:"audio"},a.library))}),new wp.media.controller.CollectionEdit({type:"audio",collectionType:"playlist",title:n.editPlaylistTitle,SettingsView:wp.media.view.Settings.Playlist,library:a.selection,editing:a.editing,menu:"playlist",dragInfoText:n.playlistDragInfo,dragInfo:false}),new wp.media.controller.CollectionAdd({type:"audio",collectionType:"playlist",title:n.addToPlaylistTitle}),new l({id:"video-playlist",title:n.createVideoPlaylistTitle,priority:60,toolbar:"main-video-playlist",filterable:"uploaded",multiple:"add",editable:false,library:wp.media.query(_.defaults({type:"video"},a.library))}),new wp.media.controller.CollectionEdit({type:"video",collectionType:"playlist",title:n.editVideoPlaylistTitle,SettingsView:wp.media.view.Settings.Playlist,library:a.selection,editing:a.editing,menu:"video-playlist",dragInfoText:n.videoPlaylistDragInfo,dragInfo:false}),new wp.media.controller.CollectionAdd({type:"video",collectionType:"playlist",title:n.addToVideoPlaylistTitle})]);if(wp.media.view.settings.post.featuredImageId){this.states.add(new wp.media.controller.FeaturedImage())}},bindHandlers:function(){var b,a;k.prototype.bindHandlers.apply(this,arguments);this.on("activate",this.activate,this);a=_.find(this.counts,function(c){return c.count===0});if(typeof a!=="undefined"){this.listenTo(wp.media.model.Attachments.all,"change:type",this.mediaTypeCounts)}this.on("menu:create:gallery",this.createMenu,this);this.on("menu:create:playlist",this.createMenu,this);this.on("menu:create:video-playlist",this.createMenu,this);this.on("toolbar:create:main-insert",this.createToolbar,this);this.on("toolbar:create:main-gallery",this.createToolbar,this);this.on("toolbar:create:main-playlist",this.createToolbar,this);this.on("toolbar:create:main-video-playlist",this.createToolbar,this);this.on("toolbar:create:featured-image",this.featuredImageToolbar,this);this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this);b={menu:{"default":"mainMenu",gallery:"galleryMenu",playlist:"playlistMenu","video-playlist":"videoPlaylistMenu"},content:{embed:"embedContent","edit-image":"editImageContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar","main-gallery":"mainGalleryToolbar","gallery-edit":"galleryEditToolbar","gallery-add":"galleryAddToolbar","main-playlist":"mainPlaylistToolbar","playlist-edit":"playlistEditToolbar","playlist-add":"playlistAddToolbar","main-video-playlist":"mainVideoPlaylistToolbar","video-playlist-edit":"videoPlaylistEditToolbar","video-playlist-add":"videoPlaylistAddToolbar"}};_.each(b,function(c,d){_.each(c,function(g,f){this.on(d+":render:"+f,this[g],this)},this)},this)},activate:function(){_.each(this.counts,function(a){if(a.count<1){this.menuItemVisibility(a.state,"hide")}},this)},mediaTypeCounts:function(a,b){if(typeof this.counts[b]!=="undefined"&&this.counts[b].count<1){this.counts[b].count++;this.menuItemVisibility(this.counts[b].state,"show")}},mainMenu:function(a){a.set({"library-separator":new wp.media.View({className:"separator",priority:100})})},menuItemVisibility:function(b,c){var a=this.menu.get();if(c==="hide"){a.hide(b)}else{if(c==="show"){a.show(b)}}},galleryMenu:function(d){var c=this.lastState(),b=c&&c.id,a=this;d.set({cancel:{text:n.cancelGalleryTitle,priority:20,click:function(){if(b){a.setState(b)}else{a.close()}this.controller.modal.focusManager.focus()}},separateCancel:new wp.media.View({className:"separator",priority:40})})},playlistMenu:function(d){var c=this.lastState(),b=c&&c.id,a=this;d.set({cancel:{text:n.cancelPlaylistTitle,priority:20,click:function(){if(b){a.setState(b)}else{a.close()}}},separateCancel:new wp.media.View({className:"separator",priority:40})})},videoPlaylistMenu:function(d){var c=this.lastState(),b=c&&c.id,a=this;d.set({cancel:{text:n.cancelVideoPlaylistTitle,priority:20,click:function(){if(b){a.setState(b)}else{a.close()}}},separateCancel:new wp.media.View({className:"separator",priority:40})})},embedContent:function(){var a=new wp.media.view.Embed({controller:this,model:this.state()}).render();this.content.set(a);if(!wp.media.isTouchDevice){a.url.focus()}},editSelectionContent:function(){var a=this.state(),b=a.get("selection"),c;c=new wp.media.view.AttachmentsBrowser({controller:this,collection:b,selection:b,model:a,sortable:true,search:false,date:false,dragInfo:true,AttachmentView:wp.media.view.Attachments.EditSelection}).render();c.toolbar.set("backToLibrary",{text:n.returnToLibrary,priority:-100,click:function(){this.controller.content.mode("browse")}});this.content.set(c);this.trigger("edit:selection",this)},editImageContent:function(){var a=this.state().get("image"),b=new wp.media.view.EditImage({model:a,controller:this}).render();this.content.set(b);b.loadEditor()},selectionStatusToolbar:function(b){var a=this.state().get("editable");b.set("selection",new wp.media.view.Selection({controller:this,collection:this.state().get("selection"),priority:-40,editable:a&&function(){this.controller.content.mode("edit-selection")}}).render())},mainInsertToolbar:function(a){var b=this;this.selectionStatusToolbar(a);a.set("insert",{style:"primary",priority:80,text:n.insertIntoPost,requires:{selection:true},click:function(){var c=b.state(),d=c.get("selection");b.close();c.trigger("insert",d).reset()}})},mainGalleryToolbar:function(a){var b=this;this.selectionStatusToolbar(a);a.set("gallery",{style:"primary",text:n.createNewGallery,priority:60,requires:{selection:true},click:function(){var f=b.state().get("selection"),d=b.state("gallery-edit"),c=f.where({type:"image"});d.set("library",new wp.media.model.Selection(c,{props:f.props.toJSON(),multiple:true}));this.controller.setState("gallery-edit");this.controller.modal.focusManager.focus()}})},mainPlaylistToolbar:function(a){var b=this;this.selectionStatusToolbar(a);a.set("playlist",{style:"primary",text:n.createNewPlaylist,priority:100,requires:{selection:true},click:function(){var f=b.state().get("selection"),d=b.state("playlist-edit"),c=f.where({type:"audio"});d.set("library",new wp.media.model.Selection(c,{props:f.props.toJSON(),multiple:true}));this.controller.setState("playlist-edit");this.controller.modal.focusManager.focus()}})},mainVideoPlaylistToolbar:function(a){var b=this;this.selectionStatusToolbar(a);a.set("video-playlist",{style:"primary",text:n.createNewVideoPlaylist,priority:100,requires:{selection:true},click:function(){var f=b.state().get("selection"),d=b.state("video-playlist-edit"),c=f.where({type:"video"});d.set("library",new wp.media.model.Selection(c,{props:f.props.toJSON(),multiple:true}));this.controller.setState("video-playlist-edit");this.controller.modal.focusManager.focus()}})},featuredImageToolbar:function(a){this.createSelectToolbar(a,{text:n.setFeaturedImage,state:this.options.state})},mainEmbedToolbar:function(a){a.view=new wp.media.view.Toolbar.Embed({controller:this})},galleryEditToolbar:function(){var a=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:a?n.updateGallery:n.insertGallery,priority:80,requires:{library:true},click:function(){var c=this.controller,b=c.state();c.close();b.trigger("update",b.get("library"));c.setState(c.options.state);c.reset()}}}}))},galleryAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:n.addToGallery,priority:80,requires:{selection:true},click:function(){var c=this.controller,a=c.state(),b=c.state("gallery-edit");b.get("library").add(a.get("selection").models);a.trigger("reset");c.setState("gallery-edit")}}}}))},playlistEditToolbar:function(){var a=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:a?n.updatePlaylist:n.insertPlaylist,priority:80,requires:{library:true},click:function(){var c=this.controller,b=c.state();c.close();b.trigger("update",b.get("library"));c.setState(c.options.state);c.reset()}}}}))},playlistAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:n.addToPlaylist,priority:80,requires:{selection:true},click:function(){var c=this.controller,a=c.state(),b=c.state("playlist-edit");b.get("library").add(a.get("selection").models);a.trigger("reset");c.setState("playlist-edit")}}}}))},videoPlaylistEditToolbar:function(){var a=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:a?n.updateVideoPlaylist:n.insertVideoPlaylist,priority:140,requires:{library:true},click:function(){var d=this.controller,b=d.state(),c=b.get("library");c.type="video";d.close();b.trigger("update",c);d.setState(d.options.state);d.reset()}}}}))},videoPlaylistAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:n.addToVideoPlaylist,priority:140,requires:{selection:true},click:function(){var c=this.controller,a=c.state(),b=c.state("video-playlist-edit");b.get("library").add(a.get("selection").models);a.trigger("reset");c.setState("video-playlist-edit")}}}}))}});m.exports=j},{}],46:[function(h,l,i){var k=wp.media.view.MediaFrame,m=wp.media.view.l10n,j;j=k.extend({initialize:function(){k.prototype.initialize.apply(this,arguments);_.defaults(this.options,{selection:[],library:{},multiple:false,state:"library"});this.createSelection();this.createStates();this.bindHandlers()},createSelection:function(){var a=this.options.selection;if(!(a instanceof wp.media.model.Selection)){this.options.selection=new wp.media.model.Selection(a,{multiple:this.options.multiple})}this._selection={attachments:new wp.media.model.Attachments(),difference:[]}},createStates:function(){var a=this.options;if(this.options.states){return}this.states.add([new wp.media.controller.Library({library:wp.media.query(a.library),multiple:a.multiple,title:a.title,priority:20})])},bindHandlers:function(){this.on("router:create:browse",this.createRouter,this);this.on("router:render:browse",this.browseRouter,this);this.on("content:create:browse",this.browseContent,this);this.on("content:render:upload",this.uploadContent,this);this.on("toolbar:create:select",this.createSelectToolbar,this)},browseRouter:function(a){a.set({upload:{text:m.uploadFilesTitle,priority:20},browse:{text:m.mediaLibraryTitle,priority:40}})},browseContent:function(b){var a=this.state();this.$el.removeClass("hide-toolbar");b.view=new wp.media.view.AttachmentsBrowser({controller:this,collection:a.get("library"),selection:a.get("selection"),model:a,sortable:a.get("sortable"),search:a.get("searchable"),filters:a.get("filterable"),date:a.get("date"),display:a.has("display")?a.get("display"):a.get("displaySettings"),dragInfo:a.get("dragInfo"),idealColumnWidth:a.get("idealColumnWidth"),suggestedWidth:a.get("suggestedWidth"),suggestedHeight:a.get("suggestedHeight"),AttachmentView:a.get("AttachmentView")})},uploadContent:function(){this.$el.removeClass("hide-toolbar");this.content.set(new wp.media.view.UploaderInline({controller:this}))},createSelectToolbar:function(a,b){b=b||this.options.button||{};b.controller=this;a.view=new wp.media.view.Toolbar.Select(b)}});l.exports=j},{}],47:[function(f,h,g){var i=wp.media.View.extend({className:"media-iframe",render:function(){this.views.detach();this.$el.html('<iframe src="'+this.controller.state().get("src")+'" />');this.views.render();return this}});h.exports=i},{}],48:[function(h,m,i){var k=wp.media.view.Settings.AttachmentDisplay,l=jQuery,j;j=k.extend({className:"image-details",template:wp.template("image-details"),events:_.defaults(k.prototype.events,{"click .edit-attachment":"editAttachment","click .replace-attachment":"replaceAttachment","click .advanced-toggle":"onToggleAdvanced",'change [data-setting="customWidth"]':"onCustomSize",'change [data-setting="customHeight"]':"onCustomSize",'keyup [data-setting="customWidth"]':"onCustomSize",'keyup [data-setting="customHeight"]':"onCustomSize"}),initialize:function(){this.options.attachment=this.model.attachment;this.listenTo(this.model,"change:url",this.updateUrl);this.listenTo(this.model,"change:link",this.toggleLinkSettings);this.listenTo(this.model,"change:size",this.toggleCustomSize);k.prototype.initialize.apply(this,arguments)},prepare:function(){var a=false;if(this.model.attachment){a=this.model.attachment.toJSON()}return _.defaults({model:this.model.toJSON(),attachment:a},this.options)},render:function(){var a=arguments;if(this.model.attachment&&"pending"===this.model.dfd.state()){this.model.dfd.done(_.bind(function(){k.prototype.render.apply(this,a);this.postRender()},this)).fail(_.bind(function(){this.model.attachment=false;k.prototype.render.apply(this,a);this.postRender()},this))}else{k.prototype.render.apply(this,arguments);this.postRender()}return this},postRender:function(){setTimeout(_.bind(this.resetFocus,this),10);this.toggleLinkSettings();if(window.getUserSetting("advImgDetails")==="show"){this.toggleAdvanced(true)}this.trigger("post-render")},resetFocus:function(){this.$(".link-to-custom").blur();this.$(".embed-media-settings").scrollTop(0)},updateUrl:function(){this.$(".image img").attr("src",this.model.get("url"));this.$(".url").val(this.model.get("url"))},toggleLinkSettings:function(){if(this.model.get("link")==="none"){this.$(".link-settings").addClass("hidden")}else{this.$(".link-settings").removeClass("hidden")}},toggleCustomSize:function(){if(this.model.get("size")!=="custom"){this.$(".custom-size").addClass("hidden")}else{this.$(".custom-size").removeClass("hidden")}},onCustomSize:function(c){var a=l(c.target).data("setting"),d=l(c.target).val(),b;if(!/^\d+/.test(d)||parseInt(d,10)<1){c.preventDefault();return}if(a==="customWidth"){b=Math.round(1/this.model.get("aspectRatio")*d);this.model.set("customHeight",b,{silent:true});this.$('[data-setting="customHeight"]').val(b)}else{b=Math.round(this.model.get("aspectRatio")*d);this.model.set("customWidth",b,{silent:true});this.$('[data-setting="customWidth"]').val(b)}},onToggleAdvanced:function(a){a.preventDefault();this.toggleAdvanced()},toggleAdvanced:function(c){var b=this.$el.find(".advanced-section"),a;if(b.hasClass("advanced-visible")||c===false){b.removeClass("advanced-visible");b.find(".advanced-settings").addClass("hidden");a="hide"}else{b.addClass("advanced-visible");b.find(".advanced-settings").removeClass("hidden");a="show"}window.setUserSetting("advImgDetails",a)},editAttachment:function(a){var b=this.controller.states.get("edit-image");if(window.imageEdit&&b){a.preventDefault();b.set("image",this.model.attachment);this.controller.setState("edit-image")}},replaceAttachment:function(a){a.preventDefault();this.controller.setState("replace-image")}});m.exports=j},{}],49:[function(f,i,g){var h=wp.media.View.extend({tagName:"label",className:"screen-reader-text",initialize:function(){this.value=this.options.value},render:function(){this.$el.html(this.value);return this}});i.exports=h},{}],50:[function(h,l,i){var m=wp.media.view.Frame,j=jQuery,k;k=m.extend({className:"media-frame",template:wp.template("media-frame"),regions:["menu","title","content","toolbar","router"],events:{"click div.media-frame-title h1":"toggleMenu"},initialize:function(){m.prototype.initialize.apply(this,arguments);_.defaults(this.options,{title:"",modal:true,uploader:true});this.$el.addClass("wp-core-ui");if(this.options.modal){this.modal=new wp.media.view.Modal({controller:this,title:this.options.title});this.modal.content(this)}if(wp.Uploader.limitExceeded||!wp.Uploader.browser.supported){this.options.uploader=false}if(this.options.uploader){this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.modal?this.modal.$el:this.$el,container:this.$el}});this.views.set(".media-frame-uploader",this.uploader)}this.on("attach",_.bind(this.views.ready,this.views),this);this.on("title:create:default",this.createTitle,this);this.title.mode("default");this.on("title:render",function(a){a.$el.append('<span class="dashicons dashicons-arrow-down"></span>')});this.on("menu:create:default",this.createMenu,this)},render:function(){if(!this.state()&&this.options.state){this.setState(this.options.state)}return m.prototype.render.apply(this,arguments)},createTitle:function(a){a.view=new wp.media.View({controller:this,tagName:"h1"})},createMenu:function(a){a.view=new wp.media.view.Menu({controller:this})},toggleMenu:function(){this.$el.find(".media-menu").toggleClass("visible")},createToolbar:function(a){a.view=new wp.media.view.Toolbar({controller:this})},createRouter:function(a){a.view=new wp.media.view.Router({controller:this})},createIframeStates:function(f){var b=wp.media.view.settings,c=b.tabs,a=b.tabUrl,d;if(!c||!a){return}d=j("#post_ID");if(d.length){a+="&post_id="+d.val()}_.each(c,function(g,o){this.state("iframe:"+o).set(_.defaults({tab:o,src:a+"&tab="+o,title:g,content:"iframe",menu:"default"},f))},this);this.on("content:create:iframe",this.iframeContent,this);this.on("content:deactivate:iframe",this.iframeContentCleanup,this);this.on("menu:render:default",this.iframeMenu,this);this.on("open",this.hijackThickbox,this);this.on("close",this.restoreThickbox,this)},iframeContent:function(a){this.$el.addClass("hide-toolbar");a.view=new wp.media.view.Iframe({controller:this})},iframeContentCleanup:function(){this.$el.removeClass("hide-toolbar")},iframeMenu:function(a){var b={};if(!a){return}_.each(wp.media.view.settings.tabs,function(d,c){b["iframe:"+c]={text:this.state("iframe:"+c).get("title"),priority:200}},this);a.set(b)},hijackThickbox:function(){var a=this;if(!window.tb_remove||this._tb_remove){return}this._tb_remove=window.tb_remove;window.tb_remove=function(){a.close();a.reset();a.setState(a.options.state);a._tb_remove.call(window)}},restoreThickbox:function(){if(!this._tb_remove){return}window.tb_remove=this._tb_remove;delete this._tb_remove}});_.each(["open","close","attach","detach","escape"],function(a){k.prototype[a]=function(){if(this.modal){this.modal[a].apply(this.modal,arguments)}return this}});l.exports=k},{}],51:[function(g,k,h){var i=jQuery,j;j=wp.media.View.extend({tagName:"a",className:"media-menu-item",attributes:{href:"#"},events:{click:"_click"},_click:function(b){var a=this.options.click;if(b){b.preventDefault()}if(a){a.call(this)}else{this.click()}if(!wp.media.isTouchDevice){i(".media-frame-content input").first().focus()}},click:function(){var a=this.options.state;if(a){this.controller.setState(a);this.views.parent.$el.removeClass("visible")}},render:function(){var a=this.options;if(a.text){this.$el.text(a.text)}else{if(a.html){this.$el.html(a.html)}}return this}});k.exports=j},{}],52:[function(h,l,i){var j=wp.media.view.MenuItem,m=wp.media.view.PriorityList,k;k=m.extend({tagName:"div",className:"media-menu",property:"state",ItemView:j,region:"menu",toView:function(b,a){b=b||{};b[this.property]=b[this.property]||a;return new this.ItemView(b).render()},ready:function(){m.prototype.ready.apply(this,arguments);this.visibility()},set:function(){m.prototype.set.apply(this,arguments);this.visibility()},unset:function(){m.prototype.unset.apply(this,arguments);this.visibility()},visibility:function(){var a=this.region,c=this.controller[a].get(),d=this.views.get(),b=!d||d.length<2;if(this===c){this.controller.$el.toggleClass("hide-"+a,b)}},select:function(a){var b=this.get(a);if(!b){return}this.deselect();b.$el.addClass("active")},deselect:function(){this.$el.children().removeClass("active")},hide:function(a){var b=this.get(a);if(!b){return}b.$el.addClass("hidden")},show:function(a){var b=this.get(a);if(!b){return}b.$el.removeClass("hidden")}});l.exports=k},{}],53:[function(k,j,g){var i=jQuery,h;h=wp.media.View.extend({tagName:"div",template:wp.template("media-modal"),attributes:{tabindex:0},events:{"click .media-modal-backdrop, .media-modal-close":"escapeHandler",keydown:"keydown"},clickedOpenerEl:null,initialize:function(){_.defaults(this.options,{container:document.body,title:"",propagate:true,freeze:true});this.focusManager=new wp.media.view.FocusManager({el:this.el})},prepare:function(){return{title:this.options.title}},attach:function(){if(this.views.attached){return this}if(!this.views.rendered){this.render()}this.$el.appendTo(this.options.container);this.views.attached=true;this.views.ready();return this.propagate("attach")},detach:function(){if(this.$el.is(":visible")){this.close()}this.$el.detach();this.views.attached=false;return this.propagate("detach")},open:function(){var a=this.$el,b=this.options,c;if(a.is(":visible")){return this}this.clickedOpenerEl=document.activeElement;if(!this.views.attached){this.attach()}if(b.freeze){this._freeze={scrollTop:i(window).scrollTop()}}i("body").addClass("modal-open");a.show();if("ontouchend" in document){if((c=window.tinymce&&window.tinymce.activeEditor)&&!c.isHidden()&&c.iframeElement){c.iframeElement.focus();c.iframeElement.blur();setTimeout(function(){c.iframeElement.blur()},100)}}this.$el.focus();return this.propagate("open")},close:function(b){var a=this._freeze;if(!this.views.attached||!this.$el.is(":visible")){return this}i("body").removeClass("modal-open");this.$el.hide().undelegate("keydown");if(null!==this.clickedOpenerEl){this.clickedOpenerEl.focus()}else{i("#wpbody-content").focus()}this.propagate("close");if(a){i(window).scrollTop(a.scrollTop)}if(b&&b.escape){this.propagate("escape")}return this},escape:function(){return this.close({escape:true})},escapeHandler:function(a){a.preventDefault();this.escape()},content:function(a){this.views.set(".media-modal-content",a);return this},propagate:function(a){this.trigger(a);if(this.options.propagate){this.controller.trigger(a)}return this},keydown:function(a){if(27===a.which&&this.$el.is(":visible")){this.escape();a.stopImmediatePropagation()}}});j.exports=h},{}],54:[function(f,h,g){var i=wp.media.View.extend({tagName:"div",initialize:function(){this._views={};this.set(_.extend({},this._views,this.options.views),{silent:true});delete this.options.views;if(!this.options.silent){this.render()}},set:function(a,l,c){var b,m,d;c=c||{};if(_.isObject(a)){_.each(a,function(k,j){this.set(j,k)},this);return this}if(!(l instanceof Backbone.View)){l=this.toView(l,a,c)}l.controller=l.controller||this.controller;this.unset(a);b=l.options.priority||10;m=this.views.get()||[];_.find(m,function(j,k){if(j.options.priority>b){d=k;return true}});this._views[a]=l;this.views.add(l,{at:_.isNumber(d)?d:m.length||0});return this},get:function(a){return this._views[a]},unset:function(a){var b=this.get(a);if(b){b.remove()}delete this._views[a];return this},toView:function(a){return new wp.media.View(a)}});h.exports=i},{}],55:[function(f,i,g){var h=wp.media.view.MenuItem.extend({click:function(){var a=this.options.contentMode;if(a){this.controller.content.mode(a)}}});i.exports=h},{}],56:[function(k,j,g){var i=wp.media.view.Menu,h;h=i.extend({tagName:"div",className:"media-router",property:"contentMode",ItemView:wp.media.view.RouterItem,region:"router",initialize:function(){this.controller.on("content:render",this.update,this);i.prototype.initialize.apply(this,arguments)},update:function(){var a=this.controller.content.mode();if(a){this.select(a)}}});j.exports=h},{}],57:[function(k,i,h){var j=wp.media.view.l10n,g;g=wp.media.View.extend({tagName:"input",className:"search",id:"media-search-input",attributes:{type:"search",placeholder:j.searchMediaPlaceholder},events:{input:"search",keyup:"search",change:"search",search:"search"},render:function(){this.el.value=this.model.escape("search");return this},search:function(a){if(a.target.value){this.model.set("search",a.target.value)}else{this.model.unset("search")}}});i.exports=g},{}],58:[function(g,j,h){var k=wp.media.view.l10n,i;i=wp.media.View.extend({tagName:"div",className:"media-selection",template:wp.template("media-selection"),events:{"click .edit-selection":"edit","click .clear-selection":"clear"},initialize:function(){_.defaults(this.options,{editable:false,clearable:true});this.attachments=new wp.media.view.Attachments.Selection({controller:this.controller,collection:this.collection,selection:this.collection,model:new Backbone.Model()});this.views.set(".selection-view",this.attachments);this.collection.on("add remove reset",this.refresh,this);this.controller.on("content:activate",this.refresh,this)},ready:function(){this.refresh()},refresh:function(){if(!this.$el.children().length){return}var a=this.collection,b="edit-selection"===this.controller.content.mode();this.$el.toggleClass("empty",!a.length);this.$el.toggleClass("one",1===a.length);this.$el.toggleClass("editing",b);this.$(".count").text(k.selected.replace("%d",a.length))},edit:function(a){a.preventDefault();if(this.options.editable){this.options.editable.call(this,this.collection)}},clear:function(a){a.preventDefault();this.collection.reset();this.controller.modal.focusManager.focus()}});j.exports=i},{}],59:[function(h,m,i){var j=wp.media.View,k=Backbone.$,l;l=j.extend({events:{"click button":"updateHandler","change input":"updateHandler","change select":"updateHandler","change textarea":"updateHandler"},initialize:function(){this.model=this.model||new Backbone.Model();this.listenTo(this.model,"change",this.updateChanges)},prepare:function(){return _.defaults({model:this.model.toJSON()},this.options)},render:function(){j.prototype.render.apply(this,arguments);_(this.model.attributes).chain().keys().each(this.update,this);return this},update:function(b){var a=this.model.get(b),c=this.$('[data-setting="'+b+'"]'),f,d;if(!c.length){return}if(c.is("select")){d=c.find('[value="'+a+'"]');if(d.length){c.find("option").prop("selected",false);d.prop("selected",true)}else{this.model.set(b,c.find(":selected").val())}}else{if(c.hasClass("button-group")){f=c.find("button").removeClass("active");f.filter('[value="'+a+'"]').addClass("active")}else{if(c.is('input[type="text"], textarea')){if(!c.is(":focus")){c.val(a)}}else{if(c.is('input[type="checkbox"]')){c.prop("checked",!!a&&"false"!==a)}}}}},updateHandler:function(b){var c=k(b.target).closest("[data-setting]"),a=b.target.value,d;b.preventDefault();if(!c.length){return}if(c.is('input[type="checkbox"]')){a=c[0].checked}this.model.set(c.data("setting"),a);if(d=c.data("userSetting")){window.setUserSetting(d,a)}},updateChanges:function(a){if(a.hasChanged()){_(a.changed).chain().keys().each(this.update,this)}}});m.exports=l},{}],60:[function(g,k,h){var j=wp.media.view.Settings,i;i=j.extend({className:"attachment-display-settings",template:wp.template("attachment-display-settings"),initialize:function(){var a=this.options.attachment;_.defaults(this.options,{userSettings:false});j.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"change:link",this.updateLinkTo);if(a){a.on("change:uploading",this.render,this)}},dispose:function(){var a=this.options.attachment;if(a){a.off(null,null,this)}j.prototype.dispose.apply(this,arguments)},render:function(){var a=this.options.attachment;if(a){_.extend(this.options,{sizes:a.get("sizes"),type:a.get("type")})}j.prototype.render.call(this);this.updateLinkTo();return this},updateLinkTo:function(){var b=this.model.get("link"),a=this.$(".link-to-custom"),c=this.options.attachment;if("none"===b||"embed"===b||(!c&&"custom"!==b)){a.addClass("hidden");return}if(c){if("post"===b){a.val(c.get("link"))}else{if("file"===b){a.val(c.get("url"))}else{if(!this.model.get("linkUrl")){a.val("http://")}}}a.prop("readonly","custom"!==b)}a.removeClass("hidden");if(!wp.media.isTouchDevice&&a.is(":visible")){a.focus()[0].select()}}});k.exports=i},{}],61:[function(f,i,g){var h=wp.media.view.Settings.extend({className:"collection-settings gallery-settings",template:wp.template("gallery-settings")});i.exports=h},{}],62:[function(f,i,g){var h=wp.media.view.Settings.extend({className:"collection-settings playlist-settings",template:wp.template("playlist-settings")});i.exports=h},{}],63:[function(f,i,g){var h=wp.media.view.PriorityList.extend({className:"media-sidebar"});i.exports=h},{}],64:[function(k,j,g){var i=wp.media.view,h;h=i.Cropper.extend({className:"crop-content site-icon",ready:function(){i.Cropper.prototype.ready.apply(this,arguments);this.$(".crop-image").on("load",_.bind(this.addSidebar,this))},addSidebar:function(){this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.sidebar.set("preview",new wp.media.view.SiteIconPreview({controller:this.controller,attachment:this.options.attachment}));this.controller.cropperView.views.add(this.sidebar)}});j.exports=h},{}],65:[function(h,m,i){var j=wp.media.View,k=jQuery,l;l=j.extend({className:"site-icon-preview",template:wp.template("site-icon-preview"),ready:function(){this.controller.imgSelect.setOptions({onInit:this.updatePreview,onSelectChange:this.updatePreview})},prepare:function(){return{url:this.options.attachment.get("url")}},updatePreview:function(g,b){var a=64/b.width,c=64/b.height,d=16/b.width,f=16/b.height;k("#preview-app-icon").css({width:Math.round(a*this.imageWidth)+"px",height:Math.round(c*this.imageHeight)+"px",marginLeft:"-"+Math.round(a*b.x1)+"px",marginTop:"-"+Math.round(c*b.y1)+"px"});k("#preview-favicon").css({width:Math.round(d*this.imageWidth)+"px",height:Math.round(f*this.imageHeight)+"px",marginLeft:"-"+Math.round(d*b.x1)+"px",marginTop:"-"+Math.floor(f*b.y1)+"px"})}});m.exports=l},{}],66:[function(f,i,g){var h=wp.media.View.extend({tagName:"span",className:"spinner",spinnerTimeout:false,delay:400,show:function(){if(!this.spinnerTimeout){this.spinnerTimeout=_.delay(function(a){a.addClass("is-active")},this.delay,this.$el)}return this},hide:function(){this.$el.removeClass("is-active");this.spinnerTimeout=clearTimeout(this.spinnerTimeout);return this}});i.exports=h},{}],67:[function(g,j,h){var i=wp.media.View,k;k=i.extend({tagName:"div",className:"media-toolbar",initialize:function(){var a=this.controller.state(),b=this.selection=a.get("selection"),c=this.library=a.get("library");this._views={};this.primary=new wp.media.view.PriorityList();this.secondary=new wp.media.view.PriorityList();this.primary.$el.addClass("media-toolbar-primary search-form");this.secondary.$el.addClass("media-toolbar-secondary");this.views.set([this.secondary,this.primary]);if(this.options.items){this.set(this.options.items,{silent:true})}if(!this.options.silent){this.render()}if(b){b.on("add remove reset",this.refresh,this)}if(c){c.on("add remove reset",this.refresh,this)}},dispose:function(){if(this.selection){this.selection.off(null,null,this)}if(this.library){this.library.off(null,null,this)}return i.prototype.dispose.apply(this,arguments)},ready:function(){this.refresh()},set:function(a,d,c){var b;c=c||{};if(_.isObject(a)){_.each(a,function(m,f){this.set(f,m,{silent:true})},this)}else{if(!(d instanceof Backbone.View)){d.classes=["media-button-"+a].concat(d.classes||[]);d=new wp.media.view.Button(d).render()}d.controller=d.controller||this.controller;this._views[a]=d;b=d.options.priority<0?"secondary":"primary";this[b].set(a,d,c)}if(!c.silent){this.refresh()}return this},get:function(a){return this._views[a]},unset:function(a,b){delete this._views[a];this.primary.unset(a,b);this.secondary.unset(a,b);if(!b||!b.silent){this.refresh()}return this},refresh:function(){var a=this.controller.state(),c=a.get("library"),b=a.get("selection");_.each(this._views,function(m){if(!m.model||!m.options||!m.options.requires){return}var d=m.options.requires,f=false;f=_.some(b.models,function(l){return l.get("uploading")===true});if(d.selection&&b&&!b.length){f=true}else{if(d.library&&c&&!c.length){f=true}}m.model.set("disabled",f)})}});j.exports=k},{}],68:[function(h,l,i){var j=wp.media.view.Toolbar.Select,m=wp.media.view.l10n,k;k=j.extend({initialize:function(){_.defaults(this.options,{text:m.insertIntoPost,requires:false});j.prototype.initialize.apply(this,arguments)},refresh:function(){var a=this.controller.state().props.get("url");this.get("select").model.set("disabled",!a||a==="http://");j.prototype.refresh.apply(this,arguments)}});l.exports=k},{}],69:[function(h,k,i){var l=wp.media.view.Toolbar,m=wp.media.view.l10n,j;j=l.extend({initialize:function(){var a=this.options;_.bindAll(this,"clickSelect");_.defaults(a,{event:"select",state:false,reset:true,close:true,text:m.select,requires:{selection:true}});a.items=_.defaults(a.items||{},{select:{style:"primary",text:a.text,priority:80,click:this.clickSelect,requires:a.requires}});l.prototype.initialize.apply(this,arguments)},clickSelect:function(){var a=this.options,b=this.controller;if(a.close){b.close()}if(a.event){b.state().trigger(a.event)}if(a.state){b.setState(a.state)}if(a.reset){b.reset()}}});k.exports=j},{}],70:[function(i,n,j){var k=wp.media.View,o=wp.media.view.l10n,l=jQuery,m;m=k.extend({tagName:"div",className:"uploader-editor",template:wp.template("uploader-editor"),localDrag:false,overContainer:false,overDropzone:false,draggingFile:null,initialize:function(){this.initialized=false;if(!window.tinyMCEPreInit||!window.tinyMCEPreInit.dragDropUpload||!this.browserSupport()){return this}this.$document=l(document);this.dropzones=[];this.files=[];this.$document.on("drop",".uploader-editor",_.bind(this.drop,this));this.$document.on("dragover",".uploader-editor",_.bind(this.dropzoneDragover,this));this.$document.on("dragleave",".uploader-editor",_.bind(this.dropzoneDragleave,this));this.$document.on("click",".uploader-editor",_.bind(this.click,this));this.$document.on("dragover",_.bind(this.containerDragover,this));this.$document.on("dragleave",_.bind(this.containerDragleave,this));this.$document.on("dragstart dragend drop",_.bind(function(a){this.localDrag=a.type==="dragstart";if(a.type==="drop"){this.containerDragleave()}},this));this.initialized=true;return this},browserSupport:function(){var b=false,a=document.createElement("div");b=("draggable" in a)||("ondragstart" in a&&"ondrop" in a);b=b&&!!(window.File&&window.FileList&&window.FileReader);return b},isDraggingFile:function(a){if(this.draggingFile!==null){return this.draggingFile}if(_.isUndefined(a.originalEvent)||_.isUndefined(a.originalEvent.dataTransfer)){return false}this.draggingFile=_.indexOf(a.originalEvent.dataTransfer.types,"Files")>-1&&_.indexOf(a.originalEvent.dataTransfer.types,"text/plain")===-1;return this.draggingFile},refresh:function(a){var b;for(b in this.dropzones){this.dropzones[b].toggle(this.overContainer||this.overDropzone)}if(!_.isUndefined(a)){l(a.target).closest(".uploader-editor").toggleClass("droppable",this.overDropzone)}if(!this.overContainer&&!this.overDropzone){this.draggingFile=null}return this},render:function(){if(!this.initialized){return this}k.prototype.render.apply(this,arguments);l(".wp-editor-wrap").each(_.bind(this.attach,this));return this},attach:function(b,a){var c=this.$el.clone();this.dropzones.push(c);l(a).append(c);return this},drop:function(a){var c,b;this.containerDragleave(a);this.dropzoneDragleave(a);this.files=a.originalEvent.dataTransfer.files;if(this.files.length<1){return}c=l(a.target).parents(".wp-editor-wrap");if(c.length>0&&c[0].id){window.wpActiveEditor=c[0].id.slice(3,-5)}if(!this.workflow){this.workflow=wp.media.editor.open(window.wpActiveEditor,{frame:"post",state:"insert",title:o.addMedia,multiple:true});b=this.workflow.uploader;if(b.uploader&&b.uploader.ready){this.addFiles.apply(this)}else{this.workflow.on("uploader:ready",this.addFiles,this)}}else{this.workflow.state().reset();this.addFiles.apply(this);this.workflow.open()}return false},addFiles:function(){if(this.files.length){this.workflow.uploader.uploader.uploader.addFile(_.toArray(this.files));this.files=[]}return this},containerDragover:function(a){if(this.localDrag||!this.isDraggingFile(a)){return}this.overContainer=true;this.refresh()},containerDragleave:function(){this.overContainer=false;_.delay(_.bind(this.refresh,this),50)},dropzoneDragover:function(a){if(this.localDrag||!this.isDraggingFile(a)){return}this.overDropzone=true;this.refresh(a);return false},dropzoneDragleave:function(a){this.overDropzone=false;_.delay(_.bind(this.refresh,this,a),50)},click:function(a){this.containerDragleave(a);this.dropzoneDragleave(a);this.localDrag=false}});n.exports=m},{}],71:[function(k,j,h){var i=wp.media.View,g;g=i.extend({tagName:"div",className:"uploader-inline",template:wp.template("uploader-inline"),events:{"click .close":"hide"},initialize:function(){_.defaults(this.options,{message:"",status:true,canClose:false});if(!this.options.$browser&&this.controller.uploader){this.options.$browser=this.controller.uploader.$browser}if(_.isUndefined(this.options.postId)){this.options.postId=wp.media.view.settings.post.id}if(this.options.status){this.views.set(".upload-inline-status",new wp.media.view.UploaderStatus({controller:this.controller}))}},prepare:function(){var a=this.controller.state().get("suggestedWidth"),b=this.controller.state().get("suggestedHeight"),c={};c.message=this.options.message;c.canClose=this.options.canClose;if(a&&b){c.suggestedWidth=a;c.suggestedHeight=b}return c},dispose:function(){if(this.disposing){return i.prototype.dispose.apply(this,arguments)}this.disposing=true;return this.remove()},remove:function(){var a=i.prototype.remove.apply(this,arguments);_.defer(_.bind(this.refresh,this));return a},refresh:function(){var a=this.controller.uploader;if(a){a.refresh()}},ready:function(){var b=this.options.$browser,a;if(this.controller.uploader){a=this.$(".browser");if(a[0]===b[0]){return}b.detach().text(a.text());b[0].className=a[0].className;a.replaceWith(b.show())}this.refresh();return this},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}});j.exports=g},{}],72:[function(f,i,g){var h=wp.media.View.extend({className:"upload-error",template:wp.template("uploader-status-error")});i.exports=h},{}],73:[function(g,k,h){var i=wp.media.View,j;j=i.extend({className:"media-uploader-status",template:wp.template("uploader-status"),events:{"click .upload-dismiss-errors":"dismiss"},initialize:function(){this.queue=wp.Uploader.queue;this.queue.on("add remove reset",this.visibility,this);this.queue.on("add remove reset change:percent",this.progress,this);this.queue.on("add remove reset change:uploading",this.info,this);this.errors=wp.Uploader.errors;this.errors.reset();this.errors.on("add remove reset",this.visibility,this);this.errors.on("add",this.error,this)},dispose:function(){wp.Uploader.queue.off(null,null,this);i.prototype.dispose.apply(this,arguments);return this},visibility:function(){this.$el.toggleClass("uploading",!!this.queue.length);this.$el.toggleClass("errors",!!this.errors.length);this.$el.toggle(!!this.queue.length||!!this.errors.length)},ready:function(){_.each({"$bar":".media-progress-bar div","$index":".upload-index","$total":".upload-total","$filename":".upload-filename"},function(b,a){this[a]=this.$(b)},this);this.visibility();this.progress();this.info()},progress:function(){var b=this.queue,a=this.$bar;if(!a||!b.length){return}a.width((b.reduce(function(f,c){if(!c.get("uploading")){return f+100}var d=c.get("percent");return f+(_.isNumber(d)?d:100)},0)/b.length)+"%")},info:function(){var c=this.queue,b=0,a;if(!c.length){return}a=this.queue.find(function(d,f){b=f;return d.get("uploading")});this.$index.text(b+1);this.$total.text(c.length);this.$filename.html(a?this.filename(a.get("filename")):"")},filename:function(a){return _.escape(a)},error:function(a){this.views.add(".upload-errors",new wp.media.view.UploaderStatusError({filename:this.filename(a.get("file").name),message:a.get("message")}),{at:0})},dismiss:function(b){var a=this.views.get(".upload-errors");b.preventDefault();if(a){_.invoke(a,"remove")}wp.Uploader.errors.reset()}});k.exports=j},{}],74:[function(k,j,g){var i=jQuery,h;h=wp.media.View.extend({tagName:"div",className:"uploader-window",template:wp.template("uploader-window"),initialize:function(){var a;this.$browser=i('<a href="#" class="browser" />').hide().appendTo("body");a=this.options.uploader=_.defaults(this.options.uploader||{},{dropzone:this.$el,browser:this.$browser,params:{}});if(a.dropzone&&!(a.dropzone instanceof i)){a.dropzone=i(a.dropzone)}this.controller.on("activate",this.refresh,this);this.controller.on("detach",function(){this.$browser.remove()},this)},refresh:function(){if(this.uploader){this.uploader.refresh()}},ready:function(){var a=wp.media.view.settings.post.id,b;if(this.uploader){return}if(a){this.options.uploader.params.post_id=a}this.uploader=new wp.Uploader(this.options.uploader);b=this.uploader.dropzone;b.on("dropzone:enter",_.bind(this.show,this));b.on("dropzone:leave",_.bind(this.hide,this));i(this.uploader).on("uploader:ready",_.bind(this._ready,this))},_ready:function(){this.controller.trigger("uploader:ready")},show:function(){var a=this.$el.show();_.defer(function(){a.css({opacity:1})})},hide:function(){var a=this.$el.css({opacity:0});wp.media.transition(a).done(function(){if("0"===a.css("opacity")){a.hide()}});_.delay(function(){if("0"===a.css("opacity")&&a.is(":visible")){a.hide()}},500)}});j.exports=h},{}],75:[function(f,i,g){var h=wp.Backbone.View.extend({constructor:function(a){if(a&&a.controller){this.controller=a.controller}wp.Backbone.View.apply(this,arguments)},dispose:function(){this.undelegateEvents();if(this.model&&this.model.off){this.model.off(null,null,this)}if(this.collection&&this.collection.off){this.collection.off(null,null,this)}if(this.controller&&this.controller.off){this.controller.off(null,null,this)}return this},remove:function(){this.dispose();return wp.Backbone.View.prototype.remove.apply(this,arguments)}});i.exports=h},{}]},{},[19]);